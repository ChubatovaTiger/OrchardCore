/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

/// <reference path="../../node_modules/monaco-editor/monaco.d.ts" />
var liquidTags = ['if', 'else', 'elseif', 'endif', 'render', 'assign', 'capture', 'endcapture', 'case', 'endcase', 'comment', 'endcomment', 'cycle', 'decrement', 'for', 'endfor', 'include', 'increment', 'layout', 'raw', 'endraw', 'render', 'tablerow', 'endtablerow', 'unless', 'endunless'];
var liquidFilters = ['abs', 'append', 'at_least', 'at_most', 'capitalize', 'ceil', 'compact', 'date', 'default', 'divided_by', 'downcase', 'escape', 'escape_once', 'first', 'floor', 'join', 'json', 'last', 'lstrip', 'map', 'minus', 'modulo', 'newline_to_br', 'plus', 'prepend', 'remove', 'remove_first', 'replace', 'replace_first', 'reverse', 'round', 'rstrip', 'size', 'slice', 'sort', 'sort_natural', 'split', 'strip', 'strip_html', 'strip_newlines', 'times', 'truncate', 'truncatewords', 'uniq', 'upcase', 'url_decode', 'url_encode', 'where'];

function getLiquidContextInfo(model, position, triggerCharacter) {
  var inTag;
  var inObject;
  var showTags;
  var showFilters;
  var findStart = model.findPreviousMatch('\\{(%|\\{)', position, true, false, null, true);

  if (findStart && findStart.matches && !position.isBefore(findStart.range.getEndPosition())) {
    if (findStart.matches[1] == '%') {
      inTag = true;
    } else if (findStart.matches[1] == '{') {
      inObject = true;
    }

    var searchPattern = inTag ? '%}' : '}}';
    var findEnd = model.findNextMatch(searchPattern, position, false, false, null, true);
    var currentRange = findStart.range.plusRange(findEnd.range);

    if (currentRange.containsPosition(position)) {
      if (inTag) {
        var findTagName = model.findNextMatch('\\{%\\s*([a-zA-Z-_]+)', findStart.range.getStartPosition(), true, false, null, true);

        if (findTagName && currentRange.containsRange(findTagName.range) && findTagName.matches.length > 1) {
          if (findTagName.matches[1] == 'assign') {
            showFilters = true;
          } else {
            showTags = false;
          }
        } else {
          showTags = true;
        }
      } else {
        showFilters = true;
      }
    }
  }

  return {
    showFilters: showFilters,
    showTags: showTags,
    inTag: inTag,
    inObject: inObject
  };
}

var completionItemProvider = {
  triggerCharacters: [' '],
  provideCompletionItems: function provideCompletionItems(model, position, context, token) {
    var items = [];

    if (context.triggerCharacter == ' ') {
      var startTrigger = model.getValueInRange(new monaco.Range(position.lineNumber, position.column - 3, position.lineNumber, position.column - 1));

      if (startTrigger != '{%' && !startTrigger.endsWith('|')) {
        return null;
      }
    }

    var liquidContext = getLiquidContextInfo(model, position, context.triggerCharacter);

    if (liquidContext.showFilters) {
      items = liquidFilters;
    } else if (liquidContext.showTags) {
      items = liquidTags.filter(function (value) {
        return !value.startsWith('end');
      });
    }

    var suggestions = items.map(function (value) {
      return {
        label: value,
        kind: monaco.languages.CompletionItemKind.Keyword,
        insertText: value,
        insertTextRules: monaco.languages.CompletionItemInsertTextRule.KeepWhitespace
      };
    });
    return {
      suggestions: suggestions
    };
  }
};

function ConfigureLiquidIntellisense(monaco, suggestHtml) {
  if (suggestHtml === void 0) {
    suggestHtml = true;
  }

  if (suggestHtml) {
    var modeConfiguration = {
      completionItems: true,
      colors: true,
      foldingRanges: true,
      selectionRanges: true,
      diagnostics: false,
      documentFormattingEdits: true,
      documentRangeFormattingEdits: true
    };
    var options = {
      format: monaco.languages.html.htmlDefaults.options.format,
      suggest: {
        html5: true
      }
    };
    monaco.languages.html.registerHTMLLanguageService('liquid', options, modeConfiguration);
  }

  monaco.languages.registerCompletionItemProvider('liquid', completionItemProvider);
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpcXVpZC1pbnRlbGxpc2Vuc2UudHMiXSwibmFtZXMiOlsibGlxdWlkVGFncyIsImxpcXVpZEZpbHRlcnMiLCJnZXRMaXF1aWRDb250ZXh0SW5mbyIsIm1vZGVsIiwicG9zaXRpb24iLCJ0cmlnZ2VyQ2hhcmFjdGVyIiwiaW5UYWciLCJpbk9iamVjdCIsInNob3dUYWdzIiwic2hvd0ZpbHRlcnMiLCJmaW5kU3RhcnQiLCJmaW5kUHJldmlvdXNNYXRjaCIsIm1hdGNoZXMiLCJpc0JlZm9yZSIsInJhbmdlIiwiZ2V0RW5kUG9zaXRpb24iLCJzZWFyY2hQYXR0ZXJuIiwiZmluZEVuZCIsImZpbmROZXh0TWF0Y2giLCJjdXJyZW50UmFuZ2UiLCJwbHVzUmFuZ2UiLCJjb250YWluc1Bvc2l0aW9uIiwiZmluZFRhZ05hbWUiLCJnZXRTdGFydFBvc2l0aW9uIiwiY29udGFpbnNSYW5nZSIsImxlbmd0aCIsImNvbXBsZXRpb25JdGVtUHJvdmlkZXIiLCJ0cmlnZ2VyQ2hhcmFjdGVycyIsInByb3ZpZGVDb21wbGV0aW9uSXRlbXMiLCJjb250ZXh0IiwidG9rZW4iLCJpdGVtcyIsInN0YXJ0VHJpZ2dlciIsImdldFZhbHVlSW5SYW5nZSIsIm1vbmFjbyIsIlJhbmdlIiwibGluZU51bWJlciIsImNvbHVtbiIsImVuZHNXaXRoIiwibGlxdWlkQ29udGV4dCIsImZpbHRlciIsInZhbHVlIiwic3RhcnRzV2l0aCIsInN1Z2dlc3Rpb25zIiwibWFwIiwibGFiZWwiLCJraW5kIiwibGFuZ3VhZ2VzIiwiQ29tcGxldGlvbkl0ZW1LaW5kIiwiS2V5d29yZCIsImluc2VydFRleHQiLCJpbnNlcnRUZXh0UnVsZXMiLCJDb21wbGV0aW9uSXRlbUluc2VydFRleHRSdWxlIiwiS2VlcFdoaXRlc3BhY2UiLCJDb25maWd1cmVMaXF1aWRJbnRlbGxpc2Vuc2UiLCJzdWdnZXN0SHRtbCIsIm1vZGVDb25maWd1cmF0aW9uIiwiY29tcGxldGlvbkl0ZW1zIiwiY29sb3JzIiwiZm9sZGluZ1JhbmdlcyIsInNlbGVjdGlvblJhbmdlcyIsImRpYWdub3N0aWNzIiwiZG9jdW1lbnRGb3JtYXR0aW5nRWRpdHMiLCJkb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRzIiwib3B0aW9ucyIsImZvcm1hdCIsImh0bWwiLCJodG1sRGVmYXVsdHMiLCJzdWdnZXN0IiwiaHRtbDUiLCJyZWdpc3RlckhUTUxMYW5ndWFnZVNlcnZpY2UiLCJyZWdpc3RlckNvbXBsZXRpb25JdGVtUHJvdmlkZXIiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFFQSxJQUFNQSxVQUFVLEdBQUcsQ0FDZixJQURlLEVBRWYsTUFGZSxFQUdmLFFBSGUsRUFJZixPQUplLEVBS2YsUUFMZSxFQU1mLFFBTmUsRUFPZixTQVBlLEVBUWYsWUFSZSxFQVNmLE1BVGUsRUFVZixTQVZlLEVBV2YsU0FYZSxFQVlmLFlBWmUsRUFhZixPQWJlLEVBY2YsV0FkZSxFQWVmLEtBZmUsRUFnQmYsUUFoQmUsRUFpQmYsU0FqQmUsRUFrQmYsV0FsQmUsRUFtQmYsUUFuQmUsRUFvQmYsS0FwQmUsRUFxQmYsUUFyQmUsRUFzQmYsUUF0QmUsRUF1QmYsVUF2QmUsRUF3QmYsYUF4QmUsRUF5QmYsUUF6QmUsRUEwQmYsV0ExQmUsQ0FBbkI7QUE2QkEsSUFBTUMsYUFBYSxHQUFHLENBQ2xCLEtBRGtCLEVBRWxCLFFBRmtCLEVBR2xCLFVBSGtCLEVBSWxCLFNBSmtCLEVBS2xCLFlBTGtCLEVBTWxCLE1BTmtCLEVBT2xCLFNBUGtCLEVBUWxCLE1BUmtCLEVBU2xCLFNBVGtCLEVBVWxCLFlBVmtCLEVBV2xCLFVBWGtCLEVBWWxCLFFBWmtCLEVBYWxCLGFBYmtCLEVBY2xCLE9BZGtCLEVBZWxCLE9BZmtCLEVBZ0JsQixNQWhCa0IsRUFpQmxCLE1BakJrQixFQWtCbEIsTUFsQmtCLEVBbUJsQixRQW5Ca0IsRUFvQmxCLEtBcEJrQixFQXFCbEIsT0FyQmtCLEVBc0JsQixRQXRCa0IsRUF1QmxCLGVBdkJrQixFQXdCbEIsTUF4QmtCLEVBeUJsQixTQXpCa0IsRUEwQmxCLFFBMUJrQixFQTJCbEIsY0EzQmtCLEVBNEJsQixTQTVCa0IsRUE2QmxCLGVBN0JrQixFQThCbEIsU0E5QmtCLEVBK0JsQixPQS9Ca0IsRUFnQ2xCLFFBaENrQixFQWlDbEIsTUFqQ2tCLEVBa0NsQixPQWxDa0IsRUFtQ2xCLE1BbkNrQixFQW9DbEIsY0FwQ2tCLEVBcUNsQixPQXJDa0IsRUFzQ2xCLE9BdENrQixFQXVDbEIsWUF2Q2tCLEVBd0NsQixnQkF4Q2tCLEVBeUNsQixPQXpDa0IsRUEwQ2xCLFVBMUNrQixFQTJDbEIsZUEzQ2tCLEVBNENsQixNQTVDa0IsRUE2Q2xCLFFBN0NrQixFQThDbEIsWUE5Q2tCLEVBK0NsQixZQS9Da0IsRUFnRGxCLE9BaERrQixDQUF0Qjs7QUEyREEsU0FBU0Msb0JBQVQsQ0FBOEJDLEtBQTlCLEVBQStEQyxRQUEvRCxFQUEwRkMsZ0JBQTFGLEVBQWtIO0FBQzlHLE1BQUlDLEtBQUo7QUFDQSxNQUFJQyxRQUFKO0FBQ0EsTUFBSUMsUUFBSjtBQUNBLE1BQUlDLFdBQUo7QUFFQSxNQUFJQyxTQUFTLEdBQUdQLEtBQUssQ0FBQ1EsaUJBQU4sQ0FBd0IsWUFBeEIsRUFBc0NQLFFBQXRDLEVBQWdELElBQWhELEVBQXNELEtBQXRELEVBQTZELElBQTdELEVBQW1FLElBQW5FLENBQWhCOztBQUNBLE1BQUlNLFNBQVMsSUFBSUEsU0FBUyxDQUFDRSxPQUF2QixJQUFrQyxDQUFDUixRQUFRLENBQUNTLFFBQVQsQ0FBa0JILFNBQVMsQ0FBQ0ksS0FBVixDQUFnQkMsY0FBaEIsRUFBbEIsQ0FBdkMsRUFBNEY7QUFDeEYsUUFBSUwsU0FBUyxDQUFDRSxPQUFWLENBQWtCLENBQWxCLEtBQXdCLEdBQTVCLEVBQWlDO0FBQzdCTixNQUFBQSxLQUFLLEdBQUcsSUFBUjtBQUNILEtBRkQsTUFFTyxJQUFJSSxTQUFTLENBQUNFLE9BQVYsQ0FBa0IsQ0FBbEIsS0FBd0IsR0FBNUIsRUFBaUM7QUFDcENMLE1BQUFBLFFBQVEsR0FBRyxJQUFYO0FBQ0g7O0FBRUQsUUFBSVMsYUFBYSxHQUFHVixLQUFLLEdBQUcsSUFBSCxHQUFVLElBQW5DO0FBQ0EsUUFBSVcsT0FBTyxHQUFHZCxLQUFLLENBQUNlLGFBQU4sQ0FBb0JGLGFBQXBCLEVBQW1DWixRQUFuQyxFQUE2QyxLQUE3QyxFQUFvRCxLQUFwRCxFQUEyRCxJQUEzRCxFQUFpRSxJQUFqRSxDQUFkO0FBQ0EsUUFBSWUsWUFBWSxHQUFHVCxTQUFTLENBQUNJLEtBQVYsQ0FBZ0JNLFNBQWhCLENBQTBCSCxPQUFPLENBQUNILEtBQWxDLENBQW5COztBQUNBLFFBQUlLLFlBQVksQ0FBQ0UsZ0JBQWIsQ0FBOEJqQixRQUE5QixDQUFKLEVBQTZDO0FBQ3pDLFVBQUlFLEtBQUosRUFBVztBQUNQLFlBQUlnQixXQUFXLEdBQUduQixLQUFLLENBQUNlLGFBQU4sQ0FBb0IsdUJBQXBCLEVBQTZDUixTQUFTLENBQUNJLEtBQVYsQ0FBZ0JTLGdCQUFoQixFQUE3QyxFQUFpRixJQUFqRixFQUF1RixLQUF2RixFQUE4RixJQUE5RixFQUFvRyxJQUFwRyxDQUFsQjs7QUFDQSxZQUFJRCxXQUFXLElBQUlILFlBQVksQ0FBQ0ssYUFBYixDQUEyQkYsV0FBVyxDQUFDUixLQUF2QyxDQUFmLElBQWdFUSxXQUFXLENBQUNWLE9BQVosQ0FBb0JhLE1BQXBCLEdBQTZCLENBQWpHLEVBQW9HO0FBQ2hHLGNBQUlILFdBQVcsQ0FBQ1YsT0FBWixDQUFvQixDQUFwQixLQUEwQixRQUE5QixFQUF3QztBQUNwQ0gsWUFBQUEsV0FBVyxHQUFHLElBQWQ7QUFDSCxXQUZELE1BRU87QUFDSEQsWUFBQUEsUUFBUSxHQUFHLEtBQVg7QUFDSDtBQUNKLFNBTkQsTUFNTztBQUNIQSxVQUFBQSxRQUFRLEdBQUcsSUFBWDtBQUNIO0FBQ0osT0FYRCxNQVdPO0FBQ0hDLFFBQUFBLFdBQVcsR0FBRyxJQUFkO0FBQ0g7QUFDSjtBQUNKOztBQUVELFNBQU87QUFDSEEsSUFBQUEsV0FBVyxFQUFBQSxXQURSO0FBRUhELElBQUFBLFFBQVEsRUFBQUEsUUFGTDtBQUdIRixJQUFBQSxLQUFLLEVBQUFBLEtBSEY7QUFJSEMsSUFBQUEsUUFBUSxFQUFBQTtBQUpMLEdBQVA7QUFNSDs7QUFFRCxJQUFNbUIsc0JBQXNCLEdBQTRDO0FBQ3BFQyxFQUFBQSxpQkFBaUIsRUFBRSxDQUFDLEdBQUQsQ0FEaUQ7QUFFcEVDLEVBQUFBLHNCQUFzQixFQUFFLGdDQUFDekIsS0FBRCxFQUFrQ0MsUUFBbEMsRUFBNkR5QixPQUE3RCxFQUEwR0MsS0FBMUcsRUFBeUk7QUFDN0osUUFBSUMsS0FBSyxHQUFhLEVBQXRCOztBQUVBLFFBQUlGLE9BQU8sQ0FBQ3hCLGdCQUFSLElBQTRCLEdBQWhDLEVBQXFDO0FBQ2pDLFVBQUkyQixZQUFZLEdBQUc3QixLQUFLLENBQUM4QixlQUFOLENBQXNCLElBQUlDLE1BQU0sQ0FBQ0MsS0FBWCxDQUFpQi9CLFFBQVEsQ0FBQ2dDLFVBQTFCLEVBQXNDaEMsUUFBUSxDQUFDaUMsTUFBVCxHQUFrQixDQUF4RCxFQUEyRGpDLFFBQVEsQ0FBQ2dDLFVBQXBFLEVBQWdGaEMsUUFBUSxDQUFDaUMsTUFBVCxHQUFrQixDQUFsRyxDQUF0QixDQUFuQjs7QUFDQSxVQUFJTCxZQUFZLElBQUksSUFBaEIsSUFBd0IsQ0FBQ0EsWUFBWSxDQUFDTSxRQUFiLENBQXNCLEdBQXRCLENBQTdCLEVBQXlEO0FBQ3JELGVBQU8sSUFBUDtBQUNIO0FBQ0o7O0FBRUQsUUFBSUMsYUFBYSxHQUF1QnJDLG9CQUFvQixDQUFDQyxLQUFELEVBQVFDLFFBQVIsRUFBa0J5QixPQUFPLENBQUN4QixnQkFBMUIsQ0FBNUQ7O0FBQ0EsUUFBSWtDLGFBQWEsQ0FBQzlCLFdBQWxCLEVBQStCO0FBQzNCc0IsTUFBQUEsS0FBSyxHQUFHOUIsYUFBUjtBQUNILEtBRkQsTUFFTyxJQUFJc0MsYUFBYSxDQUFDL0IsUUFBbEIsRUFBNEI7QUFDL0J1QixNQUFBQSxLQUFLLEdBQUcvQixVQUFVLENBQUN3QyxNQUFYLENBQWtCLFVBQUNDLEtBQUQsRUFBYztBQUFPLGVBQU8sQ0FBQ0EsS0FBSyxDQUFDQyxVQUFOLENBQWlCLEtBQWpCLENBQVI7QUFBaUMsT0FBeEUsQ0FBUjtBQUNIOztBQUVELFFBQU1DLFdBQVcsR0FBR1osS0FBSyxDQUFDYSxHQUFOLENBQVUsVUFBQ0gsS0FBRCxFQUFjO0FBQ3hDLGFBQU87QUFDSEksUUFBQUEsS0FBSyxFQUFFSixLQURKO0FBRUhLLFFBQUFBLElBQUksRUFBRVosTUFBTSxDQUFDYSxTQUFQLENBQWlCQyxrQkFBakIsQ0FBb0NDLE9BRnZDO0FBR0hDLFFBQUFBLFVBQVUsRUFBRVQsS0FIVDtBQUlIVSxRQUFBQSxlQUFlLEVBQUVqQixNQUFNLENBQUNhLFNBQVAsQ0FBaUJLLDRCQUFqQixDQUE4Q0M7QUFKNUQsT0FBUDtBQU1ILEtBUG1CLENBQXBCO0FBU0EsV0FBTztBQUFFVixNQUFBQSxXQUFXLEVBQUFBO0FBQWIsS0FBUDtBQUNIO0FBN0JtRSxDQUF4RTs7QUFnQ0EsU0FBU1csMkJBQVQsQ0FBcUNwQixNQUFyQyxFQUFrRHFCLFdBQWxELEVBQTZFO0FBQTNCLE1BQUFBLFdBQUEsS0FBQSxLQUFBLENBQUEsRUFBQTtBQUFBQSxJQUFBQSxXQUFBLEdBQUEsSUFBQTtBQUEyQjs7QUFDekUsTUFBSUEsV0FBSixFQUFpQjtBQUNiLFFBQUlDLGlCQUFpQixHQUE0QztBQUM3REMsTUFBQUEsZUFBZSxFQUFFLElBRDRDO0FBRTdEQyxNQUFBQSxNQUFNLEVBQUUsSUFGcUQ7QUFHN0RDLE1BQUFBLGFBQWEsRUFBRSxJQUg4QztBQUk3REMsTUFBQUEsZUFBZSxFQUFFLElBSjRDO0FBSzdEQyxNQUFBQSxXQUFXLEVBQUUsS0FMZ0Q7QUFNN0RDLE1BQUFBLHVCQUF1QixFQUFFLElBTm9DO0FBTzdEQyxNQUFBQSw0QkFBNEIsRUFBRTtBQVArQixLQUFqRTtBQVNBLFFBQUlDLE9BQU8sR0FBa0M7QUFDekNDLE1BQUFBLE1BQU0sRUFBRS9CLE1BQU0sQ0FBQ2EsU0FBUCxDQUFpQm1CLElBQWpCLENBQXNCQyxZQUF0QixDQUFtQ0gsT0FBbkMsQ0FBMkNDLE1BRFY7QUFFekNHLE1BQUFBLE9BQU8sRUFBRTtBQUFFQyxRQUFBQSxLQUFLLEVBQUU7QUFBVDtBQUZnQyxLQUE3QztBQUlBbkMsSUFBQUEsTUFBTSxDQUFDYSxTQUFQLENBQWlCbUIsSUFBakIsQ0FBc0JJLDJCQUF0QixDQUFrRCxRQUFsRCxFQUE0RE4sT0FBNUQsRUFBcUVSLGlCQUFyRTtBQUNIOztBQUVEdEIsRUFBQUEsTUFBTSxDQUFDYSxTQUFQLENBQWlCd0IsOEJBQWpCLENBQWdELFFBQWhELEVBQTBEN0Msc0JBQTFEO0FBQ0giLCJmaWxlIjoibGlxdWlkLWludGVsbGlzZW5zZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9tb25hY28uZC50c1wiIC8+XHJcblxyXG5jb25zdCBsaXF1aWRUYWdzID0gW1xyXG4gICAgJ2lmJyxcclxuICAgICdlbHNlJyxcclxuICAgICdlbHNlaWYnLFxyXG4gICAgJ2VuZGlmJyxcclxuICAgICdyZW5kZXInLFxyXG4gICAgJ2Fzc2lnbicsXHJcbiAgICAnY2FwdHVyZScsXHJcbiAgICAnZW5kY2FwdHVyZScsXHJcbiAgICAnY2FzZScsXHJcbiAgICAnZW5kY2FzZScsXHJcbiAgICAnY29tbWVudCcsXHJcbiAgICAnZW5kY29tbWVudCcsXHJcbiAgICAnY3ljbGUnLFxyXG4gICAgJ2RlY3JlbWVudCcsXHJcbiAgICAnZm9yJyxcclxuICAgICdlbmRmb3InLFxyXG4gICAgJ2luY2x1ZGUnLFxyXG4gICAgJ2luY3JlbWVudCcsXHJcbiAgICAnbGF5b3V0JyxcclxuICAgICdyYXcnLFxyXG4gICAgJ2VuZHJhdycsXHJcbiAgICAncmVuZGVyJyxcclxuICAgICd0YWJsZXJvdycsXHJcbiAgICAnZW5kdGFibGVyb3cnLFxyXG4gICAgJ3VubGVzcycsXHJcbiAgICAnZW5kdW5sZXNzJ1xyXG5dO1xyXG5cclxuY29uc3QgbGlxdWlkRmlsdGVycyA9IFtcclxuICAgICdhYnMnLFxyXG4gICAgJ2FwcGVuZCcsXHJcbiAgICAnYXRfbGVhc3QnLFxyXG4gICAgJ2F0X21vc3QnLFxyXG4gICAgJ2NhcGl0YWxpemUnLFxyXG4gICAgJ2NlaWwnLFxyXG4gICAgJ2NvbXBhY3QnLFxyXG4gICAgJ2RhdGUnLFxyXG4gICAgJ2RlZmF1bHQnLFxyXG4gICAgJ2RpdmlkZWRfYnknLFxyXG4gICAgJ2Rvd25jYXNlJyxcclxuICAgICdlc2NhcGUnLFxyXG4gICAgJ2VzY2FwZV9vbmNlJyxcclxuICAgICdmaXJzdCcsXHJcbiAgICAnZmxvb3InLFxyXG4gICAgJ2pvaW4nLFxyXG4gICAgJ2pzb24nLFxyXG4gICAgJ2xhc3QnLFxyXG4gICAgJ2xzdHJpcCcsXHJcbiAgICAnbWFwJyxcclxuICAgICdtaW51cycsXHJcbiAgICAnbW9kdWxvJyxcclxuICAgICduZXdsaW5lX3RvX2JyJyxcclxuICAgICdwbHVzJyxcclxuICAgICdwcmVwZW5kJyxcclxuICAgICdyZW1vdmUnLFxyXG4gICAgJ3JlbW92ZV9maXJzdCcsXHJcbiAgICAncmVwbGFjZScsXHJcbiAgICAncmVwbGFjZV9maXJzdCcsXHJcbiAgICAncmV2ZXJzZScsXHJcbiAgICAncm91bmQnLFxyXG4gICAgJ3JzdHJpcCcsXHJcbiAgICAnc2l6ZScsXHJcbiAgICAnc2xpY2UnLFxyXG4gICAgJ3NvcnQnLFxyXG4gICAgJ3NvcnRfbmF0dXJhbCcsXHJcbiAgICAnc3BsaXQnLFxyXG4gICAgJ3N0cmlwJyxcclxuICAgICdzdHJpcF9odG1sJyxcclxuICAgICdzdHJpcF9uZXdsaW5lcycsXHJcbiAgICAndGltZXMnLFxyXG4gICAgJ3RydW5jYXRlJyxcclxuICAgICd0cnVuY2F0ZXdvcmRzJyxcclxuICAgICd1bmlxJyxcclxuICAgICd1cGNhc2UnLFxyXG4gICAgJ3VybF9kZWNvZGUnLFxyXG4gICAgJ3VybF9lbmNvZGUnLFxyXG4gICAgJ3doZXJlJ1xyXG5dXHJcblxyXG5pbnRlcmZhY2UgSUxpcXVpZENvbnRleHRJbmZvIHtcclxuICAgIHNob3dGaWx0ZXJzOiBib29sZWFuLFxyXG4gICAgc2hvd1RhZ3M6IGJvb2xlYW4sXHJcbiAgICBpbmNsdWRlRW5kVGFnczogYm9vbGVhbixcclxuICAgIGluVGFnOiBib29sZWFuLFxyXG4gICAgaW5PYmplY3Q6IGJvb2xlYW5cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0TGlxdWlkQ29udGV4dEluZm8obW9kZWw6IG1vbmFjby5lZGl0b3IuSVRleHRNb2RlbCwgcG9zaXRpb246IG1vbmFjby5Qb3NpdGlvbiwgdHJpZ2dlckNoYXJhY3Rlcjogc3RyaW5nKTogSUxpcXVpZENvbnRleHRJbmZvIHtcclxuICAgIHZhciBpblRhZzogYm9vbGVhbjtcclxuICAgIHZhciBpbk9iamVjdDogYm9vbGVhbjtcclxuICAgIHZhciBzaG93VGFnczogYm9vbGVhbjtcclxuICAgIHZhciBzaG93RmlsdGVyczogYm9vbGVhbjtcclxuXHJcbiAgICB2YXIgZmluZFN0YXJ0ID0gbW9kZWwuZmluZFByZXZpb3VzTWF0Y2goJ1xcXFx7KCV8XFxcXHspJywgcG9zaXRpb24sIHRydWUsIGZhbHNlLCBudWxsLCB0cnVlKTtcclxuICAgIGlmIChmaW5kU3RhcnQgJiYgZmluZFN0YXJ0Lm1hdGNoZXMgJiYgIXBvc2l0aW9uLmlzQmVmb3JlKGZpbmRTdGFydC5yYW5nZS5nZXRFbmRQb3NpdGlvbigpKSkge1xyXG4gICAgICAgIGlmIChmaW5kU3RhcnQubWF0Y2hlc1sxXSA9PSAnJScpIHtcclxuICAgICAgICAgICAgaW5UYWcgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZmluZFN0YXJ0Lm1hdGNoZXNbMV0gPT0gJ3snKSB7XHJcbiAgICAgICAgICAgIGluT2JqZWN0ID0gdHJ1ZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHNlYXJjaFBhdHRlcm4gPSBpblRhZyA/ICclfScgOiAnfX0nO1xyXG4gICAgICAgIHZhciBmaW5kRW5kID0gbW9kZWwuZmluZE5leHRNYXRjaChzZWFyY2hQYXR0ZXJuLCBwb3NpdGlvbiwgZmFsc2UsIGZhbHNlLCBudWxsLCB0cnVlKTtcclxuICAgICAgICB2YXIgY3VycmVudFJhbmdlID0gZmluZFN0YXJ0LnJhbmdlLnBsdXNSYW5nZShmaW5kRW5kLnJhbmdlKTtcclxuICAgICAgICBpZiAoY3VycmVudFJhbmdlLmNvbnRhaW5zUG9zaXRpb24ocG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgIGlmIChpblRhZykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZpbmRUYWdOYW1lID0gbW9kZWwuZmluZE5leHRNYXRjaCgnXFxcXHslXFxcXHMqKFthLXpBLVotX10rKScsIGZpbmRTdGFydC5yYW5nZS5nZXRTdGFydFBvc2l0aW9uKCksIHRydWUsIGZhbHNlLCBudWxsLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGlmIChmaW5kVGFnTmFtZSAmJiBjdXJyZW50UmFuZ2UuY29udGFpbnNSYW5nZShmaW5kVGFnTmFtZS5yYW5nZSkgJiYgZmluZFRhZ05hbWUubWF0Y2hlcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbmRUYWdOYW1lLm1hdGNoZXNbMV0gPT0gJ2Fzc2lnbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0ZpbHRlcnMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dUYWdzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzaG93VGFncyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzaG93RmlsdGVycyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBzaG93RmlsdGVycyxcclxuICAgICAgICBzaG93VGFncyxcclxuICAgICAgICBpblRhZyxcclxuICAgICAgICBpbk9iamVjdFxyXG4gICAgfSBhcyBJTGlxdWlkQ29udGV4dEluZm87XHJcbn1cclxuXHJcbmNvbnN0IGNvbXBsZXRpb25JdGVtUHJvdmlkZXI6IG1vbmFjby5sYW5ndWFnZXMuQ29tcGxldGlvbkl0ZW1Qcm92aWRlciA9IHtcclxuICAgIHRyaWdnZXJDaGFyYWN0ZXJzOiBbJyAnXSxcclxuICAgIHByb3ZpZGVDb21wbGV0aW9uSXRlbXM6IChtb2RlbDogbW9uYWNvLmVkaXRvci5JVGV4dE1vZGVsLCBwb3NpdGlvbjogbW9uYWNvLlBvc2l0aW9uLCBjb250ZXh0OiBtb25hY28ubGFuZ3VhZ2VzLkNvbXBsZXRpb25Db250ZXh0LCB0b2tlbjogbW9uYWNvLkNhbmNlbGxhdGlvblRva2VuKSA9PiB7XHJcbiAgICAgICAgdmFyIGl0ZW1zOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuICAgICAgICBpZiAoY29udGV4dC50cmlnZ2VyQ2hhcmFjdGVyID09ICcgJykge1xyXG4gICAgICAgICAgICB2YXIgc3RhcnRUcmlnZ2VyID0gbW9kZWwuZ2V0VmFsdWVJblJhbmdlKG5ldyBtb25hY28uUmFuZ2UocG9zaXRpb24ubGluZU51bWJlciwgcG9zaXRpb24uY29sdW1uIC0gMywgcG9zaXRpb24ubGluZU51bWJlciwgcG9zaXRpb24uY29sdW1uIC0gMSkpO1xyXG4gICAgICAgICAgICBpZiAoc3RhcnRUcmlnZ2VyICE9ICd7JScgJiYgIXN0YXJ0VHJpZ2dlci5lbmRzV2l0aCgnfCcpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGxpcXVpZENvbnRleHQ6IElMaXF1aWRDb250ZXh0SW5mbyA9IGdldExpcXVpZENvbnRleHRJbmZvKG1vZGVsLCBwb3NpdGlvbiwgY29udGV4dC50cmlnZ2VyQ2hhcmFjdGVyKTtcclxuICAgICAgICBpZiAobGlxdWlkQ29udGV4dC5zaG93RmlsdGVycykge1xyXG4gICAgICAgICAgICBpdGVtcyA9IGxpcXVpZEZpbHRlcnM7XHJcbiAgICAgICAgfSBlbHNlIGlmIChsaXF1aWRDb250ZXh0LnNob3dUYWdzKSB7XHJcbiAgICAgICAgICAgIGl0ZW1zID0gbGlxdWlkVGFncy5maWx0ZXIoKHZhbHVlOiBzdHJpbmcpID0+IHsgcmV0dXJuICF2YWx1ZS5zdGFydHNXaXRoKCdlbmQnKSB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gaXRlbXMubWFwKCh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBsYWJlbDogdmFsdWUsXHJcbiAgICAgICAgICAgICAgICBraW5kOiBtb25hY28ubGFuZ3VhZ2VzLkNvbXBsZXRpb25JdGVtS2luZC5LZXl3b3JkLFxyXG4gICAgICAgICAgICAgICAgaW5zZXJ0VGV4dDogdmFsdWUsXHJcbiAgICAgICAgICAgICAgICBpbnNlcnRUZXh0UnVsZXM6IG1vbmFjby5sYW5ndWFnZXMuQ29tcGxldGlvbkl0ZW1JbnNlcnRUZXh0UnVsZS5LZWVwV2hpdGVzcGFjZVxyXG4gICAgICAgICAgICB9IGFzIG1vbmFjby5sYW5ndWFnZXMuQ29tcGxldGlvbkl0ZW1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VnZ2VzdGlvbnMgfSBhcyBtb25hY28ubGFuZ3VhZ2VzLlByb3ZpZGVyUmVzdWx0PG1vbmFjby5sYW5ndWFnZXMuQ29tcGxldGlvbkxpc3Q+O1xyXG4gICAgfVxyXG59O1xyXG5cclxuZnVuY3Rpb24gQ29uZmlndXJlTGlxdWlkSW50ZWxsaXNlbnNlKG1vbmFjbzogYW55LCBzdWdnZXN0SHRtbDogYm9vbGVhbiA9IHRydWUpIHtcclxuICAgIGlmIChzdWdnZXN0SHRtbCkge1xyXG4gICAgICAgIHZhciBtb2RlQ29uZmlndXJhdGlvbjogbW9uYWNvLmxhbmd1YWdlcy5odG1sLk1vZGVDb25maWd1cmF0aW9uID0ge1xyXG4gICAgICAgICAgICBjb21wbGV0aW9uSXRlbXM6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbG9yczogdHJ1ZSxcclxuICAgICAgICAgICAgZm9sZGluZ1JhbmdlczogdHJ1ZSxcclxuICAgICAgICAgICAgc2VsZWN0aW9uUmFuZ2VzOiB0cnVlLFxyXG4gICAgICAgICAgICBkaWFnbm9zdGljczogZmFsc2UsXHJcbiAgICAgICAgICAgIGRvY3VtZW50Rm9ybWF0dGluZ0VkaXRzOiB0cnVlLFxyXG4gICAgICAgICAgICBkb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRzOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgb3B0aW9uczogbW9uYWNvLmxhbmd1YWdlcy5odG1sLk9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGZvcm1hdDogbW9uYWNvLmxhbmd1YWdlcy5odG1sLmh0bWxEZWZhdWx0cy5vcHRpb25zLmZvcm1hdCxcclxuICAgICAgICAgICAgc3VnZ2VzdDogeyBodG1sNTogdHJ1ZSB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1vbmFjby5sYW5ndWFnZXMuaHRtbC5yZWdpc3RlckhUTUxMYW5ndWFnZVNlcnZpY2UoJ2xpcXVpZCcsIG9wdGlvbnMsIG1vZGVDb25maWd1cmF0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICBtb25hY28ubGFuZ3VhZ2VzLnJlZ2lzdGVyQ29tcGxldGlvbkl0ZW1Qcm92aWRlcignbGlxdWlkJywgY29tcGxldGlvbkl0ZW1Qcm92aWRlcik7XHJcbn1cclxuIl19
