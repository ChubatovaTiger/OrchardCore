jQuery.trumbowyg={langs:{en:{viewHTML:"View HTML",undo:"Undo",redo:"Redo",formatting:"Formatting",p:"Paragraph",blockquote:"Quote",code:"Code",header:"Header",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",underline:"Underline",strong:"Strong",em:"Emphasis",del:"Deleted",superscript:"Superscript",subscript:"Subscript",unorderedList:"Unordered list",orderedList:"Ordered list",insertImage:"Insert Image",link:"Link",createLink:"Insert link",unlink:"Remove link",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",horizontalRule:"Insert horizontal rule",removeformat:"Remove format",fullscreen:"Fullscreen",close:"Close",submit:"Confirm",reset:"Cancel",required:"Required",description:"Description",title:"Title",text:"Text",target:"Target",width:"Width"}},plugins:{},svgPath:null,hideButtonTexts:null},Object.defineProperty(jQuery.trumbowyg,"defaultOptions",{value:{lang:"en",fixedBtnPane:!1,fixedFullWidth:!1,autogrow:!1,autogrowOnEnter:!1,imageWidthModalEdit:!1,prefix:"trumbowyg-",semantic:!0,semanticKeepAttributes:!1,resetCss:!1,removeformatPasted:!1,tabToIndent:!1,tagsToRemove:[],tagsToKeep:["hr","img","embed","iframe","input"],btns:[["viewHTML"],["undo","redo"],["formatting"],["strong","em","del"],["superscript","subscript"],["link"],["insertImage"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["horizontalRule"],["removeformat"],["fullscreen"]],btnsDef:{},changeActiveDropdownIcon:!1,inlineElementsSelector:"a,abbr,acronym,b,caption,cite,code,col,dfn,dir,dt,dd,em,font,hr,i,kbd,li,q,span,strikeout,strong,sub,sup,u",pasteHandlers:[],plugins:{},urlProtocol:!1,minimalLinks:!1},writable:!1,enumerable:!0,configurable:!1}),function(e,t,o,a){"use strict";a.fn.trumbowyg=function(e,t){if(e===Object(e)||!e)return this.each(function(){a(this).data("trumbowyg")||a(this).data("trumbowyg",new n(this,e))});if(1===this.length)try{var o=a(this).data("trumbowyg");switch(e){case"execCmd":return o.execCmd(t.cmd,t.param,t.forceCss,t.skipTrumbowyg);case"openModal":return o.openModal(t.title,t.content);case"closeModal":return o.closeModal();case"openModalInsert":return o.openModalInsert(t.title,t.fields,t.callback);case"saveRange":return o.saveRange();case"getRange":return o.range;case"getRangeText":return o.getRangeText();case"restoreRange":return o.restoreRange();case"enable":return o.setDisabled(!1);case"disable":return o.setDisabled(!0);case"toggle":return o.toggle();case"destroy":return o.destroy();case"empty":return o.empty();case"html":return o.html(t)}}catch(e){}return!1};var n=function(n,r){var l=this,i=a.trumbowyg;l.doc=n.ownerDocument||o,l.$ta=a(n),l.$c=a(n),null!=(r=r||{}).lang||null!=i.langs[r.lang]?l.lang=a.extend(!0,{},i.langs.en,i.langs[r.lang]):l.lang=i.langs.en,l.hideButtonTexts=null!=i.hideButtonTexts?i.hideButtonTexts:r.hideButtonTexts;var d=null!=i.svgPath?i.svgPath:r.svgPath;if(l.hasSvg=!1!==d,l.svgPath=l.doc.querySelector("base")?t.location.href.split("#")[0]:"",0===a("#trumbowyg-icons",l.doc).length&&!1!==d){if(null==d){for(var s=o.getElementsByTagName("script"),c=0;c<s.length;c+=1){var u=s[c].src,f=u.match("trumbowyg(.min)?.js");null!=f&&(d=u.substring(0,u.indexOf(f[0]))+"ui/icons.svg")}null==d&&console.warn("You must define svgPath: https://goo.gl/CfTY9U")}var b=l.doc.createElement("div");b.id="trumbowyg-icons",l.doc.body.insertBefore(b,l.doc.body.childNodes[0]),a.ajax({async:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"xml",crossDomain:!0,url:d,data:null,beforeSend:null,complete:null,success:function(e){b.innerHTML=(new XMLSerializer).serializeToString(e.documentElement)}})}var g=l.lang.header,p=function(){return(t.chrome||t.Intl&&Intl.v8BreakIterator)&&"CSS"in t};l.btnsDef={viewHTML:{fn:"toggle",class:"trumbowyg-not-disable"},undo:{isSupported:p,key:"Z"},redo:{isSupported:p,key:"Y"},p:{fn:"formatBlock"},blockquote:{fn:"formatBlock"},h1:{fn:"formatBlock",title:g+" 1"},h2:{fn:"formatBlock",title:g+" 2"},h3:{fn:"formatBlock",title:g+" 3"},h4:{fn:"formatBlock",title:g+" 4"},h5:{fn:"formatBlock",title:g+" 5"},h6:{fn:"formatBlock",title:g+" 6"},subscript:{tag:"sub"},superscript:{tag:"sup"},bold:{key:"B",tag:"b"},italic:{key:"I",tag:"i"},underline:{tag:"u"},strikethrough:{tag:"strike"},strong:{fn:"bold",key:"B"},em:{fn:"italic",key:"I"},del:{fn:"strikethrough"},createLink:{key:"K",tag:"a"},unlink:{},insertImage:{},justifyLeft:{tag:"left",forceCss:!0},justifyCenter:{tag:"center",forceCss:!0},justifyRight:{tag:"right",forceCss:!0},justifyFull:{tag:"justify",forceCss:!0},unorderedList:{fn:"insertUnorderedList",tag:"ul"},orderedList:{fn:"insertOrderedList",tag:"ol"},horizontalRule:{fn:"insertHorizontalRule"},removeformat:{},fullscreen:{class:"trumbowyg-not-disable"},close:{fn:"destroy",class:"trumbowyg-not-disable"},formatting:{dropdown:["p","blockquote","h1","h2","h3","h4"],ico:"p"},link:{dropdown:["createLink","unlink"]}},l.o=a.extend(!0,{},i.defaultOptions,r),l.o.hasOwnProperty("imgDblClickHandler")||(l.o.imgDblClickHandler=l.getDefaultImgDblClickHandler()),l.urlPrefix=l.setupUrlPrefix(),l.disabled=l.o.disabled||"TEXTAREA"===n.nodeName&&n.disabled,r.btns?l.o.btns=r.btns:l.o.semantic||(l.o.btns[3]=["bold","italic","underline","strikethrough"]),a.each(l.o.btnsDef,function(e,t){l.addBtnDef(e,t)}),l.eventNamespace="trumbowyg-event",l.keys=[],l.tagToButton={},l.tagHandlers=[],l.pasteHandlers=[].concat(l.o.pasteHandlers),l.isIE=-1!==e.userAgent.indexOf("MSIE")||-1!==e.appVersion.indexOf("Trident/"),l.isMac=-1!==e.platform.toUpperCase().indexOf("MAC"),l.init()};n.prototype={DEFAULT_SEMANTIC_MAP:{b:"strong",i:"em",s:"del",strike:"del",div:"p"},init:function(){var e=this;e.height=e.$ta.height(),e.initPlugins();try{e.doc.execCommand("enableObjectResizing",!1,!1),e.doc.execCommand("defaultParagraphSeparator",!1,"p")}catch(e){}e.buildEditor(),e.buildBtnPane(),e.fixedBtnPaneEvents(),e.buildOverlay(),setTimeout(function(){e.disabled&&e.setDisabled(!0),e.$c.trigger("tbwinit")})},addBtnDef:function(e,t){this.btnsDef[e]=a.extend(t,this.btnsDef[e]||{})},setupUrlPrefix:function(){var e=this.o.urlProtocol;if(e)return"string"!=typeof e?"https://":e.replace("://","")+"://"},buildEditor:function(){var e=this,o=e.o.prefix,n="";e.$box=a("<div/>",{class:o+"box "+o+"editor-visible "+o+e.o.lang+" trumbowyg"}),e.isTextarea=e.$ta.is("textarea"),e.isTextarea?(n=e.$ta.val(),e.$ed=a("<div/>"),e.$box.insertAfter(e.$ta).append(e.$ed,e.$ta)):(e.$ed=e.$ta,n=e.$ed.html(),e.$ta=a("<textarea/>",{name:e.$ta.attr("id"),height:e.height}).val(n),e.$box.insertAfter(e.$ed).append(e.$ta,e.$ed),e.syncCode()),e.$ta.addClass(o+"textarea").attr("tabindex",-1),e.$ed.addClass(o+"editor").attr({contenteditable:!0,dir:e.lang._dir||"ltr"}).html(n),e.o.tabindex&&e.$ed.attr("tabindex",e.o.tabindex),e.$c.is("[placeholder]")&&e.$ed.attr("placeholder",e.$c.attr("placeholder")),e.$c.is("[spellcheck]")&&e.$ed.attr("spellcheck",e.$c.attr("spellcheck")),e.o.resetCss&&e.$ed.addClass(o+"reset-css"),e.o.autogrow||e.$ta.add(e.$ed).css({height:e.height}),e.semanticCode(),e.o.autogrowOnEnter&&e.$ed.addClass(o+"autogrow-on-enter");var r,l=!1,i=!1;e.$ed.on("dblclick","img",e.o.imgDblClickHandler).on("keydown",function(t){if(!t.ctrlKey&&!t.metaKey||t.altKey){if(e.o.tabToIndent&&"Tab"===t.key)try{return t.shiftKey?e.execCmd("outdent",!0,null):e.execCmd("indent",!0,null),!1}catch(e){}}else{l=!0;var o=e.keys[String.fromCharCode(t.which).toUpperCase()];try{return e.execCmd(o.fn,o.param),!1}catch(e){}}}).on("compositionstart compositionupdate",function(){i=!0}).on("keyup compositionend",function(t){if("compositionend"===t.type)i=!1;else if(i)return;var o=t.which;if(!(o>=37&&o<=40)){if(!t.ctrlKey&&!t.metaKey||89!==o&&90!==o)if(l||17===o)void 0===t.which&&e.semanticCode(!1,!1,!0);else{var a=!e.isIE||"compositionend"===t.type;e.semanticCode(!1,a&&13===o),e.$c.trigger("tbwchange")}else e.semanticCode(!1,!0),e.$c.trigger("tbwchange");setTimeout(function(){l=!1},50)}}).on("mouseup keydown keyup",function(t){(!t.ctrlKey&&!t.metaKey||t.altKey)&&setTimeout(function(){l=!1},50),clearTimeout(r),r=setTimeout(function(){e.updateButtonPaneStatus()},50)}).on("focus blur",function(t){if(e.$c.trigger("tbw"+t.type),"blur"===t.type&&e.clearButtonPaneStatus(),e.o.autogrowOnEnter){if(e.autogrowOnEnterDontClose)return;"focus"===t.type?(e.autogrowOnEnterWasFocused=!0,e.autogrowEditorOnEnter()):e.o.autogrow||(e.$ed.css({height:e.$ed.css("min-height")}),e.$c.trigger("tbwresize"))}}).on("cut drop",function(){setTimeout(function(){e.semanticCode(!1,!0),e.$c.trigger("tbwchange")},0)}).on("paste",function(o){if(e.o.removeformatPasted){o.preventDefault(),t.getSelection&&t.getSelection().deleteFromDocument&&t.getSelection().deleteFromDocument();try{var n=t.clipboardData.getData("Text");try{e.doc.selection.createRange().pasteHTML(n)}catch(t){e.doc.getSelection().getRangeAt(0).insertNode(e.doc.createTextNode(n))}e.$c.trigger("tbwchange",o)}catch(t){e.execCmd("insertText",(o.originalEvent||o).clipboardData.getData("text/plain"))}}a.each(e.pasteHandlers,function(e,t){t(o)}),setTimeout(function(){e.semanticCode(!1,!0),e.$c.trigger("tbwpaste",o),e.$c.trigger("tbwchange")},0)}),e.$ta.on("keyup",function(){e.$c.trigger("tbwchange")}).on("paste",function(){setTimeout(function(){e.$c.trigger("tbwchange")},0)}),a(e.doc.body).on("keydown",function(t){if(27===t.which&&a("."+o+"modal-box").length>=1)return e.closeModal(),!1})},autogrowEditorOnEnter:function(){var e=this;e.$ed.removeClass("autogrow-on-enter");var t=e.$ed[0].clientHeight;e.$ed.height("auto");var o=e.$ed[0].scrollHeight;e.$ed.addClass("autogrow-on-enter"),t!==o&&(e.$ed.height(t),setTimeout(function(){e.$ed.css({height:o}),e.$c.trigger("tbwresize")},0))},buildBtnPane:function(){var e=this,t=e.o.prefix,o=e.$btnPane=a("<div/>",{class:t+"button-pane"});a.each(e.o.btns,function(n,r){a.isArray(r)||(r=[r]);var l=a("<div/>",{class:t+"button-group "+(r.indexOf("fullscreen")>=0?t+"right":"")});a.each(r,function(t,o){try{e.isSupportedBtn(o)&&l.append(e.buildBtn(o))}catch(e){}}),l.html().trim().length>0&&o.append(l)}),e.$box.prepend(o)},buildBtn:function(e){var t=this,o=t.o.prefix,n=t.btnsDef[e],r=n.dropdown,l=null==n.hasIcon||n.hasIcon,i=t.lang[e]||e,d=a("<button/>",{type:"button",class:o+e+"-button "+(n.class||"")+(l?"":" "+o+"textual-button"),html:t.hasSvg&&l?'<svg><use xlink:href="'+t.svgPath+"#"+o+(n.ico||e).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>':t.hideButtonTexts?"":n.text||n.title||t.lang[e]||e,title:(n.title||n.text||i)+(n.key?" ("+(t.isMac?"Cmd":"Ctrl")+" + "+n.key+")":""),tabindex:-1,mousedown:function(){return r&&!a("."+e+"-"+o+"dropdown",t.$box).is(":hidden")||a("body",t.doc).trigger("mousedown"),!((t.$btnPane.hasClass(o+"disable")||t.$box.hasClass(o+"disabled"))&&!a(this).hasClass(o+"active")&&!a(this).hasClass(o+"not-disable"))&&(t.execCmd((!r?n.fn:"dropdown")||e,n.param||e,n.forceCss),!1)}});if(r){d.addClass(o+"open-dropdown");var s=o+"dropdown",c={class:s+"-"+e+" "+s+" "+o+"fixed-top "+(n.dropdownClass||"")};c["data-"+s]=e;var u=a("<div/>",c);a.each(r,function(e,o){t.btnsDef[o]&&t.isSupportedBtn(o)&&u.append(t.buildSubBtn(o))}),t.$box.append(u.hide())}else n.key&&(t.keys[n.key]={fn:n.fn||e,param:n.param||e});return r||(t.tagToButton[(n.tag||e).toLowerCase()]=e),d},buildSubBtn:function(e){var t=this,o=t.o.prefix,n=t.btnsDef[e],r=null==n.hasIcon||n.hasIcon;return n.key&&(t.keys[n.key]={fn:n.fn||e,param:n.param||e}),t.tagToButton[(n.tag||e).toLowerCase()]=e,a("<button/>",{type:"button",class:o+e+"-dropdown-button "+(n.class||"")+(n.ico?" "+o+n.ico+"-button":""),html:t.hasSvg&&r?'<svg><use xlink:href="'+t.svgPath+"#"+o+(n.ico||e).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>'+(n.text||n.title||t.lang[e]||e):n.text||n.title||t.lang[e]||e,title:n.key?"("+(t.isMac?"Cmd":"Ctrl")+" + "+n.key+")":null,style:n.style||null,mousedown:function(){return a("body",t.doc).trigger("mousedown"),t.execCmd(n.fn||e,n.param||e,n.forceCss),!1}})},isSupportedBtn:function(e){try{return this.btnsDef[e].isSupported()}catch(e){}return!0},buildOverlay:function(){var e=this;return e.$overlay=a("<div/>",{class:e.o.prefix+"overlay"}).appendTo(e.$box),e.$overlay},showOverlay:function(){var e=this;a(t).trigger("scroll"),e.$overlay.fadeIn(200),e.$box.addClass(e.o.prefix+"box-blur")},hideOverlay:function(){var e=this;e.$overlay.fadeOut(50),e.$box.removeClass(e.o.prefix+"box-blur")},fixedBtnPaneEvents:function(){var e=this,o=e.o.fixedFullWidth,n=e.$box;e.o.fixedBtnPane&&(e.isFixed=!1,a(t).on("scroll."+e.eventNamespace+" resize."+e.eventNamespace,function(){if(n){e.syncCode();var r=a(t).scrollTop(),l=n.offset().top+1,i=e.$btnPane,d=i.outerHeight()-2;r-l>0&&r-l-e.height<0?(e.isFixed||(e.isFixed=!0,i.css({position:"fixed",top:0,left:o?0:"auto",zIndex:7}),e.$box.css({paddingTop:i.height()})),i.css({width:o?"100%":n.width()-1}),a("."+e.o.prefix+"fixed-top",n).css({position:o?"fixed":"absolute",top:o?d:d+(r-l),zIndex:15})):e.isFixed&&(e.isFixed=!1,i.removeAttr("style"),e.$box.css({paddingTop:0}),a("."+e.o.prefix+"fixed-top",n).css({position:"absolute",top:d}))}}))},setDisabled:function(e){var t=this,o=t.o.prefix;t.disabled=e,e?t.$ta.attr("disabled",!0):t.$ta.removeAttr("disabled"),t.$box.toggleClass(o+"disabled",e),t.$ed.attr("contenteditable",!e)},destroy:function(){var e=this,o=e.o.prefix;e.isTextarea?e.$box.after(e.$ta.css({height:""}).val(e.html()).removeClass(o+"textarea").show()):e.$box.after(e.$ed.css({height:""}).removeClass(o+"editor").removeAttr("contenteditable").removeAttr("dir").html(e.html()).show()),e.$ed.off("dblclick","img"),e.destroyPlugins(),e.$box.remove(),e.$c.removeData("trumbowyg"),a("body").removeClass(o+"body-fullscreen"),e.$c.trigger("tbwclose"),a(t).off("scroll."+e.eventNamespace+" resize."+e.eventNamespace)},empty:function(){this.$ta.val(""),this.syncCode(!0)},toggle:function(){var e=this,t=e.o.prefix;e.o.autogrowOnEnter&&(e.autogrowOnEnterDontClose=!e.$box.hasClass(t+"editor-hidden")),e.semanticCode(!1,!0),e.$c.trigger("tbwchange"),setTimeout(function(){e.doc.activeElement.blur(),e.$box.toggleClass(t+"editor-hidden "+t+"editor-visible"),e.$btnPane.toggleClass(t+"disable"),a("."+t+"viewHTML-button",e.$btnPane).toggleClass(t+"active"),e.$box.hasClass(t+"editor-visible")?e.$ta.attr("tabindex",-1):e.$ta.removeAttr("tabindex"),e.o.autogrowOnEnter&&!e.autogrowOnEnterDontClose&&e.autogrowEditorOnEnter()},0)},dropdown:function(e){var o=this,n=a("body",o.doc),r=o.o.prefix,l=a("[data-"+r+"dropdown="+e+"]",o.$box),i=a("."+r+e+"-button",o.$btnPane),d=l.is(":hidden");if(n.trigger("mousedown"),d){var s=i.offset().left;i.addClass(r+"active"),l.css({position:"absolute",top:i.offset().top-o.$btnPane.offset().top+i.outerHeight(),left:o.o.fixedFullWidth&&o.isFixed?s:s-o.$btnPane.offset().left}).show(),a(t).trigger("scroll"),n.on("mousedown."+o.eventNamespace,function(e){l.is(e.target)||(a("."+r+"dropdown",o.$box).hide(),a("."+r+"active",o.$btnPane).removeClass(r+"active"),n.off("mousedown."+o.eventNamespace))})}},html:function(e){var t=this;return null!=e?(t.$ta.val(e),t.syncCode(!0),t.$c.trigger("tbwchange"),t):t.$ta.val()},syncTextarea:function(){var e=this;e.$ta.val(e.$ed.text().trim().length>0||e.$ed.find(e.o.tagsToKeep.join(",")).length>0?e.$ed.html():"")},syncCode:function(e){var t=this;if(!e&&t.$ed.is(":visible"))t.syncTextarea();else{var o=a("<div>").html(t.$ta.val()),n=a("<div>").append(o);a(t.o.tagsToRemove.join(","),n).remove(),t.$ed.html(n.contents().html())}if(t.o.autogrow&&(t.height=t.$ed.height(),t.height!==t.$ta.css("height")&&(t.$ta.css({height:t.height}),t.$c.trigger("tbwresize"))),t.o.autogrowOnEnter){t.$ed.height("auto");var r=t.autogrowOnEnterWasFocused?t.$ed[0].scrollHeight:t.$ed.css("min-height");r!==t.$ta.css("height")&&(t.$ed.css({height:r}),t.$c.trigger("tbwresize"))}},semanticCode:function(e,t,o){var n=this;if(n.saveRange(),n.syncCode(e),n.o.semantic){if(n.semanticTag("b",n.o.semanticKeepAttributes),n.semanticTag("i",n.o.semanticKeepAttributes),n.semanticTag("s",n.o.semanticKeepAttributes),n.semanticTag("strike",n.o.semanticKeepAttributes),t){var r=n.o.inlineElementsSelector,l=":not("+r+")";n.$ed.contents().filter(function(){return 3===this.nodeType&&this.nodeValue.trim().length>0}).wrap("<span data-tbw/>");var i=function(e){if(0!==e.length){var t=e.nextUntil(l).addBack().wrapAll("<p/>").parent(),o=t.nextAll(r).first();t.next("br").remove(),i(o)}};i(n.$ed.children(r).first()),n.semanticTag("div",!0),a("[data-tbw]",n.$ed).contents().unwrap(),n.$ed.find("p:empty").remove()}o||n.restoreRange(),n.syncTextarea()}},semanticTag:function(e,t){var o;if(null!=this.o.semantic&&"object"==typeof this.o.semantic&&this.o.semantic.hasOwnProperty(e))o=this.o.semantic[e];else{if(!0!==this.o.semantic||!this.DEFAULT_SEMANTIC_MAP.hasOwnProperty(e))return;o=this.DEFAULT_SEMANTIC_MAP[e]}a(e,this.$ed).each(function(){var e=a(this);if(0===e.contents().length)return!1;e.wrap("<"+o+"/>"),t&&a.each(e.prop("attributes"),function(){e.parent().attr(this.name,this.value)}),e.contents().unwrap()})},createLink:function(){for(var e,t,o,n=this,r=n.doc.getSelection(),l=r.getRangeAt(0),i=r.focusNode,d=(new XMLSerializer).serializeToString(l.cloneContents())||l+"";["A","DIV"].indexOf(i.nodeName)<0;)i=i.parentNode;if(i&&"A"===i.nodeName){var s=a(i);d=s.text(),e=s.attr("href"),n.o.minimalLinks||(t=s.attr("title"),o=s.attr("target"));var c=n.doc.createRange();c.selectNode(i),r.removeAllRanges(),r.addRange(c)}n.saveRange();var u={url:{label:"URL",required:!0,value:e},text:{label:n.lang.text,value:d}};n.o.minimalLinks||a.extend(u,{title:{label:n.lang.title,value:t},target:{label:n.lang.target,value:o}}),n.openModalInsert(n.lang.createLink,u,function(e){var t=n.prependUrlPrefix(e.url);if(!t.length)return!1;var o=a(['<a href="',t,'">',e.text||e.url,"</a>"].join(""));return n.o.minimalLinks||(e.title.length>0&&o.attr("title",e.title),e.target.length>0&&o.attr("target",e.target)),n.range.deleteContents(),n.range.insertNode(o[0]),n.syncCode(),n.$c.trigger("tbwchange"),!0})},prependUrlPrefix:function(e){if(!this.urlPrefix)return e;if(/^([a-z][-+.a-z0-9]*:|\/|#)/i.test(e))return e;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?"mailto:"+e:this.urlPrefix+e},unlink:function(){var e=this,t=e.doc.getSelection(),o=t.focusNode;if(t.isCollapsed){for(;["A","DIV"].indexOf(o.nodeName)<0;)o=o.parentNode;if(o&&"A"===o.nodeName){var a=e.doc.createRange();a.selectNode(o),t.removeAllRanges(),t.addRange(a)}}e.execCmd("unlink",void 0,void 0,!0)},insertImage:function(){var e=this;e.saveRange();var t={url:{label:"URL",required:!0},alt:{label:e.lang.description,value:e.getRangeText()}};e.o.imageWidthModalEdit&&(t.width={}),e.openModalInsert(e.lang.insertImage,t,function(t){e.execCmd("insertImage",t.url,!1,!0);var o=a('img[src="'+t.url+'"]:not([alt])',e.$box);return o.attr("alt",t.alt),e.o.imageWidthModalEdit&&o.attr({width:t.width}),e.syncCode(),e.$c.trigger("tbwchange"),!0})},fullscreen:function(){var e,o=this,n=o.o.prefix,r=n+"fullscreen",l=r+"-placeholder",i=o.$box.outerHeight();o.$box.toggleClass(r),(e=o.$box.hasClass(r))?o.$box.before(a("<div/>",{class:l}).css({height:i})):a("."+l).remove(),a("body").toggleClass(n+"body-fullscreen",e),a(t).trigger("scroll"),o.$c.trigger("tbw"+(e?"open":"close")+"fullscreen")},execCmd:function(e,t,o,a){var n=this;a=!!a||"","dropdown"!==e&&n.$ed.focus();try{n.doc.execCommand("styleWithCSS",!1,o||!1)}catch(e){}try{n[e+a](t)}catch(o){try{e(t)}catch(o){"insertHorizontalRule"===e?t=void 0:"formatBlock"===e&&n.isIE&&(t="<"+t+">"),n.doc.execCommand(e,!1,t),n.syncCode(),n.semanticCode(!1,!0)}"dropdown"!==e&&(n.updateButtonPaneStatus(),n.$c.trigger("tbwchange"))}},openModal:function(e,o,n){var r=this,l=r.o.prefix;if(n=!1!==n,a("."+l+"modal-box",r.$box).length>0)return!1;r.o.autogrowOnEnter&&(r.autogrowOnEnterDontClose=!0),r.saveRange(),r.showOverlay(),r.$btnPane.addClass(l+"disable");var i,d=a("<div/>",{class:l+"modal "+l+"fixed-top"}).css({top:r.$box.offset().top+r.$btnPane.height(),zIndex:99999}).appendTo(a(r.doc.body));r.$overlay.one("click",function(){return d.trigger("tbwcancel"),!1}),i=n?a("<form/>",{action:"",html:o}).on("submit",function(){return d.trigger("tbwconfirm"),!1}).on("reset",function(){return d.trigger("tbwcancel"),!1}).on("submit reset",function(){r.o.autogrowOnEnter&&(r.autogrowOnEnterDontClose=!1)}):o;var s=a("<div/>",{class:l+"modal-box",html:i}).css({top:"-"+r.$btnPane.outerHeight(),opacity:0,paddingBottom:n?null:"5%"}).appendTo(d).animate({top:0,opacity:1},100);return e&&a("<span/>",{text:e,class:l+"modal-title"}).prependTo(s),n&&(a("input:first",s).focus(),r.buildModalBtn("submit",s),r.buildModalBtn("reset",s),d.height(s.outerHeight()+10)),a(t).trigger("scroll"),d},buildModalBtn:function(e,t){var o=this.o.prefix;return a("<button/>",{class:o+"modal-button "+o+"modal-"+e,type:e,text:this.lang[e]||e}).appendTo(a("form",t))},closeModal:function(){var e=this,t=e.o.prefix;e.$btnPane.removeClass(t+"disable"),e.$overlay.off();var o=a("."+t+"modal-box",a(e.doc.body));o.animate({top:"-"+o.height()},100,function(){o.parent().remove(),e.hideOverlay()}),e.restoreRange()},openModalInsert:function(e,t,o){var n=this,r=n.o.prefix,l=n.lang,i="";return a.each(t,function(e,t){var o=t.label||e,a=t.name||e,n=t.attributes||{},d=Object.keys(n).map(function(e){return e+'="'+n[e]+'"'}).join(" ");i+='<label><input type="'+(t.type||"text")+'" name="'+a+'"'+("checkbox"===t.type&&t.value?' checked="checked"':' value="'+(t.value||"").replace(/"/g,"&quot;"))+'"'+d+'><span class="'+r+'input-infos"><span>'+(l[o]?l[o]:o)+"</span></span></label>"}),n.openModal(e,i).on("tbwconfirm",function(){var e=a("form",a(this)),r=!0,l={};a.each(t,function(t,o){var i=o.name||t,d=a('input[name="'+i+'"]',e);switch(d.attr("type").toLowerCase()){case"checkbox":l[i]=d.is(":checked");break;case"radio":l[i]=d.filter(":checked").val();break;default:l[i]=a.trim(d.val())}o.required&&""===l[i]?(r=!1,n.addErrorOnModalField(d,n.lang.required)):o.pattern&&!o.pattern.test(l[i])&&(r=!1,n.addErrorOnModalField(d,o.patternError))}),r&&(n.restoreRange(),o(l,t)&&(n.syncCode(),n.$c.trigger("tbwchange"),n.closeModal(),a(this).off("tbwconfirm")))}).one("tbwcancel",function(){a(this).off("tbwconfirm"),n.closeModal()})},addErrorOnModalField:function(e,t){var o=this.o.prefix,n=o+"msg-error",r=e.parent();e.on("change keyup",function(){r.removeClass(o+"input-error"),setTimeout(function(){r.find("."+n).remove()},150)}),r.addClass(o+"input-error").find("input+span").append(a("<span/>",{class:n,text:t}))},getDefaultImgDblClickHandler:function(){var e=this;return function(){var t=a(this),o=t.attr("src");0===o.indexOf("data:image")&&(o="(Base64)");var n={url:{label:"URL",value:o,required:!0},alt:{label:e.lang.description,value:t.attr("alt")}};return e.o.imageWidthModalEdit&&(n.width={value:t.attr("width")?t.attr("width"):""}),e.openModalInsert(e.lang.insertImage,n,function(o){return"(Base64)"!==o.url&&t.attr({src:o.url}),t.attr({alt:o.alt}),e.o.imageWidthModalEdit&&(parseInt(o.width)>0?t.attr({width:o.width}):t.removeAttr("width")),!0}),!1}},saveRange:function(){var e=this,t=e.doc.getSelection();if(e.range=null,t&&t.rangeCount){var o,a=e.range=t.getRangeAt(0),n=e.doc.createRange();n.selectNodeContents(e.$ed[0]),n.setEnd(a.startContainer,a.startOffset),o=(n+"").length,e.metaRange={start:o,end:o+(a+"").length}}},restoreRange:function(){var e,t=this,o=t.metaRange,a=t.range,n=t.doc.getSelection();if(a){if(o&&o.start!==o.end){var r,l=0,i=[t.$ed[0]],d=!1,s=!1;for(e=t.doc.createRange();!s&&(r=i.pop());)if(3===r.nodeType){var c=l+r.length;!d&&o.start>=l&&o.start<=c&&(e.setStart(r,o.start-l),d=!0),d&&o.end>=l&&o.end<=c&&(e.setEnd(r,o.end-l),s=!0),l=c}else for(var u=r.childNodes,f=u.length;f>0;)f-=1,i.push(u[f])}try{n.removeAllRanges()}catch(e){}n.addRange(e||a)}},getRangeText:function(){return this.range+""},clearButtonPaneStatus:function(){var e=this,t=e.o.prefix,o=t+"active-button "+t+"active",n=t+"original-icon";a("."+t+"active-button",e.$btnPane).removeClass(o),a("."+n,e.$btnPane).each(function(){a(this).find("svg use").attr("xlink:href",a(this).data(n))})},updateButtonPaneStatus:function(){var e=this,t=e.o.prefix,o=t+"active-button "+t+"active",n=t+"original-icon",r=e.getTagsRecursive(e.doc.getSelection().focusNode);e.clearButtonPaneStatus(),a.each(r,function(r,l){var i=e.tagToButton[l.toLowerCase()],d=a("."+t+i+"-button",e.$btnPane);if(d.length>0)d.addClass(o);else try{var s=(d=a("."+t+"dropdown ."+t+i+"-dropdown-button",e.$box)).find("svg use"),c=d.parent().data(t+"dropdown"),u=a("."+t+c+"-button",e.$box),f=u.find("svg use");u.addClass(o),e.o.changeActiveDropdownIcon&&s.length>0&&(u.addClass(n).data(n,f.attr("xlink:href")),f.attr("xlink:href",s.attr("xlink:href")))}catch(e){}})},getTagsRecursive:function(e,t){var o=this;if(t=t||(e&&e.tagName?[e.tagName]:[]),!e||!e.parentNode)return t;var n=(e=e.parentNode).tagName;return"DIV"===n?t:("P"===n&&""!==e.style.textAlign&&t.push(e.style.textAlign),a.each(o.tagHandlers,function(a,n){t=t.concat(n(e,o))}),t.push(n),o.getTagsRecursive(e,t).filter(function(e){return null!=e}))},initPlugins:function(){var e=this;e.loadedPlugins=[],a.each(a.trumbowyg.plugins,function(t,o){o.shouldInit&&!o.shouldInit(e)||(o.init(e),o.tagHandler&&e.tagHandlers.push(o.tagHandler),e.loadedPlugins.push(o))})},destroyPlugins:function(){var e=this;a.each(this.loadedPlugins,function(t,o){o.destroy&&o.destroy(e)})}}}(navigator,window,document,jQuery),function(e){"use strict";function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}function o(e){return-1===e.search("rgb")?e.replace("#",""):"rgba(0, 0, 0, 0)"===e?"transparent":t((e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/))[1])+t(e[2])+t(e[3])}e.extend(!0,e.trumbowyg,{langs:{cs:{foreColor:"Barva textu",backColor:"Barva pozadí"},en:{foreColor:"Text color",backColor:"Background color",foreColorRemove:"Remove text color",backColorRemove:"Remove background color"},da:{foreColor:"Tekstfarve",backColor:"Baggrundsfarve"},fr:{foreColor:"Couleur du texte",backColor:"Couleur de fond",foreColorRemove:"Supprimer la couleur du texte",backColorRemove:"Supprimer la couleur de fond"},de:{foreColor:"Textfarbe",backColor:"Hintergrundfarbe"},nl:{foreColor:"Tekstkleur",backColor:"Achtergrondkleur"},sk:{foreColor:"Farba textu",backColor:"Farba pozadia"},zh_cn:{foreColor:"文字颜色",backColor:"背景颜色"},zh_tw:{foreColor:"文字顏色",backColor:"背景顏色"},ru:{foreColor:"Цвет текста",backColor:"Цвет выделения текста"},ja:{foreColor:"文字色",backColor:"背景色"},tr:{foreColor:"Yazı rengi",backColor:"Arkaplan rengi"},pt_br:{foreColor:"Cor de fonte",backColor:"Cor de fundo"},ko:{foreColor:"글자색",backColor:"배경색",foreColorRemove:"글자색 지우기",backColorRemove:"배경색 지우기"}}});var a={colorList:["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646","ffff00","f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada","fff2ca","d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5","ffe694","bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","b7dde8","fac08f","f2c314","a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","92cddc","e36c09","c09100","7f7f7f","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","31859b","974806","7f6000"],foreColorList:null,backColorList:null,allowCustomForeColor:!0,allowCustomBackColor:!0,displayAsList:!1};function n(t,o){var a=[],n=o.o.plugins.colors,r=n[t+"List"]||n.colorList;e.each(r,function(e,r){var l=t+r,i={fn:t,forceCss:!0,hasIcon:!1,text:o.lang["#"+r]||"#"+r,param:"#"+r,style:"background-color: #"+r+";"};n.displayAsList&&"foreColor"===t&&(i.style="color: #"+r+" !important;"),o.addBtnDef(l,i),a.push(l)});var l=t+"Remove",i={fn:"removeFormat",hasIcon:!1,param:t,style:"background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAG0lEQVQIW2NkQAAfEJMRmwBYhoGBYQtMBYoAADziAp0jtJTgAAAAAElFTkSuQmCC);"};if(n.displayAsList&&(i.style=""),o.addBtnDef(l,i),a.push(l),n["allowCustom"+t.charAt(0).toUpperCase()+t.substr(1)]){var d=t+"Free",s={fn:function(){o.openModalInsert(o.lang[t],{color:{label:t,forceCss:!0,type:"color",value:"#FFFFFF"}},function(e){return o.execCmd(t,e.color),!0})},hasIcon:!1,text:"#",style:"text-indent: 0; line-height: 20px; padding: 0 5px;"};o.addBtnDef(d,s),a.push(d)}return a}e.extend(!0,e.trumbowyg,{plugins:{color:{init:function(e){e.o.plugins.colors=e.o.plugins.colors||a;var t=e.o.plugins.colors.displayAsList?e.o.prefix+"dropdown--color-list":"",o={dropdown:n("foreColor",e),dropdownClass:t},r={dropdown:n("backColor",e),dropdownClass:t};e.addBtnDef("foreColor",o),e.addBtnDef("backColor",r)},tagHandler:function(e,t){var a,n=[];if(!e.style)return n;if(""!==e.style.backgroundColor){var r=o(e.style.backgroundColor);t.o.plugins.colors.colorList.indexOf(r)>=0?n.push("backColor"+r):n.push("backColorFree")}return""!==e.style.color?a=o(e.style.color):e.hasAttribute("color")&&(a=o(e.getAttribute("color"))),a&&(t.o.plugins.colors.colorList.indexOf(a)>=0?n.push("foreColor"+a):n.push("foreColorFree")),n}}}})}(jQuery),function(e){"use strict";var t=function(){return"undefined"!=typeof FileReader};e.extend(!0,e.trumbowyg,{langs:{en:{base64:"Image as base64",file:"File",errFileReaderNotSupported:"FileReader is not supported by your browser.",errInvalidImage:"Invalid image file."},da:{base64:"Billede som base64",file:"Fil",errFileReaderNotSupported:"FileReader er ikke understøttet af din browser.",errInvalidImage:"Ugyldig billedfil."},fr:{base64:"Image en base64",file:"Fichier"},cs:{base64:"Vložit obrázek",file:"Soubor"},zh_cn:{base64:"图片（Base64编码）",file:"文件"},nl:{base64:"Afbeelding inline",file:"Bestand",errFileReaderNotSupported:"Uw browser ondersteunt deze functionaliteit niet.",errInvalidImage:"De gekozen afbeelding is ongeldig."},ru:{base64:"Изображение как код в base64",file:"Файл",errFileReaderNotSupported:"FileReader не поддерживается вашим браузером.",errInvalidImage:"Недопустимый файл изображения."},ja:{base64:"画像 (Base64形式)",file:"ファイル",errFileReaderNotSupported:"あなたのブラウザーはFileReaderをサポートしていません",errInvalidImage:"画像形式が正しくありません"},tr:{base64:"Base64 olarak resim",file:"Dosya",errFileReaderNotSupported:"FileReader tarayıcınız tarafından desteklenmiyor.",errInvalidImage:"Geçersiz resim dosyası."},zh_tw:{base64:"圖片(base64編碼)",file:"檔案",errFileReaderNotSupported:"你的瀏覽器不支援FileReader",errInvalidImage:"不正確的檔案格式"},pt_br:{base64:"Imagem em base64",file:"Arquivo",errFileReaderNotSupported:"FileReader não é suportado pelo seu navegador.",errInvalidImage:"Arquivo de imagem inválido."},ko:{base64:"그림 넣기(base64)",file:"파일",errFileReaderNotSupported:"FileReader가 현재 브라우저를 지원하지 않습니다.",errInvalidImage:"유효하지 않은 파일"}},plugins:{base64:{shouldInit:t,init:function(o){var a={isSupported:t,fn:function(){var t;o.saveRange();var a=o.openModalInsert(o.lang.base64,{file:{type:"file",required:!0,attributes:{accept:"image/*"}},alt:{label:"description",value:o.getRangeText()}},function(n){var r=new FileReader;r.onloadend=function(t){var l;l=t.target.result,/^data:image\/[a-z]?/i.test(l)?(o.execCmd("insertImage",r.result,!1,!0),e(['img[src="',r.result,'"]:not([alt])'].join(""),o.$box).attr("alt",n.alt),o.closeModal()):o.addErrorOnModalField(e("input[type=file]",a),o.lang.errInvalidImage)},r.readAsDataURL(t)});e("input[type=file]").on("change",function(e){t=e.target.files[0]})}};o.addBtnDef("base64",a)}}}})}(jQuery),function(e){"use strict";var t={proxy:"https://noembed.com/embed?nowrap=on",urlFiled:"url",data:[],success:void 0,error:void 0};e.extend(!0,e.trumbowyg,{langs:{en:{noembed:"Noembed",noembedError:"Error"},da:{noembedError:"Fejl"},sk:{noembedError:"Chyba"},fr:{noembedError:"Erreur"},cs:{noembedError:"Chyba"},ru:{noembedError:"Ошибка"},ja:{noembedError:"エラー"},tr:{noembedError:"Hata"},zh_tw:{noembed:"插入影片",noembedError:"錯誤"},pt_br:{noembed:"Incorporar",noembedError:"Erro"},ko:{noembed:"oEmbed 넣기",noembedError:"에러"}},plugins:{noembed:{init:function(o){o.o.plugins.noembed=e.extend(!0,{},t,o.o.plugins.noembed||{});var a={fn:function(){var t=o.openModalInsert(o.lang.noembed,{url:{label:"URL",required:!0}},function(a){e.ajax({url:o.o.plugins.noembed.proxy,type:"GET",data:a,cache:!1,dataType:"json",success:o.o.plugins.noembed.success||function(a){a.html?(o.execCmd("insertHTML",a.html),setTimeout(function(){o.closeModal()},250)):o.addErrorOnModalField(e("input[type=text]",t),a.error)},error:o.o.plugins.noembed.error||function(){o.addErrorOnModalField(e("input[type=text]",t),o.lang.noembedError)}})})}};o.addBtnDef("noembed",a)}}}})}(jQuery),function(e){"use strict";var t={enabled:!0,endpoints:["https://noembed.com/embed?nowrap=on","https://api.maxmade.nl/url2iframe/embed"]};e.extend(!0,e.trumbowyg,{plugins:{pasteEmbed:{init:function(o){o.o.plugins.pasteEmbed=e.extend(!0,{},t,o.o.plugins.pasteEmbed||{}),o.o.plugins.pasteEmbed.enabled&&o.pasteHandlers.push(function(t){try{var a=(t.originalEvent||t).clipboardData.getData("Text"),n=o.o.plugins.pasteEmbed.endpoints,r=null;if(a.startsWith("http")){t.stopPropagation(),t.preventDefault();var l={url:a.trim()},i="",d=0;r&&r.transport&&r.transport.abort(),r=e.ajax({crossOrigin:!0,url:n[d],type:"GET",data:l,cache:!1,dataType:"jsonp",success:function(e){e.html?(d=0,i=e.html):d+=1},error:function(){d+=1},complete:function(){0===i.length&&d<n.length-1&&(this.url=n[d],this.data=l,e.ajax(this)),d===n.length-1&&(i=e("<a>",{href:a,text:a}).prop("outerHTML")),i.length>0&&(d=0,o.execCmd("insertHTML",i))}})}}catch(e){}})}}}})}(jQuery),function(e){"use strict";var t={rows:8,columns:8,styler:"table"};e.extend(!0,e.trumbowyg,{langs:{en:{table:"Insert table",tableAddRow:"Add row",tableAddRowAbove:"Add row above",tableAddColumnLeft:"Add column to the left",tableAddColumn:"Add column to the right",tableDeleteRow:"Delete row",tableDeleteColumn:"Delete column",tableDestroy:"Delete table",error:"Error"},da:{table:"Indsæt tabel",tableAddRow:"Tilføj række",tableAddRowAbove:"Tilføj række",tableAddColumnLeft:"Tilføj kolonne",tableAddColumn:"Tilføj kolonne",tableDeleteRow:"Slet række",tableDeleteColumn:"Slet kolonne",tableDestroy:"Slet tabel",error:"Fejl"},de:{table:"Tabelle einfügen",tableAddRow:"Zeile hinzufügen",tableAddRowAbove:"Zeile hinzufügen",tableAddColumnLeft:"Spalte hinzufügen",tableAddColumn:"Spalte hinzufügen",tableDeleteRow:"Zeile löschen",tableDeleteColumn:"Spalte löschen",tableDestroy:"Tabelle löschen",error:"Error"},sk:{table:"Vytvoriť tabuľky",tableAddRow:"Pridať riadok",tableAddRowAbove:"Pridať riadok",tableAddColumnLeft:"Pridať stĺpec",tableAddColumn:"Pridať stĺpec",error:"Chyba"},fr:{table:"Insérer un tableau",tableAddRow:"Ajouter des lignes",tableAddRowAbove:"Ajouter des lignes",tableAddColumnLeft:"Ajouter des colonnes",tableAddColumn:"Ajouter des colonnes",tableDeleteRow:"Effacer la ligne",tableDeleteColumn:"Effacer la colonne",tableDestroy:"Effacer le tableau",error:"Erreur"},cs:{table:"Vytvořit příkaz Table",tableAddRow:"Přidat řádek",tableAddRowAbove:"Přidat řádek",tableAddColumnLeft:"Přidat sloupec",tableAddColumn:"Přidat sloupec",error:"Chyba"},ru:{table:"Вставить таблицу",tableAddRow:"Добавить строку",tableAddRowAbove:"Добавить строку",tableAddColumnLeft:"Добавить столбец",tableAddColumn:"Добавить столбец",tableDeleteRow:"Удалить строку",tableDeleteColumn:"Удалить столбец",tableDestroy:"Удалить таблицу",error:"Ошибка"},ja:{table:"表の挿入",tableAddRow:"行の追加",tableAddRowAbove:"行の追加",tableAddColumnLeft:"列の追加",tableAddColumn:"列の追加",error:"エラー"},tr:{table:"Tablo ekle",tableAddRow:"Satır ekle",tableAddRowAbove:"Satır ekle",tableAddColumnLeft:"Kolon ekle",tableAddColumn:"Kolon ekle",error:"Hata"},zh_tw:{table:"插入表格",tableAddRow:"加入行",tableAddRowAbove:"加入行",tableAddColumnLeft:"加入列",tableAddColumn:"加入列",tableDeleteRow:"刪除行",tableDeleteColumn:"刪除列",tableDestroy:"刪除表格",error:"錯誤"},id:{table:"Sisipkan tabel",tableAddRow:"Sisipkan baris",tableAddRowAbove:"Sisipkan baris",tableAddColumnLeft:"Sisipkan kolom",tableAddColumn:"Sisipkan kolom",tableDeleteRow:"Hapus baris",tableDeleteColumn:"Hapus kolom",tableDestroy:"Hapus tabel",error:"Galat"},pt_br:{table:"Inserir tabela",tableAddRow:"Adicionar linha",tableAddRowAbove:"Adicionar linha",tableAddColumnLeft:"Adicionar coluna",tableAddColumn:"Adicionar coluna",tableDeleteRow:"Deletar linha",tableDeleteColumn:"Deletar coluna",tableDestroy:"Deletar tabela",error:"Erro"},ko:{table:"표 넣기",tableAddRow:"줄 추가",tableAddRowAbove:"줄 추가",tableAddColumnLeft:"칸 추가",tableAddColumn:"칸 추가",tableDeleteRow:"줄 삭제",tableDeleteColumn:"칸 삭제",tableDestroy:"표 지우기",error:"에러"}},plugins:{table:{init:function(o){o.o.plugins.table=e.extend(!0,{},t,o.o.plugins.table||{});var a={fn:function(){o.saveRange();var t=o.o.prefix+"dropdown",a={class:t+"-table "+t+" "+o.o.prefix+"fixed-top"};a["data-"+t]="table";var l=e("<div/>",a);if(0===o.$box.find("."+t+"-table").length?o.$box.append(l.hide()):l=o.$box.find("."+t+"-table"),l.html(""),o.$box.find("."+o.o.prefix+"table-button").hasClass(o.o.prefix+"active-button"))l.append(o.buildSubBtn("tableAddRowAbove")),l.append(o.buildSubBtn("tableAddRow")),l.append(o.buildSubBtn("tableAddColumnLeft")),l.append(o.buildSubBtn("tableAddColumn")),l.append(o.buildSubBtn("tableDeleteRow")),l.append(o.buildSubBtn("tableDeleteColumn")),l.append(o.buildSubBtn("tableDestroy"));else{var i=e("<table/>");e("<tbody/>").appendTo(i);for(var d=0;d<o.o.plugins.table.rows;d+=1)for(var s=e("<tr/>").appendTo(i),c=0;c<o.o.plugins.table.columns;c+=1)e("<td/>").appendTo(s);i.find("td").on("mouseover",n),i.find("td").on("mousedown",r),l.append(i),l.append(e('<div class="trumbowyg-table-size">1x1</div>'))}o.dropdown("table")}},n=function(t){var o=e(t.target).closest("table"),a=this.cellIndex,n=this.parentNode.rowIndex;o.find("td").removeClass("active");for(var r=0;r<=n;r+=1)for(var l=0;l<=a;l+=1)o.find("tr:nth-of-type("+(r+1)+")").find("td:nth-of-type("+(l+1)+")").addClass("active");o.next(".trumbowyg-table-size").html(a+1+"x"+(n+1))},r=function(){o.saveRange();var t=e("<table/>");e("<tbody/>").appendTo(t),o.o.plugins.table.styler&&t.attr("class",o.o.plugins.table.styler);for(var a=this.cellIndex,n=this.parentNode.rowIndex,r=0;r<=n;r+=1)for(var l=e("<tr></tr>").appendTo(t),i=0;i<=a;i+=1)e("<td/>").appendTo(l);o.range.deleteContents(),o.range.insertNode(t[0]),o.$c.trigger("tbwchange")},l={title:o.lang.tableAddRow,text:o.lang.tableAddRow,ico:"row-below",fn:function(){o.saveRange();var t=o.doc.getSelection().focusNode,a=e(t).closest("tr"),n=e(t).closest("table");if(n.length>0){for(var r=e("<tr/>"),l=0;l<n.find("tr")[0].childElementCount;l+=1)e("<td/>").appendTo(r);a.after(r)}o.syncCode()}},i={title:o.lang.tableAddRowAbove,text:o.lang.tableAddRowAbove,ico:"row-above",fn:function(){o.saveRange();var t=o.doc.getSelection().focusNode,a=e(t).closest("tr"),n=e(t).closest("table");if(n.length>0){for(var r=e("<tr/>"),l=0;l<n.find("tr")[0].childElementCount;l+=1)e("<td/>").appendTo(r);a.before(r)}o.syncCode()}},d={title:o.lang.tableAddColumn,text:o.lang.tableAddColumn,ico:"col-right",fn:function(){o.saveRange();var t=o.doc.getSelection().focusNode,a=e(t).closest("td"),n=e(t).closest("table"),r=a.index();n.length>0&&e(n).find("tr").each(function(){e(e(this).children()[r]).after("<td></td>")}),o.syncCode()}},s={title:o.lang.tableAddColumnLeft,text:o.lang.tableAddColumnLeft,ico:"col-left",fn:function(){o.saveRange();var t=o.doc.getSelection().focusNode,a=e(t).closest("td"),n=e(t).closest("table"),r=a.index();n.length>0&&e(n).find("tr").each(function(){e(e(this).children()[r]).before("<td></td>")}),o.syncCode()}},c={title:o.lang.tableDestroy,text:o.lang.tableDestroy,ico:"table-delete",fn:function(){o.saveRange();var t=o.doc.getSelection().focusNode;e(t).closest("table").remove(),o.syncCode()}},u={title:o.lang.tableDeleteRow,text:o.lang.tableDeleteRow,ico:"row-delete",fn:function(){o.saveRange();var t=o.doc.getSelection().focusNode;e(t).closest("tr").remove(),o.syncCode()}},f={title:o.lang.tableDeleteColumn,text:o.lang.tableDeleteColumn,ico:"col-delete",fn:function(){o.saveRange();var t=o.doc.getSelection().focusNode,a=e(t).closest("table"),n=e(t).closest("td").index();e(a).find("tr").each(function(){e(this).find("td:eq("+n+")").remove()}),o.syncCode()}};o.addBtnDef("table",a),o.addBtnDef("tableAddRowAbove",i),o.addBtnDef("tableAddRow",l),o.addBtnDef("tableAddColumnLeft",s),o.addBtnDef("tableAddColumn",d),o.addBtnDef("tableDeleteRow",u),o.addBtnDef("tableDeleteColumn",f),o.addBtnDef("tableDestroy",c)}}}})}(jQuery);
