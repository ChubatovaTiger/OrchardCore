@using OrchardCore.Localization
@using OrchardCore.Environment.Shell
@inject ShellSettings ShellSettings

@{
    var selectedCultureName = Model.CurrentCulture.Name;
}
<select id="oc-admin-culture-picker" class="form-select me-3"
    data-cookie-name="@(LocalizationCookieName.AdminCulturePrefix + ShellSettings.VersionId)"
    data-cookie-path="@(Context.Request.PathBase.HasValue ? Context.Request.PathBase : "/")"
    data-selected-culture="@selectedCultureName">
  @foreach (var culture in Model.SupportedCultures)
  {
    <option selected="@(culture.Name == selectedCultureName ? "selected" : null)" value="@culture.Name">@culture.DisplayName</option>
  }
</select>

<script at="Foot" depends-on="jquery">
    $(function (){
        $('#oc-admin-culture-picker').change(function(){
            var $this = $(this);
            var culture = $this.val();
            var selectedCulture = $this.data('selected-culture');
            if (culture != selectedCulture) {
                var cookieName = $this.data('cookie-name');
                var cookiePath = $this.data('cookie-path');
                var cookieValue = `${cookieName}=c=${culture}|uic=${culture};path=${cookiePath}`;
                document.cookie = cookieValue;
                window.location = window.location.href;
            }
        });
    });
</script>
