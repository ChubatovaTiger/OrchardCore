function ResizeWithCanvas(){this.resizecanvas=document.createElement("canvas"),this.resizecanvas.id="tbwresizeme",this.ctx=null,this.resizeimg=null;var e,i,s=["default","se-resize","not-allowed"],t=0,n=["rgb(0, 0, 0)","rgb(200, 0, 0)"],h=[];h.push({points:{x:0,y:0,width:0,height:0},cursor:2,style:0}),h.push({points:{x:0,y:0,width:0,height:0},cursor:2,style:0}),h.push({points:{x:0,y:0,width:0,height:0},cursor:2,style:0}),h.push({points:{x:0,y:0,width:0,height:0},cursor:1,style:1});var r=function(s){console.log("reset offset");var t=s.getBoundingClientRect();e=t.left,i=t.top},a=function(e,i){console.log("draw rect"),i.beginPath(),i.fillStyle=n[e.style],i.rect(e.points.x,e.points.y,e.points.width,e.points.height),i.fill()},o=function(e,i,s,t,n){h[0].points={x:-10,y:-10,width:20,height:20},h[1].points={x:t-10,y:-10,width:20,height:20},h[2].points={x:-10,y:n-10,width:20,height:20},h[3].points={x:t-10,y:n-10,width:20,height:20};for(var o=0;o<h.length;o++)a(h[o],i);return i.beginPath(),i.rect(5,5,t-10,n-10),i.stroke(),i.drawImage(s,10,10,t-20,n-20),r(e),i};this.init=function(){var e=this;window.onscroll=function(i){console.log("onscroll offset"),r(e.resizecanvas)},window.onresize=function(i){console.log("onresize offset"),r(e.resizecanvas)}},this.reCalcOffset=function(){r(this.resizecanvas)},this.canvasId=function(){return this.resizecanvas.id},this.isActive=function(){return null!==this.resizeimg},this.reset=function(){console.log("resize reset"),null!==this.resizeimg&&(this.resizeimg.width=this.resizecanvas.clientWidth-20,this.resizeimg.height=this.resizecanvas.clientHeight-20,$(this.resizecanvas).replaceWith($(this.resizeimg)),this.resizecanvas.style="",this.resizeimg=null)},this.setup=function(n,r){if(console.log("resize setup"),this.resizeimg=n,this.resizecanvas.getContext){this.resizecanvas.width=$(this.resizeimg).width()+20,this.resizecanvas.height=$(this.resizeimg).height()+20,this.ctx=this.resizecanvas.getContext("2d"),$(this.resizeimg).replaceWith($(this.resizecanvas)),o(this.resizecanvas,this.ctx,this.resizeimg,this.resizecanvas.width,this.resizecanvas.height),$(this.resizecanvas).resizable(r).on("mousedown",(function(e){return e.preventDefault()}));var c=this.ctx;return $(this.resizecanvas).on("mousemove",(function(n){var r;mouseX=parseInt(n.clientX-e),mouseY=parseInt(n.clientY-i);for(var o=0;o<h.length;o++){var l=h[o];if(a(l,c),c.isPointInPath(mouseX,mouseY)){r=l.cursor;break}}r?!r==t&&(t=r,this.style.cursor=s[t]):t>0&&(t=0,this.style.cursor=s[t])})),!0}return!1},this.refresh=function(){console.log("resize refresh"),this.resizecanvas.getContext&&(this.resizecanvas.width=this.resizecanvas.clientWidth,this.resizecanvas.height=this.resizecanvas.clientHeight,o(this.resizecanvas,this.ctx,this.resizeimg,this.resizecanvas.width,this.resizecanvas.height))}}
