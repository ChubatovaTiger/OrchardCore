/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

///<reference path='../Lib/jquery/typings.d.ts' />
var applyFilter = function applyFilter(category, q) {
  var type = $('.modal-activities').data('activity-type');
  category = category || $('.activity-picker-categories .nav-link.active').attr('href').substr(1);
  q = q || $('.modal-activities input[type=search]').val();
  var $cards = $('.activity.card').show(); // Remove activities whoes type doesn't match the configured activity type.

  $cards.filter(function (i, el) {
    return $(el).data('activity-type') != type;
  }).hide();

  if (q.length > 0) {
    // Remove activities whose title doesn't match the query.
    $cards.filter(function (i, el) {
      return $(el).find('.card-title').text().toLowerCase().indexOf(q.toLowerCase()) < 0 && q && q.length > 0;
    }).hide();
  } else {
    // Remove activities whose category doesn't match the selected one.
    $cards.filter(function (i, el) {
      return $(el).data('category').toLowerCase() != category.toLowerCase() && category.toLowerCase() != 'all';
    }).hide();
  } // Show or hide categories based on whether there are any available activities.


  $('.activity-picker-categories [data-category]').each(function (i, el) {
    var categoryListItem = $(el);
    var category = categoryListItem.data('category'); // Count number of activities within this category and for the specified activity type (Event or Task).

    var activityCount = $(".activity.card[data-category='".concat(category, "'][data-activity-type='").concat(type, "']")).length;
    activityCount == 0 ? categoryListItem.hide() : categoryListItem.show();
  });
};

$(function () {
  $('.activity-picker-categories').on('click', '.nav-link', function (e) {
    applyFilter($(e.target).attr('href').substr(1), null);
  });
  $('.modal-activities input[type=search]').on('keyup', function (e) {
    applyFilter(null, $(e.target).val());
  });
  $('#activity-picker').on('show.bs.modal', function (event) {
    var modalEvent = event;
    var button = $(modalEvent.relatedTarget); // Button that triggered the modal.

    var title = button.data('picker-title');
    var type = button.data('activity-type');
    var modal = $(this);
    modal.find('[href="#all"]').click();
    modal.find('.modal-title').text(title);
    modal.data('activity-type', type);
    applyFilter(null, null);
  });
});
///<reference path="../../../Assets/Lib/jquery/typings.d.ts" />
$(function () {
  var generateWorkflowUrl = function generateWorkflowUrl() {
    var workflowTypeId = $('[data-workflow-type-id]').data('workflow-type-id');
    var activityId = $('[data-activity-id]').data('activity-id');
    var tokenLifeSpan = $('#token-lifespan').val();
    var generateUrl = $('[data-generate-url]').data('generate-url') + "?workflowTypeId=".concat(workflowTypeId, "&activityId=").concat(activityId, "&tokenLifeSpan=").concat(tokenLifeSpan);
    var antiforgeryHeaderName = $('[data-antiforgery-header-name]').data('antiforgery-header-name');
    var antiforgeryToken = $('[data-antiforgery-token]').data('antiforgery-token');
    var headers = {};
    headers[antiforgeryHeaderName] = antiforgeryToken;
    $.post({
      url: generateUrl,
      headers: headers
    }).done(function (url) {
      $('#workflow-url-text').val(url);
    });
  };

  $('#generate-url-button').on('click', function (e) {
    generateWorkflowUrl();
  });

  if ($('#workflow-url-text').val() == '') {
    generateWorkflowUrl();
  }
});
///<reference path='../Lib/jquery/typings.d.ts' />
///<reference path='../Lib/jsplumb/typings.d.ts' />
///<reference path='./workflow-models.ts' />
var WorkflowCanvas =
/** @class */
function () {
  function WorkflowCanvas(container, workflowType) {
    var _this = this;

    this.container = container;
    this.workflowType = workflowType;
    this.minCanvasHeight = 400;

    this.getActivityElements = function () {
      return $(_this.container).find('.activity');
    };

    this.getDefaults = function () {
      return {
        Anchor: "Continuous",
        DragOptions: {
          cursor: 'pointer',
          zIndex: 2000
        },
        EndpointStyles: [{
          fillStyle: '#225588'
        }],
        Endpoints: [["Dot", {
          radius: 7
        }], ["Blank"]],
        ConnectionOverlays: [["Arrow", {
          width: 12,
          length: 12,
          location: -5
        }]],
        ConnectorZIndex: 5
      };
    };

    this.createJsPlumbInstance = function () {
      return jsPlumb.getInstance({
        DragOptions: {
          cursor: 'pointer',
          zIndex: 2000
        },
        ConnectionOverlays: [['Arrow', {
          location: 1,
          visible: true,
          width: 11,
          length: 11
        }], ['Label', {
          location: 0.5,
          id: 'label',
          cssClass: 'connection-label'
        }]],
        Container: _this.container
      });
    };

    this.getEndpointColor = function (activity) {
      return activity.isBlocking || activity.isStart ? '#7ab02c' : activity.isEvent ? '#3a8acd' : '#7ab02c';
    };

    this.getSourceEndpointOptions = function (activity, outcome) {
      // The definition of source endpoints.
      var paintColor = _this.getEndpointColor(activity);

      return {
        endpoint: 'Dot',
        anchor: 'Continuous',
        paintStyle: {
          stroke: paintColor,
          fill: paintColor,
          radius: 7,
          strokeWidth: 1
        },
        isSource: true,
        connector: ['Flowchart', {
          stub: [40, 60],
          gap: 0,
          cornerRadius: 5,
          alwaysRespectStubs: true
        }],
        connectorStyle: {
          strokeWidth: 2,
          stroke: '#999999',
          joinstyle: 'round',
          outlineStroke: 'white',
          outlineWidth: 2
        },
        hoverPaintStyle: {
          fill: '#216477',
          stroke: '#216477'
        },
        connectorHoverStyle: {
          strokeWidth: 3,
          stroke: '#216477',
          outlineWidth: 5,
          outlineStroke: 'white'
        },
        connectorOverlays: [['Label', {
          location: [3, -1.5],
          cssClass: 'endpointSourceLabel'
        }]],
        dragOptions: {},
        uuid: "".concat(activity.id, "-").concat(outcome.name),
        parameters: {
          outcome: outcome
        }
      };
    };

    this.getActivity = function (id, activities) {
      if (activities === void 0) {
        activities = null;
      }

      if (!activities) {
        activities = this.workflowType.activities;
      }

      return $.grep(activities, function (x) {
        return x.id === id;
      })[0];
    };

    this.updateConnections = function (plumber) {
      var workflowId = _this.workflowType.id; // Connect activities.

      for (var _i = 0, _a = _this.workflowType.transitions; _i < _a.length; _i++) {
        var transitionModel = _a[_i];
        var sourceEndpointUuid = "".concat(transitionModel.sourceActivityId, "-").concat(transitionModel.sourceOutcomeName);
        var sourceEndpoint = plumber.getEndpoint(sourceEndpointUuid);
        var destinationElementId = "activity-".concat(workflowId, "-").concat(transitionModel.destinationActivityId);
        plumber.connect({
          source: sourceEndpoint,
          target: destinationElementId
        });
      }
    };

    this.updateCanvasHeight = function () {
      var $container = $(this.container); // Get the activity element with the highest Y coordinate.

      var $activityElements = $container.find(".activity");
      var currentElementTop = 0;
      var currentActivityHeight = 0;

      for (var _i = 0, _a = $activityElements.toArray(); _i < _a.length; _i++) {
        var activityElement = _a[_i];
        var $activityElement = $(activityElement);
        var top_1 = $activityElement.position().top;

        if (top_1 > currentElementTop) {
          currentElementTop = top_1;
          currentActivityHeight = $activityElement.height();
        }
      }

      var newCanvasHeight = currentElementTop + currentActivityHeight;
      var elementBottom = currentElementTop + currentActivityHeight;
      var stretchValue = 100;

      if (newCanvasHeight - elementBottom <= stretchValue) {
        newCanvasHeight += stretchValue;
      }

      $container.height(Math.max(this.minCanvasHeight, newCanvasHeight));
    };
  }

  return WorkflowCanvas;
}();
///<reference path='../Lib/jquery/typings.d.ts' />
///<reference path='../Lib/jsplumb/typings.d.ts' />
///<reference path='./workflow-models.ts' />
///<reference path='./workflow-canvas.ts' />
var __extends = this && this.__extends || function () {
  var _extendStatics = function extendStatics(d, b) {
    _extendStatics = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function (d, b) {
      d.__proto__ = b;
    } || function (d, b) {
      for (var p in b) {
        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];
      }
    };

    return _extendStatics(d, b);
  };

  return function (d, b) {
    if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");

    _extendStatics(d, b);

    function __() {
      this.constructor = d;
    }

    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}(); // TODO: Re-implement this using a MVVM approach.


var WorkflowEditor =
/** @class */
function (_super) {
  __extends(WorkflowEditor, _super);

  function WorkflowEditor(container, workflowType, deleteActivityPrompt, localId, loadLocalState) {
    var _this = _super.call(this, container, workflowType) || this;

    _this.container = container;
    _this.workflowType = workflowType;
    _this.deleteActivityPrompt = deleteActivityPrompt;
    _this.localId = localId;

    _this.getState = function () {
      var $allActivityElements = $(_this.container).find('.activity');
      var workflow = {
        id: _this.workflowType.id,
        activities: [],
        transitions: [],
        removedActivities: _this.workflowType.removedActivities
      }; // Collect activities.

      for (var i = 0; i < $allActivityElements.length; i++) {
        var $activityElement = $($allActivityElements[i]);
        var activityId = $activityElement.data('activity-id');
        var activityIsStart = $activityElement.data('activity-start');
        var activityIsEvent = $activityElement.data('activity-type') === 'Event';
        var activityPosition = $activityElement.position();

        var activity = _this.getActivity(activityId);

        workflow.activities.push({
          id: activityId,
          isStart: activityIsStart,
          isEvent: activityIsEvent,
          outcomes: activity.outcomes,
          x: activityPosition.left,
          y: activityPosition.top
        });
      } // Collect connections.


      var allConnections = _this.jsPlumbInstance.getConnections();

      for (var i = 0; i < allConnections.length; i++) {
        var connection = allConnections[i];
        var sourceEndpoint = connection.endpoints[0];
        var sourceOutcomeName = sourceEndpoint.getParameters().outcome.name;
        var sourceActivityId = $(connection.source).data('activity-id');
        var destinationActivityId = $(connection.target).data('activity-id');
        workflow.transitions.push({
          sourceActivityId: sourceActivityId,
          destinationActivityId: destinationActivityId,
          sourceOutcomeName: sourceOutcomeName
        });
      }

      return workflow;
    };

    _this.serialize = function () {
      var workflow = _this.getState();

      return JSON.stringify(workflow);
    };

    _this.saveLocalState = function () {
      sessionStorage[_this.localId] = _this.serialize();
    };

    _this.loadLocalState = function () {
      return JSON.parse(sessionStorage[_this.localId]);
    };

    var self = _this;
    jsPlumb.ready(function () {
      jsPlumb.importDefaults(_this.getDefaults());

      var plumber = _this.createJsPlumbInstance(); // Listen for new connections.


      plumber.bind('connection', function (connInfo, originalEvent) {
        var connection = connInfo.connection;
        var outcome = connection.getParameters().outcome;
        var label = connection.getOverlay('label');
        label.setLabel(outcome.displayName);
      });

      var activityElements = _this.getActivityElements();

      var areEqualOutcomes = function areEqualOutcomes(outcomes1, outcomes2) {
        if (outcomes1.length != outcomes2.length) {
          return false;
        }

        for (var i = 0; i < outcomes1.length; i++) {
          var outcome1 = outcomes1[i];
          var outcome2 = outcomes2[i];

          if (outcome1.name != outcome2.displayName || outcome1.displayName != outcome2.displayName) {
            return false;
          }
        }

        return true;
      }; // Suspend drawing and initialize.


      plumber.batch(function () {
        var serverworkflowType = _this.workflowType;
        var workflowId = _this.workflowType.id;

        if (loadLocalState) {
          var localState = _this.loadLocalState();

          if (localState) {
            _this.workflowType = localState;
          }
        }

        activityElements.each(function (index, activityElement) {
          var $activityElement = $(activityElement);
          var activityId = $activityElement.data('activity-id');
          var isDeleted = _this.workflowType.removedActivities.indexOf(activityId) > -1;

          if (isDeleted) {
            $activityElement.remove();
            return;
          }

          var activity = _this.getActivity(activityId);

          var serverActivity = _this.getActivity(activityId, serverworkflowType.activities); // Update the activity's visual state.


          if (loadLocalState) {
            if (activity == null) {
              // This is a newly added activity not yet added to local state.
              activity = serverActivity;

              _this.workflowType.activities.push(activity);

              activity.x = 50;
              activity.y = 50;
            } else {
              // The available outcomes might have changed when editing an activity,
              // so we need to check for that and update the client's activity outcomes if so.
              var sameOutcomes = areEqualOutcomes(activity.outcomes, serverActivity.outcomes);

              if (!sameOutcomes) {
                activity.outcomes = serverActivity.outcomes;
              }

              $activityElement.css({
                left: activity.x,
                top: activity.y
              }).toggleClass('activity-start', activity.isStart).data('activity-start', activity.isStart);
            }
          } // Make the activity draggable.


          plumber.draggable(activityElement, {
            grid: [10, 10],
            containment: true,
            start: function start(args) {
              _this.dragStart = {
                left: args.e.screenX,
                top: args.e.screenY
              };
            },
            stop: function stop(args) {
              _this.hasDragged = _this.dragStart.left != args.e.screenX || _this.dragStart.top != args.e.screenY;

              _this.updateCanvasHeight();
            }
          }); // Configure the activity as a target.

          plumber.makeTarget(activityElement, {
            dropOptions: {
              hoverClass: 'hover'
            },
            anchor: 'Continuous',
            endpoint: ['Blank', {
              radius: 8
            }]
          }); // Add source endpoints.

          for (var _i = 0, _a = activity.outcomes; _i < _a.length; _i++) {
            var outcome = _a[_i];

            var sourceEndpointOptions = _this.getSourceEndpointOptions(activity, outcome);

            plumber.addEndpoint(activityElement, {
              connectorOverlays: [['Label', {
                label: outcome.displayName,
                cssClass: 'connection-label'
              }]]
            }, sourceEndpointOptions);
          }
        }); // Connect activities.

        _this.updateConnections(plumber); // Re-query the activity elements.


        activityElements = _this.getActivityElements(); // Make all activity elements visible.

        activityElements.show();

        _this.updateCanvasHeight();
      }); // Initialize popovers.

      activityElements.popover({
        trigger: 'manual',
        html: true,
        content: function content() {
          var activityElement = $(this);
          var $content = activityElement.find('.activity-commands').clone().show();
          var startButton = $content.find('.activity-start-action');
          var isStart = activityElement.data('activity-start') === true;
          var activityId = activityElement.data('activity-id');
          startButton.attr('aria-pressed', activityElement.data('activity-start'));
          startButton.toggleClass('active', isStart);
          $content.on('click', '.activity-start-action', function (e) {
            e.preventDefault();
            var button = $(e.currentTarget);
            button.button('toggle');
            var isStart = button.is('.active');
            activityElement.data('activity-start', isStart);
            activityElement.toggleClass('activity-start', isStart);
          });
          $content.on('click', '.activity-delete-action', function (e) {
            e.preventDefault(); // TODO: The prompts are really annoying. Consider showing some sort of small message balloon somewhere to undo the action instead.
            //if (!confirm(self.deleteActivityPrompt)) {
            //    return;
            //}

            self.workflowType.removedActivities.push(activityId);
            plumber.remove(activityElement);
            activityElement.popover('dispose');
          });
          $content.on('click', '[data-persist-workflow]', function (e) {
            self.saveLocalState();
          });
          return $content.get(0);
        }
      });
      $(container).on('click', '.activity', function (e) {
        if (_this.hasDragged) {
          _this.hasDragged = false;
          return;
        } // if any other popovers are visible, hide them


        if (_this.isPopoverVisible) {
          activityElements.popover('hide');
        }

        var sender = $(e.currentTarget);
        sender.popover('show'); // handle clicking on the popover itself.

        $('.popover').off('click').on('click', function (e2) {
          e2.stopPropagation();
        });
        e.stopPropagation();
        _this.isPopoverVisible = true;
      });
      $(container).on('dblclick', '.activity', function (e) {
        var sender = $(e.currentTarget);
        var hasEditor = sender.data('activity-has-editor');

        if (hasEditor) {
          _this.saveLocalState();

          sender.find('.activity-edit-action').get(0).click();
        }
      }); // Hide all popovers when clicking anywhere but on an activity.

      $('body').on('click', function (e) {
        activityElements.popover('hide');
        _this.isPopoverVisible = false;
      }); // Save local changes if the event target has the 'data-persist-workflow' attribute.

      $('body').on('click', '[data-persist-workflow]', function (e) {
        _this.saveLocalState();
      });
      _this.jsPlumbInstance = plumber;
    });
    return _this;
  }

  return WorkflowEditor;
}(WorkflowCanvas);

$.fn.workflowEditor = function () {
  this.each(function (index, element) {
    var $element = $(element);
    var workflowType = $element.data('workflow-type');
    var deleteActivityPrompt = $element.data('workflow-delete-activity-prompt');
    var localId = $element.data('workflow-local-id');
    var loadLocalState = $element.data('workflow-load-local-state');
    workflowType.removedActivities = workflowType.removedActivities || [];
    $element.data('workflowEditor', new WorkflowEditor(element, workflowType, deleteActivityPrompt, localId, loadLocalState));
  });
  return this;
};

$(document).ready(function () {
  var workflowEditor = $('.workflow-canvas').workflowEditor().data('workflowEditor');
  $('#workflowEditorForm').on('submit', function (s, e) {
    var state = workflowEditor.serialize();
    $('#workflowStateInput').val(state);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjdGl2aXR5LXBpY2tlci50cyIsIndvcmtmbG93LXVybC1nZW5lcmF0b3IudHMiLCJ3b3JrZmxvdy1jYW52YXMudHMiLCJ3b3JrZmxvdy1lZGl0b3IudHMiLCJ3b3JrZmxvdy1lZGl0b3IuanMiXSwibmFtZXMiOlsiYXBwbHlGaWx0ZXIiLCJjYXRlZ29yeSIsInEiLCJ0eXBlIiwiJCIsImRhdGEiLCJhdHRyIiwic3Vic3RyIiwidmFsIiwiJGNhcmRzIiwic2hvdyIsImZpbHRlciIsImkiLCJlbCIsImhpZGUiLCJsZW5ndGgiLCJmaW5kIiwidGV4dCIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsImVhY2giLCJjYXRlZ29yeUxpc3RJdGVtIiwiYWN0aXZpdHlDb3VudCIsImNvbmNhdCIsIm9uIiwiZSIsInRhcmdldCIsImV2ZW50IiwibW9kYWxFdmVudCIsImJ1dHRvbiIsInJlbGF0ZWRUYXJnZXQiLCJ0aXRsZSIsIm1vZGFsIiwiY2xpY2siLCJnZW5lcmF0ZVdvcmtmbG93VXJsIiwid29ya2Zsb3dUeXBlSWQiLCJhY3Rpdml0eUlkIiwidG9rZW5MaWZlU3BhbiIsImdlbmVyYXRlVXJsIiwiYW50aWZvcmdlcnlIZWFkZXJOYW1lIiwiYW50aWZvcmdlcnlUb2tlbiIsImhlYWRlcnMiLCJwb3N0IiwidXJsIiwiZG9uZSIsIldvcmtmbG93Q2FudmFzIiwiY29udGFpbmVyIiwid29ya2Zsb3dUeXBlIiwiX3RoaXMiLCJtaW5DYW52YXNIZWlnaHQiLCJnZXRBY3Rpdml0eUVsZW1lbnRzIiwiZ2V0RGVmYXVsdHMiLCJBbmNob3IiLCJEcmFnT3B0aW9ucyIsImN1cnNvciIsInpJbmRleCIsIkVuZHBvaW50U3R5bGVzIiwiZmlsbFN0eWxlIiwiRW5kcG9pbnRzIiwicmFkaXVzIiwiQ29ubmVjdGlvbk92ZXJsYXlzIiwid2lkdGgiLCJsb2NhdGlvbiIsIkNvbm5lY3RvclpJbmRleCIsImNyZWF0ZUpzUGx1bWJJbnN0YW5jZSIsImpzUGx1bWIiLCJnZXRJbnN0YW5jZSIsInZpc2libGUiLCJpZCIsImNzc0NsYXNzIiwiQ29udGFpbmVyIiwiZ2V0RW5kcG9pbnRDb2xvciIsImFjdGl2aXR5IiwiaXNCbG9ja2luZyIsImlzU3RhcnQiLCJpc0V2ZW50IiwiZ2V0U291cmNlRW5kcG9pbnRPcHRpb25zIiwib3V0Y29tZSIsInBhaW50Q29sb3IiLCJlbmRwb2ludCIsImFuY2hvciIsInBhaW50U3R5bGUiLCJzdHJva2UiLCJmaWxsIiwic3Ryb2tlV2lkdGgiLCJpc1NvdXJjZSIsImNvbm5lY3RvciIsInN0dWIiLCJnYXAiLCJjb3JuZXJSYWRpdXMiLCJhbHdheXNSZXNwZWN0U3R1YnMiLCJjb25uZWN0b3JTdHlsZSIsImpvaW5zdHlsZSIsIm91dGxpbmVTdHJva2UiLCJvdXRsaW5lV2lkdGgiLCJob3ZlclBhaW50U3R5bGUiLCJjb25uZWN0b3JIb3ZlclN0eWxlIiwiY29ubmVjdG9yT3ZlcmxheXMiLCJkcmFnT3B0aW9ucyIsInV1aWQiLCJuYW1lIiwicGFyYW1ldGVycyIsImdldEFjdGl2aXR5IiwiYWN0aXZpdGllcyIsImdyZXAiLCJ4IiwidXBkYXRlQ29ubmVjdGlvbnMiLCJwbHVtYmVyIiwid29ya2Zsb3dJZCIsIl9pIiwiX2EiLCJ0cmFuc2l0aW9ucyIsInRyYW5zaXRpb25Nb2RlbCIsInNvdXJjZUVuZHBvaW50VXVpZCIsInNvdXJjZUFjdGl2aXR5SWQiLCJzb3VyY2VPdXRjb21lTmFtZSIsInNvdXJjZUVuZHBvaW50IiwiZ2V0RW5kcG9pbnQiLCJkZXN0aW5hdGlvbkVsZW1lbnRJZCIsImRlc3RpbmF0aW9uQWN0aXZpdHlJZCIsImNvbm5lY3QiLCJzb3VyY2UiLCJ1cGRhdGVDYW52YXNIZWlnaHQiLCIkY29udGFpbmVyIiwiJGFjdGl2aXR5RWxlbWVudHMiLCJjdXJyZW50RWxlbWVudFRvcCIsImN1cnJlbnRBY3Rpdml0eUhlaWdodCIsInRvQXJyYXkiLCJhY3Rpdml0eUVsZW1lbnQiLCIkYWN0aXZpdHlFbGVtZW50IiwidG9wXzEiLCJwb3NpdGlvbiIsInRvcCIsImhlaWdodCIsIm5ld0NhbnZhc0hlaWdodCIsImVsZW1lbnRCb3R0b20iLCJzdHJldGNoVmFsdWUiLCJNYXRoIiwibWF4IiwiX19leHRlbmRzIiwiZXh0ZW5kU3RhdGljcyIsImQiLCJiIiwiT2JqZWN0Iiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsInAiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJUeXBlRXJyb3IiLCJTdHJpbmciLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiV29ya2Zsb3dFZGl0b3IiLCJfc3VwZXIiLCJkZWxldGVBY3Rpdml0eVByb21wdCIsImxvY2FsSWQiLCJsb2FkTG9jYWxTdGF0ZSIsImdldFN0YXRlIiwiJGFsbEFjdGl2aXR5RWxlbWVudHMiLCJ3b3JrZmxvdyIsInJlbW92ZWRBY3Rpdml0aWVzIiwiYWN0aXZpdHlJc1N0YXJ0IiwiYWN0aXZpdHlJc0V2ZW50IiwiYWN0aXZpdHlQb3NpdGlvbiIsInB1c2giLCJvdXRjb21lcyIsImxlZnQiLCJ5IiwiYWxsQ29ubmVjdGlvbnMiLCJqc1BsdW1iSW5zdGFuY2UiLCJnZXRDb25uZWN0aW9ucyIsImNvbm5lY3Rpb24iLCJlbmRwb2ludHMiLCJnZXRQYXJhbWV0ZXJzIiwic2VyaWFsaXplIiwiSlNPTiIsInN0cmluZ2lmeSIsInNhdmVMb2NhbFN0YXRlIiwic2Vzc2lvblN0b3JhZ2UiLCJwYXJzZSIsInNlbGYiLCJyZWFkeSIsImltcG9ydERlZmF1bHRzIiwiYmluZCIsImNvbm5JbmZvIiwib3JpZ2luYWxFdmVudCIsImxhYmVsIiwiZ2V0T3ZlcmxheSIsInNldExhYmVsIiwiZGlzcGxheU5hbWUiLCJhY3Rpdml0eUVsZW1lbnRzIiwiYXJlRXF1YWxPdXRjb21lcyIsIm91dGNvbWVzMSIsIm91dGNvbWVzMiIsIm91dGNvbWUxIiwib3V0Y29tZTIiLCJiYXRjaCIsInNlcnZlcndvcmtmbG93VHlwZSIsImxvY2FsU3RhdGUiLCJpbmRleCIsImlzRGVsZXRlZCIsInJlbW92ZSIsInNlcnZlckFjdGl2aXR5Iiwic2FtZU91dGNvbWVzIiwiY3NzIiwidG9nZ2xlQ2xhc3MiLCJkcmFnZ2FibGUiLCJncmlkIiwiY29udGFpbm1lbnQiLCJzdGFydCIsImFyZ3MiLCJkcmFnU3RhcnQiLCJzY3JlZW5YIiwic2NyZWVuWSIsInN0b3AiLCJoYXNEcmFnZ2VkIiwibWFrZVRhcmdldCIsImRyb3BPcHRpb25zIiwiaG92ZXJDbGFzcyIsInNvdXJjZUVuZHBvaW50T3B0aW9ucyIsImFkZEVuZHBvaW50IiwicG9wb3ZlciIsInRyaWdnZXIiLCJodG1sIiwiY29udGVudCIsIiRjb250ZW50IiwiY2xvbmUiLCJzdGFydEJ1dHRvbiIsInByZXZlbnREZWZhdWx0IiwiY3VycmVudFRhcmdldCIsImlzIiwiZ2V0IiwiaXNQb3BvdmVyVmlzaWJsZSIsInNlbmRlciIsIm9mZiIsImUyIiwic3RvcFByb3BhZ2F0aW9uIiwiaGFzRWRpdG9yIiwiZm4iLCJ3b3JrZmxvd0VkaXRvciIsImVsZW1lbnQiLCIkZWxlbWVudCIsImRvY3VtZW50IiwicyIsInN0YXRlIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBRUEsSUFBSUEsV0FBVyxHQUFHLFNBQWRBLFdBQWMsQ0FBVUMsUUFBVixFQUE0QkMsQ0FBNUIsRUFBcUM7RUFDbkQsSUFBTUMsSUFBSSxHQUFHQyxDQUFDLENBQUMsbUJBQUQsQ0FBRCxDQUF1QkMsSUFBdkIsQ0FBNEIsZUFBNUIsQ0FBYjtFQUNBSixRQUFRLEdBQUdBLFFBQVEsSUFBSUcsQ0FBQyxDQUFDLDhDQUFELENBQUQsQ0FBa0RFLElBQWxELENBQXVELE1BQXZELEVBQStEQyxNQUEvRCxDQUFzRSxDQUF0RSxDQUF2QjtFQUNBTCxDQUFDLEdBQUdBLENBQUMsSUFBWUUsQ0FBQyxDQUFDLHNDQUFELENBQUQsQ0FBMENJLEdBQTFDLEVBQWpCO0VBRUEsSUFBTUMsTUFBTSxHQUFHTCxDQUFDLENBQUMsZ0JBQUQsQ0FBRCxDQUFvQk0sSUFBcEIsRUFBZixDQUxtRCxDQU9uRDs7RUFDQUQsTUFBTSxDQUFDRSxNQUFQLENBQWMsVUFBQ0MsQ0FBRCxFQUFJQyxFQUFKLEVBQU07SUFDaEIsT0FBT1QsQ0FBQyxDQUFDUyxFQUFELENBQUQsQ0FBTVIsSUFBTixDQUFXLGVBQVgsS0FBK0JGLElBQXRDO0VBQ0gsQ0FGRCxFQUVHVyxJQUZIOztFQUlBLElBQUlaLENBQUMsQ0FBQ2EsTUFBRixHQUFXLENBQWYsRUFBa0I7SUFDZDtJQUNBTixNQUFNLENBQUNFLE1BQVAsQ0FBYyxVQUFDQyxDQUFELEVBQUlDLEVBQUosRUFBTTtNQUNoQixPQUFPVCxDQUFDLENBQUNTLEVBQUQsQ0FBRCxDQUFNRyxJQUFOLENBQVcsYUFBWCxFQUEwQkMsSUFBMUIsR0FBaUNDLFdBQWpDLEdBQStDQyxPQUEvQyxDQUF1RGpCLENBQUMsQ0FBQ2dCLFdBQUYsRUFBdkQsSUFBMEUsQ0FBMUUsSUFBK0VoQixDQUEvRSxJQUFvRkEsQ0FBQyxDQUFDYSxNQUFGLEdBQVcsQ0FBdEc7SUFDSCxDQUZELEVBRUdELElBRkg7RUFHSCxDQUxELE1BTUs7SUFDRDtJQUNBTCxNQUFNLENBQUNFLE1BQVAsQ0FBYyxVQUFDQyxDQUFELEVBQUlDLEVBQUosRUFBTTtNQUNoQixPQUFPVCxDQUFDLENBQUNTLEVBQUQsQ0FBRCxDQUFNUixJQUFOLENBQVcsVUFBWCxFQUF1QmEsV0FBdkIsTUFBd0NqQixRQUFRLENBQUNpQixXQUFULEVBQXhDLElBQWtFakIsUUFBUSxDQUFDaUIsV0FBVCxNQUEwQixLQUFuRztJQUNILENBRkQsRUFFR0osSUFGSDtFQUdILENBdkJrRCxDQXlCbkQ7OztFQUNBVixDQUFDLENBQUMsNkNBQUQsQ0FBRCxDQUFpRGdCLElBQWpELENBQXNELFVBQUNSLENBQUQsRUFBSUMsRUFBSixFQUFNO0lBQ3hELElBQU1RLGdCQUFnQixHQUFHakIsQ0FBQyxDQUFDUyxFQUFELENBQTFCO0lBQ0EsSUFBTVosUUFBUSxHQUFHb0IsZ0JBQWdCLENBQUNoQixJQUFqQixDQUFzQixVQUF0QixDQUFqQixDQUZ3RCxDQUl4RDs7SUFDQSxJQUFNaUIsYUFBYSxHQUFHbEIsQ0FBQyxDQUFDLGlDQUFBbUIsTUFBQSxDQUFpQ3RCLFFBQWpDLEVBQXlDLHlCQUF6QyxFQUF5Q3NCLE1BQXpDLENBQW1FcEIsSUFBbkUsRUFBdUUsSUFBdkUsQ0FBRCxDQUFELENBQStFWSxNQUFyRztJQUNBTyxhQUFhLElBQUksQ0FBakIsR0FBcUJELGdCQUFnQixDQUFDUCxJQUFqQixFQUFyQixHQUErQ08sZ0JBQWdCLENBQUNYLElBQWpCLEVBQS9DO0VBQ0gsQ0FQRDtBQVFILENBbENEOztBQW9DQU4sQ0FBQyxDQUFDLFlBQUE7RUFDRUEsQ0FBQyxDQUFDLDZCQUFELENBQUQsQ0FBaUNvQixFQUFqQyxDQUFvQyxPQUFwQyxFQUE2QyxXQUE3QyxFQUEwRCxVQUFBQyxDQUFBLEVBQUM7SUFDdkR6QixXQUFXLENBQUNJLENBQUMsQ0FBQ3FCLENBQUMsQ0FBQ0MsTUFBSCxDQUFELENBQVlwQixJQUFaLENBQWlCLE1BQWpCLEVBQXlCQyxNQUF6QixDQUFnQyxDQUFoQyxDQUFELEVBQXFDLElBQXJDLENBQVg7RUFDSCxDQUZEO0VBSUFILENBQUMsQ0FBQyxzQ0FBRCxDQUFELENBQTBDb0IsRUFBMUMsQ0FBNkMsT0FBN0MsRUFBc0QsVUFBQUMsQ0FBQSxFQUFDO0lBQ25EekIsV0FBVyxDQUFDLElBQUQsRUFBZUksQ0FBQyxDQUFDcUIsQ0FBQyxDQUFDQyxNQUFILENBQUQsQ0FBWWxCLEdBQVosRUFBZixDQUFYO0VBQ0gsQ0FGRDtFQUlBSixDQUFDLENBQUMsa0JBQUQsQ0FBRCxDQUFzQm9CLEVBQXRCLENBQXlCLGVBQXpCLEVBQTBDLFVBQVVHLEtBQVYsRUFBZTtJQUNyRCxJQUFJQyxVQUFVLEdBQUdELEtBQWpCO0lBQ0EsSUFBSUUsTUFBTSxHQUFHekIsQ0FBQyxDQUFDd0IsVUFBVSxDQUFDRSxhQUFaLENBQWQsQ0FGcUQsQ0FFWDs7SUFDMUMsSUFBSUMsS0FBSyxHQUFHRixNQUFNLENBQUN4QixJQUFQLENBQVksY0FBWixDQUFaO0lBQ0EsSUFBSUYsSUFBSSxHQUFHMEIsTUFBTSxDQUFDeEIsSUFBUCxDQUFZLGVBQVosQ0FBWDtJQUNBLElBQUkyQixLQUFLLEdBQUc1QixDQUFDLENBQUMsSUFBRCxDQUFiO0lBQ0E0QixLQUFLLENBQUNoQixJQUFOLENBQVcsZUFBWCxFQUE0QmlCLEtBQTVCO0lBQ0FELEtBQUssQ0FBQ2hCLElBQU4sQ0FBVyxjQUFYLEVBQTJCQyxJQUEzQixDQUFnQ2MsS0FBaEM7SUFDQUMsS0FBSyxDQUFDM0IsSUFBTixDQUFXLGVBQVgsRUFBNEJGLElBQTVCO0lBQ0FILFdBQVcsQ0FBQyxJQUFELEVBQU8sSUFBUCxDQUFYO0VBQ0gsQ0FWRDtBQVdILENBcEJBLENBQUQ7QUN0Q0E7QUFFQUksQ0FBQyxDQUFDLFlBQUE7RUFDRSxJQUFNOEIsbUJBQW1CLEdBQUcsU0FBdEJBLG1CQUFzQixHQUFBO0lBQ3hCLElBQU1DLGNBQWMsR0FBVy9CLENBQUMsQ0FBQyx5QkFBRCxDQUFELENBQTZCQyxJQUE3QixDQUFrQyxrQkFBbEMsQ0FBL0I7SUFDQSxJQUFNK0IsVUFBVSxHQUFXaEMsQ0FBQyxDQUFDLG9CQUFELENBQUQsQ0FBd0JDLElBQXhCLENBQTZCLGFBQTdCLENBQTNCO0lBQ0EsSUFBSWdDLGFBQWEsR0FBR2pDLENBQUMsQ0FBQyxpQkFBRCxDQUFELENBQXFCSSxHQUFyQixFQUFwQjtJQUNBLElBQU04QixXQUFXLEdBQVdsQyxDQUFDLENBQUMscUJBQUQsQ0FBRCxDQUF5QkMsSUFBekIsQ0FBOEIsY0FBOUIsSUFBZ0QsbUJBQUFrQixNQUFBLENBQW1CWSxjQUFuQixFQUFpQyxjQUFqQyxFQUFpQ1osTUFBakMsQ0FBZ0RhLFVBQWhELEVBQTBELGlCQUExRCxFQUEwRGIsTUFBMUQsQ0FBNEVjLGFBQTVFLENBQTVFO0lBQ0EsSUFBTUUscUJBQXFCLEdBQVduQyxDQUFDLENBQUMsZ0NBQUQsQ0FBRCxDQUFvQ0MsSUFBcEMsQ0FBeUMseUJBQXpDLENBQXRDO0lBQ0EsSUFBTW1DLGdCQUFnQixHQUFXcEMsQ0FBQyxDQUFDLDBCQUFELENBQUQsQ0FBOEJDLElBQTlCLENBQW1DLG1CQUFuQyxDQUFqQztJQUNBLElBQU1vQyxPQUFPLEdBQVEsRUFBckI7SUFFQUEsT0FBTyxDQUFDRixxQkFBRCxDQUFQLEdBQWlDQyxnQkFBakM7SUFFQXBDLENBQUMsQ0FBQ3NDLElBQUYsQ0FBTztNQUNIQyxHQUFHLEVBQUVMLFdBREY7TUFFSEcsT0FBTyxFQUFFQTtJQUZOLENBQVAsRUFHR0csSUFISCxDQUdRLFVBQUFELEdBQUEsRUFBRztNQUNQdkMsQ0FBQyxDQUFDLG9CQUFELENBQUQsQ0FBd0JJLEdBQXhCLENBQTRCbUMsR0FBNUI7SUFDSCxDQUxEO0VBTUgsQ0FqQkQ7O0VBbUJBdkMsQ0FBQyxDQUFDLHNCQUFELENBQUQsQ0FBMEJvQixFQUExQixDQUE2QixPQUE3QixFQUFzQyxVQUFBQyxDQUFBLEVBQUM7SUFDbkNTLG1CQUFtQjtFQUN0QixDQUZEOztFQUlBLElBQUk5QixDQUFDLENBQUMsb0JBQUQsQ0FBRCxDQUF3QkksR0FBeEIsTUFBaUMsRUFBckMsRUFBeUM7SUFDckMwQixtQkFBbUI7RUFDdEI7QUFDSixDQTNCQSxDQUFEO0FDRkE7QUFDQTtBQUNBO0FBRUEsSUFBQVcsY0FBQTtBQUFBO0FBQUEsWUFBQTtFQUdJLFNBQUFBLGNBQUEsQ0FBc0JDLFNBQXRCLEVBQXdEQyxZQUF4RCxFQUE0RjtJQUE1RixJQUFBQyxLQUFBLEdBQUEsSUFBQTs7SUFBc0IsS0FBQUYsU0FBQSxHQUFBQSxTQUFBO0lBQWtDLEtBQUFDLFlBQUEsR0FBQUEsWUFBQTtJQUZoRCxLQUFBRSxlQUFBLEdBQTBCLEdBQTFCOztJQUtFLEtBQUFDLG1CQUFBLEdBQXNCLFlBQUE7TUFDNUIsT0FBTzlDLENBQUMsQ0FBQzRDLEtBQUksQ0FBQ0YsU0FBTixDQUFELENBQWtCOUIsSUFBbEIsQ0FBdUIsV0FBdkIsQ0FBUDtJQUNILENBRlM7O0lBSUEsS0FBQW1DLFdBQUEsR0FBYyxZQUFBO01BQ3BCLE9BQU87UUFDSEMsTUFBTSxFQUFFLFlBREw7UUFFSEMsV0FBVyxFQUFFO1VBQUVDLE1BQU0sRUFBRSxTQUFWO1VBQXFCQyxNQUFNLEVBQUU7UUFBN0IsQ0FGVjtRQUdIQyxjQUFjLEVBQUUsQ0FBQztVQUFFQyxTQUFTLEVBQUU7UUFBYixDQUFELENBSGI7UUFJSEMsU0FBUyxFQUFFLENBQUMsQ0FBQyxLQUFELEVBQVE7VUFBRUMsTUFBTSxFQUFFO1FBQVYsQ0FBUixDQUFELEVBQXlCLENBQUMsT0FBRCxDQUF6QixDQUpSO1FBS0hDLGtCQUFrQixFQUFFLENBQ2hCLENBQUMsT0FBRCxFQUFVO1VBQUVDLEtBQUssRUFBRSxFQUFUO1VBQWE5QyxNQUFNLEVBQUUsRUFBckI7VUFBeUIrQyxRQUFRLEVBQUUsQ0FBQztRQUFwQyxDQUFWLENBRGdCLENBTGpCO1FBUUhDLGVBQWUsRUFBRTtNQVJkLENBQVA7SUFVSCxDQVhTOztJQWFBLEtBQUFDLHFCQUFBLEdBQXdCLFlBQUE7TUFDOUIsT0FBT0MsT0FBTyxDQUFDQyxXQUFSLENBQW9CO1FBQ3ZCYixXQUFXLEVBQUU7VUFBRUMsTUFBTSxFQUFFLFNBQVY7VUFBcUJDLE1BQU0sRUFBRTtRQUE3QixDQURVO1FBRXZCSyxrQkFBa0IsRUFBRSxDQUNoQixDQUFDLE9BQUQsRUFBVTtVQUNORSxRQUFRLEVBQUUsQ0FESjtVQUVOSyxPQUFPLEVBQUUsSUFGSDtVQUdOTixLQUFLLEVBQUUsRUFIRDtVQUlOOUMsTUFBTSxFQUFFO1FBSkYsQ0FBVixDQURnQixFQU9oQixDQUFDLE9BQUQsRUFBVTtVQUNOK0MsUUFBUSxFQUFFLEdBREo7VUFFTk0sRUFBRSxFQUFFLE9BRkU7VUFHTkMsUUFBUSxFQUFFO1FBSEosQ0FBVixDQVBnQixDQUZHO1FBZXZCQyxTQUFTLEVBQUV0QixLQUFJLENBQUNGO01BZk8sQ0FBcEIsQ0FBUDtJQWlCSCxDQWxCUzs7SUFvQkEsS0FBQXlCLGdCQUFBLEdBQW1CLFVBQUNDLFFBQUQsRUFBNkI7TUFDdEQsT0FBT0EsUUFBUSxDQUFDQyxVQUFULElBQXVCRCxRQUFRLENBQUNFLE9BQWhDLEdBQTBDLFNBQTFDLEdBQXNERixRQUFRLENBQUNHLE9BQVQsR0FBbUIsU0FBbkIsR0FBK0IsU0FBNUY7SUFDSCxDQUZTOztJQUlBLEtBQUFDLHdCQUFBLEdBQTJCLFVBQUNKLFFBQUQsRUFBK0JLLE9BQS9CLEVBQXlEO01BQzFGO01BQ0EsSUFBTUMsVUFBVSxHQUFHOUIsS0FBSSxDQUFDdUIsZ0JBQUwsQ0FBc0JDLFFBQXRCLENBQW5COztNQUNBLE9BQU87UUFDSE8sUUFBUSxFQUFFLEtBRFA7UUFFSEMsTUFBTSxFQUFFLFlBRkw7UUFHSEMsVUFBVSxFQUFFO1VBQ1JDLE1BQU0sRUFBRUosVUFEQTtVQUVSSyxJQUFJLEVBQUVMLFVBRkU7VUFHUm5CLE1BQU0sRUFBRSxDQUhBO1VBSVJ5QixXQUFXLEVBQUU7UUFKTCxDQUhUO1FBU0hDLFFBQVEsRUFBRSxJQVRQO1FBVUhDLFNBQVMsRUFBRSxDQUFDLFdBQUQsRUFBYztVQUFFQyxJQUFJLEVBQUUsQ0FBQyxFQUFELEVBQUssRUFBTCxDQUFSO1VBQWtCQyxHQUFHLEVBQUUsQ0FBdkI7VUFBMEJDLFlBQVksRUFBRSxDQUF4QztVQUEyQ0Msa0JBQWtCLEVBQUU7UUFBL0QsQ0FBZCxDQVZSO1FBV0hDLGNBQWMsRUFBRTtVQUNaUCxXQUFXLEVBQUUsQ0FERDtVQUVaRixNQUFNLEVBQUUsU0FGSTtVQUdaVSxTQUFTLEVBQUUsT0FIQztVQUlaQyxhQUFhLEVBQUUsT0FKSDtVQUtaQyxZQUFZLEVBQUU7UUFMRixDQVhiO1FBa0JIQyxlQUFlLEVBQUU7VUFDYlosSUFBSSxFQUFFLFNBRE87VUFFYkQsTUFBTSxFQUFFO1FBRkssQ0FsQmQ7UUFzQkhjLG1CQUFtQixFQUFFO1VBQ2pCWixXQUFXLEVBQUUsQ0FESTtVQUVqQkYsTUFBTSxFQUFFLFNBRlM7VUFHakJZLFlBQVksRUFBRSxDQUhHO1VBSWpCRCxhQUFhLEVBQUU7UUFKRSxDQXRCbEI7UUE0QkhJLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxPQUFELEVBQVU7VUFBRW5DLFFBQVEsRUFBRSxDQUFDLENBQUQsRUFBSSxDQUFDLEdBQUwsQ0FBWjtVQUF1Qk8sUUFBUSxFQUFFO1FBQWpDLENBQVYsQ0FBRCxDQTVCaEI7UUE2Qkg2QixXQUFXLEVBQUUsRUE3QlY7UUE4QkhDLElBQUksRUFBRSxHQUFBNUUsTUFBQSxDQUFHaUQsUUFBUSxDQUFDSixFQUFaLEVBQWMsR0FBZCxFQUFjN0MsTUFBZCxDQUFrQnNELE9BQU8sQ0FBQ3VCLElBQTFCLENBOUJIO1FBK0JIQyxVQUFVLEVBQUU7VUFDUnhCLE9BQU8sRUFBRUE7UUFERDtNQS9CVCxDQUFQO0lBbUNILENBdENTOztJQXdDQSxLQUFBeUIsV0FBQSxHQUFjLFVBQVVsQyxFQUFWLEVBQXNCbUMsVUFBdEIsRUFBa0U7TUFBNUMsSUFBQUEsVUFBQSxLQUFBLEtBQUEsQ0FBQSxFQUFBO1FBQUFBLFVBQUEsR0FBQSxJQUFBO01BQTRDOztNQUN0RixJQUFJLENBQUNBLFVBQUwsRUFBaUI7UUFDYkEsVUFBVSxHQUFHLEtBQUt4RCxZQUFMLENBQWtCd0QsVUFBL0I7TUFDSDs7TUFDRCxPQUFPbkcsQ0FBQyxDQUFDb0csSUFBRixDQUFPRCxVQUFQLEVBQW1CLFVBQUNFLENBQUQsRUFBc0I7UUFBSyxPQUFBQSxDQUFDLENBQUNyQyxFQUFGLEtBQVNBLEVBQVQ7TUFBVyxDQUF6RCxFQUEyRCxDQUEzRCxDQUFQO0lBQ0gsQ0FMUzs7SUFPQSxLQUFBc0MsaUJBQUEsR0FBb0IsVUFBQ0MsT0FBRCxFQUF5QjtNQUNuRCxJQUFJQyxVQUFVLEdBQVc1RCxLQUFJLENBQUNELFlBQUwsQ0FBa0JxQixFQUEzQyxDQURtRCxDQUduRDs7TUFDQSxLQUE0QixJQUFBeUMsRUFBQSxHQUFBLENBQUEsRUFBQUMsRUFBQSxHQUFBOUQsS0FBSSxDQUFDRCxZQUFMLENBQWtCZ0UsV0FBOUMsRUFBNEJGLEVBQUEsR0FBQUMsRUFBQSxDQUFBL0YsTUFBNUIsRUFBNEI4RixFQUFBLEVBQTVCLEVBQTJEO1FBQXRELElBQUlHLGVBQWUsR0FBQUYsRUFBQSxDQUFBRCxFQUFBLENBQW5CO1FBQ0QsSUFBTUksa0JBQWtCLEdBQVcsR0FBQTFGLE1BQUEsQ0FBR3lGLGVBQWUsQ0FBQ0UsZ0JBQW5CLEVBQW1DLEdBQW5DLEVBQW1DM0YsTUFBbkMsQ0FBdUN5RixlQUFlLENBQUNHLGlCQUF2RCxDQUFuQztRQUNBLElBQU1DLGNBQWMsR0FBYVQsT0FBTyxDQUFDVSxXQUFSLENBQW9CSixrQkFBcEIsQ0FBakM7UUFDQSxJQUFNSyxvQkFBb0IsR0FBVyxZQUFBL0YsTUFBQSxDQUFZcUYsVUFBWixFQUFzQixHQUF0QixFQUFzQnJGLE1BQXRCLENBQTBCeUYsZUFBZSxDQUFDTyxxQkFBMUMsQ0FBckM7UUFFQVosT0FBTyxDQUFDYSxPQUFSLENBQWdCO1VBQ1pDLE1BQU0sRUFBRUwsY0FESTtVQUVaMUYsTUFBTSxFQUFFNEY7UUFGSSxDQUFoQjtNQUlIO0lBQ0osQ0FkUzs7SUFnQkEsS0FBQUksa0JBQUEsR0FBcUIsWUFBQTtNQUMzQixJQUFNQyxVQUFVLEdBQUd2SCxDQUFDLENBQUMsS0FBSzBDLFNBQU4sQ0FBcEIsQ0FEMkIsQ0FHM0I7O01BQ0EsSUFBTThFLGlCQUFpQixHQUFHRCxVQUFVLENBQUMzRyxJQUFYLENBQWdCLFdBQWhCLENBQTFCO01BQ0EsSUFBSTZHLGlCQUFpQixHQUFHLENBQXhCO01BQ0EsSUFBSUMscUJBQXFCLEdBQUcsQ0FBNUI7O01BRUEsS0FBNEIsSUFBQWpCLEVBQUEsR0FBQSxDQUFBLEVBQUFDLEVBQUEsR0FBQWMsaUJBQWlCLENBQUNHLE9BQWxCLEVBQTVCLEVBQTRCbEIsRUFBQSxHQUFBQyxFQUFBLENBQUEvRixNQUE1QixFQUE0QjhGLEVBQUEsRUFBNUIsRUFBeUQ7UUFBcEQsSUFBSW1CLGVBQWUsR0FBQWxCLEVBQUEsQ0FBQUQsRUFBQSxDQUFuQjtRQUNELElBQU1vQixnQkFBZ0IsR0FBRzdILENBQUMsQ0FBQzRILGVBQUQsQ0FBMUI7UUFDQSxJQUFNRSxLQUFHLEdBQUdELGdCQUFnQixDQUFDRSxRQUFqQixHQUE0QkMsR0FBeEM7O1FBRUEsSUFBSUYsS0FBRyxHQUFHTCxpQkFBVixFQUE2QjtVQUN6QkEsaUJBQWlCLEdBQUdLLEtBQXBCO1VBQ0FKLHFCQUFxQixHQUFHRyxnQkFBZ0IsQ0FBQ0ksTUFBakIsRUFBeEI7UUFDSDtNQUNKOztNQUVELElBQUlDLGVBQWUsR0FBR1QsaUJBQWlCLEdBQUdDLHFCQUExQztNQUNBLElBQU1TLGFBQWEsR0FBR1YsaUJBQWlCLEdBQUdDLHFCQUExQztNQUNBLElBQU1VLFlBQVksR0FBRyxHQUFyQjs7TUFFQSxJQUFJRixlQUFlLEdBQUdDLGFBQWxCLElBQW1DQyxZQUF2QyxFQUFxRDtRQUNqREYsZUFBZSxJQUFJRSxZQUFuQjtNQUNIOztNQUVEYixVQUFVLENBQUNVLE1BQVgsQ0FBa0JJLElBQUksQ0FBQ0MsR0FBTCxDQUFTLEtBQUt6RixlQUFkLEVBQStCcUYsZUFBL0IsQ0FBbEI7SUFDSCxDQTNCUztFQTFHVDs7RUFzSUwsT0FBQXpGLGNBQUE7QUExSUEsQ0FBQSxFQUFBO0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUNDQSxJQUFJOEYsU0FBUyxHQUFJLFFBQVEsS0FBS0EsU0FBZCxJQUE2QixZQUFZO0VBQ3JELElBQUlDLGNBQWEsR0FBRyx1QkFBVUMsQ0FBVixFQUFhQyxDQUFiLEVBQWdCO0lBQ2hDRixjQUFhLEdBQUdHLE1BQU0sQ0FBQ0MsY0FBUCxJQUNYO01BQUVDLFNBQVMsRUFBRTtJQUFiLGFBQTZCQyxLQUE3QixJQUFzQyxVQUFVTCxDQUFWLEVBQWFDLENBQWIsRUFBZ0I7TUFBRUQsQ0FBQyxDQUFDSSxTQUFGLEdBQWNILENBQWQ7SUFBa0IsQ0FEL0QsSUFFWixVQUFVRCxDQUFWLEVBQWFDLENBQWIsRUFBZ0I7TUFBRSxLQUFLLElBQUlLLENBQVQsSUFBY0wsQ0FBZDtRQUFpQixJQUFJQyxNQUFNLENBQUNLLFNBQVAsQ0FBaUJDLGNBQWpCLENBQWdDQyxJQUFoQyxDQUFxQ1IsQ0FBckMsRUFBd0NLLENBQXhDLENBQUosRUFBZ0ROLENBQUMsQ0FBQ00sQ0FBRCxDQUFELEdBQU9MLENBQUMsQ0FBQ0ssQ0FBRCxDQUFSO01BQWpFO0lBQStFLENBRnJHOztJQUdBLE9BQU9QLGNBQWEsQ0FBQ0MsQ0FBRCxFQUFJQyxDQUFKLENBQXBCO0VBQ0gsQ0FMRDs7RUFNQSxPQUFPLFVBQVVELENBQVYsRUFBYUMsQ0FBYixFQUFnQjtJQUNuQixJQUFJLE9BQU9BLENBQVAsS0FBYSxVQUFiLElBQTJCQSxDQUFDLEtBQUssSUFBckMsRUFDSSxNQUFNLElBQUlTLFNBQUosQ0FBYyx5QkFBeUJDLE1BQU0sQ0FBQ1YsQ0FBRCxDQUEvQixHQUFxQywrQkFBbkQsQ0FBTjs7SUFDSkYsY0FBYSxDQUFDQyxDQUFELEVBQUlDLENBQUosQ0FBYjs7SUFDQSxTQUFTVyxFQUFULEdBQWM7TUFBRSxLQUFLQyxXQUFMLEdBQW1CYixDQUFuQjtJQUF1Qjs7SUFDdkNBLENBQUMsQ0FBQ08sU0FBRixHQUFjTixDQUFDLEtBQUssSUFBTixHQUFhQyxNQUFNLENBQUNZLE1BQVAsQ0FBY2IsQ0FBZCxDQUFiLElBQWlDVyxFQUFFLENBQUNMLFNBQUgsR0FBZU4sQ0FBQyxDQUFDTSxTQUFqQixFQUE0QixJQUFJSyxFQUFKLEVBQTdELENBQWQ7RUFDSCxDQU5EO0FBT0gsQ0FkMkMsRUFBNUMsQyxDRENBOzs7QUFDQSxJQUFBRyxjQUFBO0FBQUE7QUFBQSxVQUFBQyxNQUFBLEVBQUE7RUFBNkJsQixTQUFBLENBQUFpQixjQUFBLEVBQUFDLE1BQUEsQ0FBQTs7RUFNekIsU0FBQUQsY0FBQSxDQUFzQjlHLFNBQXRCLEVBQXdEQyxZQUF4RCxFQUFzRytHLG9CQUF0RyxFQUE0SUMsT0FBNUksRUFBNkpDLGNBQTdKLEVBQW9MO0lBQXBMLElBQUFoSCxLQUFBLEdBQ0k2RyxNQUFBLENBQUFQLElBQUEsQ0FBQSxJQUFBLEVBQU14RyxTQUFOLEVBQWlCQyxZQUFqQixLQUE4QixJQURsQzs7SUFBc0JDLEtBQUEsQ0FBQUYsU0FBQSxHQUFBQSxTQUFBO0lBQWtDRSxLQUFBLENBQUFELFlBQUEsR0FBQUEsWUFBQTtJQUE4Q0MsS0FBQSxDQUFBOEcsb0JBQUEsR0FBQUEsb0JBQUE7SUFBc0M5RyxLQUFBLENBQUErRyxPQUFBLEdBQUFBLE9BQUE7O0lBOE5wSS9HLEtBQUEsQ0FBQWlILFFBQUEsR0FBVyxZQUFBO01BQ2YsSUFBTUMsb0JBQW9CLEdBQUc5SixDQUFDLENBQUM0QyxLQUFJLENBQUNGLFNBQU4sQ0FBRCxDQUFrQjlCLElBQWxCLENBQXVCLFdBQXZCLENBQTdCO01BQ0EsSUFBTW1KLFFBQVEsR0FBMkI7UUFDckMvRixFQUFFLEVBQUVwQixLQUFJLENBQUNELFlBQUwsQ0FBa0JxQixFQURlO1FBRXJDbUMsVUFBVSxFQUFFLEVBRnlCO1FBR3JDUSxXQUFXLEVBQUUsRUFId0I7UUFJckNxRCxpQkFBaUIsRUFBRXBILEtBQUksQ0FBQ0QsWUFBTCxDQUFrQnFIO01BSkEsQ0FBekMsQ0FGZSxDQVNmOztNQUNBLEtBQUssSUFBSXhKLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUdzSixvQkFBb0IsQ0FBQ25KLE1BQXpDLEVBQWlESCxDQUFDLEVBQWxELEVBQXNEO1FBQ2xELElBQU1xSCxnQkFBZ0IsR0FBVzdILENBQUMsQ0FBQzhKLG9CQUFvQixDQUFDdEosQ0FBRCxDQUFyQixDQUFsQztRQUNBLElBQU13QixVQUFVLEdBQVc2RixnQkFBZ0IsQ0FBQzVILElBQWpCLENBQXNCLGFBQXRCLENBQTNCO1FBQ0EsSUFBTWdLLGVBQWUsR0FBWXBDLGdCQUFnQixDQUFDNUgsSUFBakIsQ0FBc0IsZ0JBQXRCLENBQWpDO1FBQ0EsSUFBTWlLLGVBQWUsR0FBWXJDLGdCQUFnQixDQUFDNUgsSUFBakIsQ0FBc0IsZUFBdEIsTUFBMkMsT0FBNUU7UUFDQSxJQUFNa0ssZ0JBQWdCLEdBQXVCdEMsZ0JBQWdCLENBQUNFLFFBQWpCLEVBQTdDOztRQUNBLElBQU0zRCxRQUFRLEdBQXVCeEIsS0FBSSxDQUFDc0QsV0FBTCxDQUFpQmxFLFVBQWpCLENBQXJDOztRQUVBK0gsUUFBUSxDQUFDNUQsVUFBVCxDQUFvQmlFLElBQXBCLENBQXlCO1VBQ3JCcEcsRUFBRSxFQUFFaEMsVUFEaUI7VUFFckJzQyxPQUFPLEVBQUUyRixlQUZZO1VBR3JCMUYsT0FBTyxFQUFFMkYsZUFIWTtVQUlyQkcsUUFBUSxFQUFFakcsUUFBUSxDQUFDaUcsUUFKRTtVQUtyQmhFLENBQUMsRUFBRThELGdCQUFnQixDQUFDRyxJQUxDO1VBTXJCQyxDQUFDLEVBQUVKLGdCQUFnQixDQUFDbkM7UUFOQyxDQUF6QjtNQVFILENBMUJjLENBNEJmOzs7TUFDQSxJQUFNd0MsY0FBYyxHQUFHNUgsS0FBSSxDQUFDNkgsZUFBTCxDQUFxQkMsY0FBckIsRUFBdkI7O01BRUEsS0FBSyxJQUFJbEssQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR2dLLGNBQWMsQ0FBQzdKLE1BQW5DLEVBQTJDSCxDQUFDLEVBQTVDLEVBQWdEO1FBQzVDLElBQUltSyxVQUFVLEdBQUdILGNBQWMsQ0FBQ2hLLENBQUQsQ0FBL0I7UUFDQSxJQUFJd0csY0FBYyxHQUFhMkQsVUFBVSxDQUFDQyxTQUFYLENBQXFCLENBQXJCLENBQS9CO1FBQ0EsSUFBSTdELGlCQUFpQixHQUFHQyxjQUFjLENBQUM2RCxhQUFmLEdBQStCcEcsT0FBL0IsQ0FBdUN1QixJQUEvRDtRQUNBLElBQUljLGdCQUFnQixHQUFXOUcsQ0FBQyxDQUFDMkssVUFBVSxDQUFDdEQsTUFBWixDQUFELENBQXFCcEgsSUFBckIsQ0FBMEIsYUFBMUIsQ0FBL0I7UUFDQSxJQUFJa0gscUJBQXFCLEdBQVduSCxDQUFDLENBQUMySyxVQUFVLENBQUNySixNQUFaLENBQUQsQ0FBcUJyQixJQUFyQixDQUEwQixhQUExQixDQUFwQztRQUVBOEosUUFBUSxDQUFDcEQsV0FBVCxDQUFxQnlELElBQXJCLENBQTBCO1VBQ3RCdEQsZ0JBQWdCLEVBQUVBLGdCQURJO1VBRXRCSyxxQkFBcUIsRUFBRUEscUJBRkQ7VUFHdEJKLGlCQUFpQixFQUFFQTtRQUhHLENBQTFCO01BS0g7O01BRUQsT0FBT2dELFFBQVA7SUFDSCxDQTlDTzs7SUFnRERuSCxLQUFBLENBQUFrSSxTQUFBLEdBQVksWUFBQTtNQUNmLElBQU1mLFFBQVEsR0FBMkJuSCxLQUFJLENBQUNpSCxRQUFMLEVBQXpDOztNQUNBLE9BQU9rQixJQUFJLENBQUNDLFNBQUwsQ0FBZWpCLFFBQWYsQ0FBUDtJQUNILENBSE07O0lBS0NuSCxLQUFBLENBQUFxSSxjQUFBLEdBQWlCLFlBQUE7TUFDckJDLGNBQWMsQ0FBQ3RJLEtBQUksQ0FBQytHLE9BQU4sQ0FBZCxHQUErQi9HLEtBQUksQ0FBQ2tJLFNBQUwsRUFBL0I7SUFDSCxDQUZPOztJQUlBbEksS0FBQSxDQUFBZ0gsY0FBQSxHQUFpQixZQUFBO01BQ3JCLE9BQU9tQixJQUFJLENBQUNJLEtBQUwsQ0FBV0QsY0FBYyxDQUFDdEksS0FBSSxDQUFDK0csT0FBTixDQUF6QixDQUFQO0lBQ0gsQ0FGTzs7SUFyUkosSUFBTXlCLElBQUksR0FBR3hJLEtBQWI7SUFFQWlCLE9BQU8sQ0FBQ3dILEtBQVIsQ0FBYyxZQUFBO01BQ1Z4SCxPQUFPLENBQUN5SCxjQUFSLENBQXVCMUksS0FBSSxDQUFDRyxXQUFMLEVBQXZCOztNQUVBLElBQU13RCxPQUFPLEdBQUczRCxLQUFJLENBQUNnQixxQkFBTCxFQUFoQixDQUhVLENBS1Y7OztNQUNBMkMsT0FBTyxDQUFDZ0YsSUFBUixDQUFhLFlBQWIsRUFBMkIsVUFBVUMsUUFBVixFQUFvQkMsYUFBcEIsRUFBaUM7UUFDeEQsSUFBTWQsVUFBVSxHQUFlYSxRQUFRLENBQUNiLFVBQXhDO1FBQ0EsSUFBTWxHLE9BQU8sR0FBc0JrRyxVQUFVLENBQUNFLGFBQVgsR0FBMkJwRyxPQUE5RDtRQUVBLElBQU1pSCxLQUFLLEdBQVFmLFVBQVUsQ0FBQ2dCLFVBQVgsQ0FBc0IsT0FBdEIsQ0FBbkI7UUFDQUQsS0FBSyxDQUFDRSxRQUFOLENBQWVuSCxPQUFPLENBQUNvSCxXQUF2QjtNQUNILENBTkQ7O01BUUEsSUFBSUMsZ0JBQWdCLEdBQUdsSixLQUFJLENBQUNFLG1CQUFMLEVBQXZCOztNQUVBLElBQUlpSixnQkFBZ0IsR0FBRyxTQUFuQkEsZ0JBQW1CLENBQVVDLFNBQVYsRUFBMENDLFNBQTFDLEVBQXdFO1FBQzNGLElBQUlELFNBQVMsQ0FBQ3JMLE1BQVYsSUFBb0JzTCxTQUFTLENBQUN0TCxNQUFsQyxFQUEwQztVQUN0QyxPQUFPLEtBQVA7UUFDSDs7UUFFRCxLQUFLLElBQUlILENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUd3TCxTQUFTLENBQUNyTCxNQUE5QixFQUFzQ0gsQ0FBQyxFQUF2QyxFQUEyQztVQUN2QyxJQUFNMEwsUUFBUSxHQUFHRixTQUFTLENBQUN4TCxDQUFELENBQTFCO1VBQ0EsSUFBTTJMLFFBQVEsR0FBR0YsU0FBUyxDQUFDekwsQ0FBRCxDQUExQjs7VUFFQSxJQUFJMEwsUUFBUSxDQUFDbEcsSUFBVCxJQUFpQm1HLFFBQVEsQ0FBQ04sV0FBMUIsSUFBeUNLLFFBQVEsQ0FBQ0wsV0FBVCxJQUF3Qk0sUUFBUSxDQUFDTixXQUE5RSxFQUEyRjtZQUN2RixPQUFPLEtBQVA7VUFDSDtRQUNKOztRQUVELE9BQU8sSUFBUDtNQUNILENBZkQsQ0FoQlUsQ0FpQ1Y7OztNQUNBdEYsT0FBTyxDQUFDNkYsS0FBUixDQUFjLFlBQUE7UUFDVixJQUFJQyxrQkFBa0IsR0FBMkJ6SixLQUFJLENBQUNELFlBQXREO1FBQ0EsSUFBSTZELFVBQVUsR0FBVzVELEtBQUksQ0FBQ0QsWUFBTCxDQUFrQnFCLEVBQTNDOztRQUVBLElBQUk0RixjQUFKLEVBQW9CO1VBQ2hCLElBQU0wQyxVQUFVLEdBQTJCMUosS0FBSSxDQUFDZ0gsY0FBTCxFQUEzQzs7VUFFQSxJQUFJMEMsVUFBSixFQUFnQjtZQUNaMUosS0FBSSxDQUFDRCxZQUFMLEdBQW9CMkosVUFBcEI7VUFDSDtRQUNKOztRQUVEUixnQkFBZ0IsQ0FBQzlLLElBQWpCLENBQXNCLFVBQUN1TCxLQUFELEVBQVEzRSxlQUFSLEVBQXVCO1VBQ3pDLElBQU1DLGdCQUFnQixHQUFHN0gsQ0FBQyxDQUFDNEgsZUFBRCxDQUExQjtVQUNBLElBQU01RixVQUFVLEdBQUc2RixnQkFBZ0IsQ0FBQzVILElBQWpCLENBQXNCLGFBQXRCLENBQW5CO1VBQ0EsSUFBTXVNLFNBQVMsR0FBRzVKLEtBQUksQ0FBQ0QsWUFBTCxDQUFrQnFILGlCQUFsQixDQUFvQ2pKLE9BQXBDLENBQTRDaUIsVUFBNUMsSUFBMEQsQ0FBQyxDQUE3RTs7VUFFQSxJQUFJd0ssU0FBSixFQUFlO1lBQ1gzRSxnQkFBZ0IsQ0FBQzRFLE1BQWpCO1lBQ0E7VUFDSDs7VUFFRCxJQUFJckksUUFBUSxHQUFHeEIsS0FBSSxDQUFDc0QsV0FBTCxDQUFpQmxFLFVBQWpCLENBQWY7O1VBQ0EsSUFBTTBLLGNBQWMsR0FBRzlKLEtBQUksQ0FBQ3NELFdBQUwsQ0FBaUJsRSxVQUFqQixFQUE2QnFLLGtCQUFrQixDQUFDbEcsVUFBaEQsQ0FBdkIsQ0FYeUMsQ0FhekM7OztVQUNBLElBQUl5RCxjQUFKLEVBQW9CO1lBQ2hCLElBQUl4RixRQUFRLElBQUksSUFBaEIsRUFBc0I7Y0FDbEI7Y0FDQUEsUUFBUSxHQUFHc0ksY0FBWDs7Y0FDQTlKLEtBQUksQ0FBQ0QsWUFBTCxDQUFrQndELFVBQWxCLENBQTZCaUUsSUFBN0IsQ0FBa0NoRyxRQUFsQzs7Y0FFQUEsUUFBUSxDQUFDaUMsQ0FBVCxHQUFhLEVBQWI7Y0FDQWpDLFFBQVEsQ0FBQ21HLENBQVQsR0FBYSxFQUFiO1lBQ0gsQ0FQRCxNQVFLO2NBQ0Q7Y0FDQTtjQUNBLElBQU1vQyxZQUFZLEdBQUdaLGdCQUFnQixDQUFDM0gsUUFBUSxDQUFDaUcsUUFBVixFQUFvQnFDLGNBQWMsQ0FBQ3JDLFFBQW5DLENBQXJDOztjQUVBLElBQUksQ0FBQ3NDLFlBQUwsRUFBbUI7Z0JBQ2Z2SSxRQUFRLENBQUNpRyxRQUFULEdBQW9CcUMsY0FBYyxDQUFDckMsUUFBbkM7Y0FDSDs7Y0FFRHhDLGdCQUFnQixDQUNYK0UsR0FETCxDQUNTO2dCQUFFdEMsSUFBSSxFQUFFbEcsUUFBUSxDQUFDaUMsQ0FBakI7Z0JBQW9CMkIsR0FBRyxFQUFFNUQsUUFBUSxDQUFDbUc7Y0FBbEMsQ0FEVCxFQUVLc0MsV0FGTCxDQUVpQixnQkFGakIsRUFFbUN6SSxRQUFRLENBQUNFLE9BRjVDLEVBR0tyRSxJQUhMLENBR1UsZ0JBSFYsRUFHNEJtRSxRQUFRLENBQUNFLE9BSHJDO1lBSUg7VUFDSixDQXJDd0MsQ0F1Q3pDOzs7VUFDQWlDLE9BQU8sQ0FBQ3VHLFNBQVIsQ0FBa0JsRixlQUFsQixFQUFtQztZQUMvQm1GLElBQUksRUFBRSxDQUFDLEVBQUQsRUFBSyxFQUFMLENBRHlCO1lBRS9CQyxXQUFXLEVBQUUsSUFGa0I7WUFHL0JDLEtBQUssRUFBRSxlQUFDQyxJQUFELEVBQVU7Y0FDYnRLLEtBQUksQ0FBQ3VLLFNBQUwsR0FBaUI7Z0JBQUU3QyxJQUFJLEVBQUU0QyxJQUFJLENBQUM3TCxDQUFMLENBQU8rTCxPQUFmO2dCQUF3QnBGLEdBQUcsRUFBRWtGLElBQUksQ0FBQzdMLENBQUwsQ0FBT2dNO2NBQXBDLENBQWpCO1lBQ0gsQ0FMOEI7WUFNL0JDLElBQUksRUFBRSxjQUFDSixJQUFELEVBQVU7Y0FDWnRLLEtBQUksQ0FBQzJLLFVBQUwsR0FBa0IzSyxLQUFJLENBQUN1SyxTQUFMLENBQWU3QyxJQUFmLElBQXVCNEMsSUFBSSxDQUFDN0wsQ0FBTCxDQUFPK0wsT0FBOUIsSUFBeUN4SyxLQUFJLENBQUN1SyxTQUFMLENBQWVuRixHQUFmLElBQXNCa0YsSUFBSSxDQUFDN0wsQ0FBTCxDQUFPZ00sT0FBeEY7O2NBQ0F6SyxLQUFJLENBQUMwRSxrQkFBTDtZQUNIO1VBVDhCLENBQW5DLEVBeEN5QyxDQW9EekM7O1VBQ0FmLE9BQU8sQ0FBQ2lILFVBQVIsQ0FBbUI1RixlQUFuQixFQUFvQztZQUNoQzZGLFdBQVcsRUFBRTtjQUFFQyxVQUFVLEVBQUU7WUFBZCxDQURtQjtZQUVoQzlJLE1BQU0sRUFBRSxZQUZ3QjtZQUdoQ0QsUUFBUSxFQUFFLENBQUMsT0FBRCxFQUFVO2NBQUVwQixNQUFNLEVBQUU7WUFBVixDQUFWO1VBSHNCLENBQXBDLEVBckR5QyxDQTJEekM7O1VBQ0EsS0FBb0IsSUFBQWtELEVBQUEsR0FBQSxDQUFBLEVBQUFDLEVBQUEsR0FBQXRDLFFBQVEsQ0FBQ2lHLFFBQTdCLEVBQW9CNUQsRUFBQSxHQUFBQyxFQUFBLENBQUEvRixNQUFwQixFQUFvQjhGLEVBQUEsRUFBcEIsRUFBdUM7WUFBbEMsSUFBSWhDLE9BQU8sR0FBQWlDLEVBQUEsQ0FBQUQsRUFBQSxDQUFYOztZQUNELElBQU1rSCxxQkFBcUIsR0FBRy9LLEtBQUksQ0FBQzRCLHdCQUFMLENBQThCSixRQUE5QixFQUF3Q0ssT0FBeEMsQ0FBOUI7O1lBQ0E4QixPQUFPLENBQUNxSCxXQUFSLENBQW9CaEcsZUFBcEIsRUFBcUM7Y0FBRS9CLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxPQUFELEVBQVU7Z0JBQUU2RixLQUFLLEVBQUVqSCxPQUFPLENBQUNvSCxXQUFqQjtnQkFBOEI1SCxRQUFRLEVBQUU7Y0FBeEMsQ0FBVixDQUFEO1lBQXJCLENBQXJDLEVBQXVJMEoscUJBQXZJO1VBQ0g7UUFDSixDQWhFRCxFQVpVLENBOEVWOztRQUNBL0ssS0FBSSxDQUFDMEQsaUJBQUwsQ0FBdUJDLE9BQXZCLEVBL0VVLENBaUZWOzs7UUFDQXVGLGdCQUFnQixHQUFHbEosS0FBSSxDQUFDRSxtQkFBTCxFQUFuQixDQWxGVSxDQW9GVjs7UUFDQWdKLGdCQUFnQixDQUFDeEwsSUFBakI7O1FBRUFzQyxLQUFJLENBQUMwRSxrQkFBTDtNQUNILENBeEZELEVBbENVLENBNEhWOztNQUNBd0UsZ0JBQWdCLENBQUMrQixPQUFqQixDQUF5QjtRQUNyQkMsT0FBTyxFQUFFLFFBRFk7UUFFckJDLElBQUksRUFBRSxJQUZlO1FBR3JCQyxPQUFPLEVBQUUsbUJBQUE7VUFDTCxJQUFNcEcsZUFBZSxHQUFHNUgsQ0FBQyxDQUFDLElBQUQsQ0FBekI7VUFDQSxJQUFNaU8sUUFBUSxHQUFvQnJHLGVBQWUsQ0FBQ2hILElBQWhCLENBQXFCLG9CQUFyQixFQUEyQ3NOLEtBQTNDLEdBQW1ENU4sSUFBbkQsRUFBbEM7VUFDQSxJQUFNNk4sV0FBVyxHQUFHRixRQUFRLENBQUNyTixJQUFULENBQWMsd0JBQWQsQ0FBcEI7VUFDQSxJQUFNMEQsT0FBTyxHQUFHc0QsZUFBZSxDQUFDM0gsSUFBaEIsQ0FBcUIsZ0JBQXJCLE1BQTJDLElBQTNEO1VBQ0EsSUFBTStCLFVBQVUsR0FBVzRGLGVBQWUsQ0FBQzNILElBQWhCLENBQXFCLGFBQXJCLENBQTNCO1VBRUFrTyxXQUFXLENBQUNqTyxJQUFaLENBQWlCLGNBQWpCLEVBQWlDMEgsZUFBZSxDQUFDM0gsSUFBaEIsQ0FBcUIsZ0JBQXJCLENBQWpDO1VBQ0FrTyxXQUFXLENBQUN0QixXQUFaLENBQXdCLFFBQXhCLEVBQWtDdkksT0FBbEM7VUFFQTJKLFFBQVEsQ0FBQzdNLEVBQVQsQ0FBWSxPQUFaLEVBQXFCLHdCQUFyQixFQUErQyxVQUFBQyxDQUFBLEVBQUM7WUFDNUNBLENBQUMsQ0FBQytNLGNBQUY7WUFDQSxJQUFNM00sTUFBTSxHQUFHekIsQ0FBQyxDQUFDcUIsQ0FBQyxDQUFDZ04sYUFBSCxDQUFoQjtZQUVBNU0sTUFBTSxDQUFDQSxNQUFQLENBQWMsUUFBZDtZQUVBLElBQU02QyxPQUFPLEdBQUc3QyxNQUFNLENBQUM2TSxFQUFQLENBQVUsU0FBVixDQUFoQjtZQUNBMUcsZUFBZSxDQUFDM0gsSUFBaEIsQ0FBcUIsZ0JBQXJCLEVBQXVDcUUsT0FBdkM7WUFDQXNELGVBQWUsQ0FBQ2lGLFdBQWhCLENBQTRCLGdCQUE1QixFQUE4Q3ZJLE9BQTlDO1VBQ0gsQ0FURDtVQVdBMkosUUFBUSxDQUFDN00sRUFBVCxDQUFZLE9BQVosRUFBcUIseUJBQXJCLEVBQWdELFVBQUFDLENBQUEsRUFBQztZQUM3Q0EsQ0FBQyxDQUFDK00sY0FBRixHQUQ2QyxDQUc3QztZQUNBO1lBQ0E7WUFDQTs7WUFFQWhELElBQUksQ0FBQ3pJLFlBQUwsQ0FBa0JxSCxpQkFBbEIsQ0FBb0NJLElBQXBDLENBQXlDcEksVUFBekM7WUFDQXVFLE9BQU8sQ0FBQ2tHLE1BQVIsQ0FBZTdFLGVBQWY7WUFDQUEsZUFBZSxDQUFDaUcsT0FBaEIsQ0FBd0IsU0FBeEI7VUFDSCxDQVhEO1VBYUFJLFFBQVEsQ0FBQzdNLEVBQVQsQ0FBWSxPQUFaLEVBQXFCLHlCQUFyQixFQUFnRCxVQUFBQyxDQUFBLEVBQUM7WUFDN0MrSixJQUFJLENBQUNILGNBQUw7VUFDSCxDQUZEO1VBSUEsT0FBT2dELFFBQVEsQ0FBQ00sR0FBVCxDQUFhLENBQWIsQ0FBUDtRQUNIO01BMUNvQixDQUF6QjtNQTZDQXZPLENBQUMsQ0FBQzBDLFNBQUQsQ0FBRCxDQUFhdEIsRUFBYixDQUFnQixPQUFoQixFQUF5QixXQUF6QixFQUFzQyxVQUFBQyxDQUFBLEVBQUM7UUFDbkMsSUFBSXVCLEtBQUksQ0FBQzJLLFVBQVQsRUFBcUI7VUFDakIzSyxLQUFJLENBQUMySyxVQUFMLEdBQWtCLEtBQWxCO1VBQ0E7UUFDSCxDQUprQyxDQU1uQzs7O1FBQ0EsSUFBSTNLLEtBQUksQ0FBQzRMLGdCQUFULEVBQTJCO1VBQ3ZCMUMsZ0JBQWdCLENBQUMrQixPQUFqQixDQUF5QixNQUF6QjtRQUNIOztRQUVELElBQU1ZLE1BQU0sR0FBR3pPLENBQUMsQ0FBQ3FCLENBQUMsQ0FBQ2dOLGFBQUgsQ0FBaEI7UUFDQUksTUFBTSxDQUFDWixPQUFQLENBQWUsTUFBZixFQVptQyxDQWNuQzs7UUFDQTdOLENBQUMsQ0FBQyxVQUFELENBQUQsQ0FBYzBPLEdBQWQsQ0FBa0IsT0FBbEIsRUFBMkJ0TixFQUEzQixDQUE4QixPQUE5QixFQUF1QyxVQUFBdU4sRUFBQSxFQUFFO1VBQ3JDQSxFQUFFLENBQUNDLGVBQUg7UUFDSCxDQUZEO1FBSUF2TixDQUFDLENBQUN1TixlQUFGO1FBQ0FoTSxLQUFJLENBQUM0TCxnQkFBTCxHQUF3QixJQUF4QjtNQUNILENBckJEO01BdUJBeE8sQ0FBQyxDQUFDMEMsU0FBRCxDQUFELENBQWF0QixFQUFiLENBQWdCLFVBQWhCLEVBQTRCLFdBQTVCLEVBQXlDLFVBQUFDLENBQUEsRUFBQztRQUN0QyxJQUFNb04sTUFBTSxHQUFHek8sQ0FBQyxDQUFDcUIsQ0FBQyxDQUFDZ04sYUFBSCxDQUFoQjtRQUNBLElBQU1RLFNBQVMsR0FBR0osTUFBTSxDQUFDeE8sSUFBUCxDQUFZLHFCQUFaLENBQWxCOztRQUVBLElBQUk0TyxTQUFKLEVBQWU7VUFDWGpNLEtBQUksQ0FBQ3FJLGNBQUw7O1VBQ0F3RCxNQUFNLENBQUM3TixJQUFQLENBQVksdUJBQVosRUFBcUMyTixHQUFyQyxDQUF5QyxDQUF6QyxFQUE0QzFNLEtBQTVDO1FBQ0g7TUFDSixDQVJELEVBak1VLENBMk1WOztNQUNBN0IsQ0FBQyxDQUFDLE1BQUQsQ0FBRCxDQUFVb0IsRUFBVixDQUFhLE9BQWIsRUFBc0IsVUFBQUMsQ0FBQSxFQUFDO1FBQ25CeUssZ0JBQWdCLENBQUMrQixPQUFqQixDQUF5QixNQUF6QjtRQUNBakwsS0FBSSxDQUFDNEwsZ0JBQUwsR0FBd0IsS0FBeEI7TUFDSCxDQUhELEVBNU1VLENBaU5WOztNQUNBeE8sQ0FBQyxDQUFDLE1BQUQsQ0FBRCxDQUFVb0IsRUFBVixDQUFhLE9BQWIsRUFBc0IseUJBQXRCLEVBQWlELFVBQUFDLENBQUEsRUFBQztRQUM5Q3VCLEtBQUksQ0FBQ3FJLGNBQUw7TUFDSCxDQUZEO01BSUFySSxLQUFJLENBQUM2SCxlQUFMLEdBQXVCbEUsT0FBdkI7SUFDSCxDQXZORDtJQzRPQSxPQUFPM0QsS0FBUDtFRHBCSDs7RUE4REwsT0FBQTRHLGNBQUE7QUFoU0EsQ0FBQSxDQUE2Qi9HLGNBQTdCLENBQUE7O0FBa1NBekMsQ0FBQyxDQUFDOE8sRUFBRixDQUFLQyxjQUFMLEdBQXNCLFlBQUE7RUFDbEIsS0FBSy9OLElBQUwsQ0FBVSxVQUFDdUwsS0FBRCxFQUFReUMsT0FBUixFQUFlO0lBQ3JCLElBQUlDLFFBQVEsR0FBR2pQLENBQUMsQ0FBQ2dQLE9BQUQsQ0FBaEI7SUFDQSxJQUFJck0sWUFBWSxHQUEyQnNNLFFBQVEsQ0FBQ2hQLElBQVQsQ0FBYyxlQUFkLENBQTNDO0lBQ0EsSUFBSXlKLG9CQUFvQixHQUFXdUYsUUFBUSxDQUFDaFAsSUFBVCxDQUFjLGlDQUFkLENBQW5DO0lBQ0EsSUFBSTBKLE9BQU8sR0FBV3NGLFFBQVEsQ0FBQ2hQLElBQVQsQ0FBYyxtQkFBZCxDQUF0QjtJQUNBLElBQUkySixjQUFjLEdBQVlxRixRQUFRLENBQUNoUCxJQUFULENBQWMsMkJBQWQsQ0FBOUI7SUFFQTBDLFlBQVksQ0FBQ3FILGlCQUFiLEdBQWlDckgsWUFBWSxDQUFDcUgsaUJBQWIsSUFBa0MsRUFBbkU7SUFDQWlGLFFBQVEsQ0FBQ2hQLElBQVQsQ0FBYyxnQkFBZCxFQUFnQyxJQUFJdUosY0FBSixDQUFtQndGLE9BQW5CLEVBQTRCck0sWUFBNUIsRUFBMEMrRyxvQkFBMUMsRUFBZ0VDLE9BQWhFLEVBQXlFQyxjQUF6RSxDQUFoQztFQUNILENBVEQ7RUFXQSxPQUFPLElBQVA7QUFDSCxDQWJEOztBQWVBNUosQ0FBQyxDQUFDa1AsUUFBRCxDQUFELENBQVk3RCxLQUFaLENBQWtCLFlBQUE7RUFDZCxJQUFNMEQsY0FBYyxHQUFtQi9PLENBQUMsQ0FBQyxrQkFBRCxDQUFELENBQXNCK08sY0FBdEIsR0FBdUM5TyxJQUF2QyxDQUE0QyxnQkFBNUMsQ0FBdkM7RUFFQUQsQ0FBQyxDQUFDLHFCQUFELENBQUQsQ0FBeUJvQixFQUF6QixDQUE0QixRQUE1QixFQUFzQyxVQUFDK04sQ0FBRCxFQUFJOU4sQ0FBSixFQUFLO0lBQ3ZDLElBQU0rTixLQUFLLEdBQUdMLGNBQWMsQ0FBQ2pFLFNBQWYsRUFBZDtJQUNBOUssQ0FBQyxDQUFDLHFCQUFELENBQUQsQ0FBeUJJLEdBQXpCLENBQTZCZ1AsS0FBN0I7RUFDSCxDQUhEO0FBSUgsQ0FQRCIsImZpbGUiOiJvcmNoYXJkLndvcmtmbG93cy1lZGl0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy88cmVmZXJlbmNlIHBhdGg9Jy4uL0xpYi9qcXVlcnkvdHlwaW5ncy5kLnRzJyAvPlxyXG5cclxudmFyIGFwcGx5RmlsdGVyID0gZnVuY3Rpb24gKGNhdGVnb3J5OiBzdHJpbmcsIHE6IHN0cmluZykge1xyXG4gICAgY29uc3QgdHlwZSA9ICQoJy5tb2RhbC1hY3Rpdml0aWVzJykuZGF0YSgnYWN0aXZpdHktdHlwZScpO1xyXG4gICAgY2F0ZWdvcnkgPSBjYXRlZ29yeSB8fCAkKCcuYWN0aXZpdHktcGlja2VyLWNhdGVnb3JpZXMgLm5hdi1saW5rLmFjdGl2ZScpLmF0dHIoJ2hyZWYnKS5zdWJzdHIoMSk7XHJcbiAgICBxID0gcSB8fCA8c3RyaW5nPiQoJy5tb2RhbC1hY3Rpdml0aWVzIGlucHV0W3R5cGU9c2VhcmNoXScpLnZhbCgpO1xyXG5cclxuICAgIGNvbnN0ICRjYXJkcyA9ICQoJy5hY3Rpdml0eS5jYXJkJykuc2hvdygpO1xyXG5cclxuICAgIC8vIFJlbW92ZSBhY3Rpdml0aWVzIHdob2VzIHR5cGUgZG9lc24ndCBtYXRjaCB0aGUgY29uZmlndXJlZCBhY3Rpdml0eSB0eXBlLlxyXG4gICAgJGNhcmRzLmZpbHRlcigoaSwgZWwpID0+IHtcclxuICAgICAgICByZXR1cm4gJChlbCkuZGF0YSgnYWN0aXZpdHktdHlwZScpICE9IHR5cGU7XHJcbiAgICB9KS5oaWRlKCk7XHJcblxyXG4gICAgaWYgKHEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIC8vIFJlbW92ZSBhY3Rpdml0aWVzIHdob3NlIHRpdGxlIGRvZXNuJ3QgbWF0Y2ggdGhlIHF1ZXJ5LlxyXG4gICAgICAgICRjYXJkcy5maWx0ZXIoKGksIGVsKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAkKGVsKS5maW5kKCcuY2FyZC10aXRsZScpLnRleHQoKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YocS50b0xvd2VyQ2FzZSgpKSA8IDAgJiYgcSAmJiBxLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgfSkuaGlkZSgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gUmVtb3ZlIGFjdGl2aXRpZXMgd2hvc2UgY2F0ZWdvcnkgZG9lc24ndCBtYXRjaCB0aGUgc2VsZWN0ZWQgb25lLlxyXG4gICAgICAgICRjYXJkcy5maWx0ZXIoKGksIGVsKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAkKGVsKS5kYXRhKCdjYXRlZ29yeScpLnRvTG93ZXJDYXNlKCkgIT0gY2F0ZWdvcnkudG9Mb3dlckNhc2UoKSAmJiBjYXRlZ29yeS50b0xvd2VyQ2FzZSgpICE9ICdhbGwnO1xyXG4gICAgICAgIH0pLmhpZGUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTaG93IG9yIGhpZGUgY2F0ZWdvcmllcyBiYXNlZCBvbiB3aGV0aGVyIHRoZXJlIGFyZSBhbnkgYXZhaWxhYmxlIGFjdGl2aXRpZXMuXHJcbiAgICAkKCcuYWN0aXZpdHktcGlja2VyLWNhdGVnb3JpZXMgW2RhdGEtY2F0ZWdvcnldJykuZWFjaCgoaSwgZWwpID0+IHtcclxuICAgICAgICBjb25zdCBjYXRlZ29yeUxpc3RJdGVtID0gJChlbCk7XHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBjYXRlZ29yeUxpc3RJdGVtLmRhdGEoJ2NhdGVnb3J5Jyk7XHJcblxyXG4gICAgICAgIC8vIENvdW50IG51bWJlciBvZiBhY3Rpdml0aWVzIHdpdGhpbiB0aGlzIGNhdGVnb3J5IGFuZCBmb3IgdGhlIHNwZWNpZmllZCBhY3Rpdml0eSB0eXBlIChFdmVudCBvciBUYXNrKS5cclxuICAgICAgICBjb25zdCBhY3Rpdml0eUNvdW50ID0gJChgLmFjdGl2aXR5LmNhcmRbZGF0YS1jYXRlZ29yeT0nJHtjYXRlZ29yeX0nXVtkYXRhLWFjdGl2aXR5LXR5cGU9JyR7dHlwZX0nXWApLmxlbmd0aDtcclxuICAgICAgICBhY3Rpdml0eUNvdW50ID09IDAgPyBjYXRlZ29yeUxpc3RJdGVtLmhpZGUoKSA6IGNhdGVnb3J5TGlzdEl0ZW0uc2hvdygpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG4kKCgpID0+IHtcclxuICAgICQoJy5hY3Rpdml0eS1waWNrZXItY2F0ZWdvcmllcycpLm9uKCdjbGljaycsICcubmF2LWxpbmsnLCBlID0+IHtcclxuICAgICAgICBhcHBseUZpbHRlcigkKGUudGFyZ2V0KS5hdHRyKCdocmVmJykuc3Vic3RyKDEpLCBudWxsKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJy5tb2RhbC1hY3Rpdml0aWVzIGlucHV0W3R5cGU9c2VhcmNoXScpLm9uKCdrZXl1cCcsIGUgPT4ge1xyXG4gICAgICAgIGFwcGx5RmlsdGVyKG51bGwsIDxzdHJpbmc+JChlLnRhcmdldCkudmFsKCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnI2FjdGl2aXR5LXBpY2tlcicpLm9uKCdzaG93LmJzLm1vZGFsJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIG1vZGFsRXZlbnQgPSBldmVudCBhcyBhbnk7XHJcbiAgICAgICAgdmFyIGJ1dHRvbiA9ICQobW9kYWxFdmVudC5yZWxhdGVkVGFyZ2V0KTsgLy8gQnV0dG9uIHRoYXQgdHJpZ2dlcmVkIHRoZSBtb2RhbC5cclxuICAgICAgICB2YXIgdGl0bGUgPSBidXR0b24uZGF0YSgncGlja2VyLXRpdGxlJyk7XHJcbiAgICAgICAgdmFyIHR5cGUgPSBidXR0b24uZGF0YSgnYWN0aXZpdHktdHlwZScpO1xyXG4gICAgICAgIHZhciBtb2RhbCA9ICQodGhpcyk7XHJcbiAgICAgICAgbW9kYWwuZmluZCgnW2hyZWY9XCIjYWxsXCJdJykuY2xpY2soKTtcclxuICAgICAgICBtb2RhbC5maW5kKCcubW9kYWwtdGl0bGUnKS50ZXh0KHRpdGxlKTtcclxuICAgICAgICBtb2RhbC5kYXRhKCdhY3Rpdml0eS10eXBlJywgdHlwZSk7XHJcbiAgICAgICAgYXBwbHlGaWx0ZXIobnVsbCwgbnVsbCk7XHJcbiAgICB9KVxyXG59KTtcclxuIiwiLy8vPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vLi4vQXNzZXRzL0xpYi9qcXVlcnkvdHlwaW5ncy5kLnRzXCIgLz5cclxuXHJcbiQoKCkgPT4ge1xyXG4gICAgY29uc3QgZ2VuZXJhdGVXb3JrZmxvd1VybCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zdCB3b3JrZmxvd1R5cGVJZDogc3RyaW5nID0gJCgnW2RhdGEtd29ya2Zsb3ctdHlwZS1pZF0nKS5kYXRhKCd3b3JrZmxvdy10eXBlLWlkJyk7XHJcbiAgICAgICAgY29uc3QgYWN0aXZpdHlJZDogc3RyaW5nID0gJCgnW2RhdGEtYWN0aXZpdHktaWRdJykuZGF0YSgnYWN0aXZpdHktaWQnKTtcclxuICAgICAgICB2YXIgdG9rZW5MaWZlU3BhbiA9ICQoJyN0b2tlbi1saWZlc3BhbicpLnZhbCgpO1xyXG4gICAgICAgIGNvbnN0IGdlbmVyYXRlVXJsOiBzdHJpbmcgPSAkKCdbZGF0YS1nZW5lcmF0ZS11cmxdJykuZGF0YSgnZ2VuZXJhdGUtdXJsJykgKyBgP3dvcmtmbG93VHlwZUlkPSR7d29ya2Zsb3dUeXBlSWR9JmFjdGl2aXR5SWQ9JHthY3Rpdml0eUlkfSZ0b2tlbkxpZmVTcGFuPSR7dG9rZW5MaWZlU3Bhbn1gO1xyXG4gICAgICAgIGNvbnN0IGFudGlmb3JnZXJ5SGVhZGVyTmFtZTogc3RyaW5nID0gJCgnW2RhdGEtYW50aWZvcmdlcnktaGVhZGVyLW5hbWVdJykuZGF0YSgnYW50aWZvcmdlcnktaGVhZGVyLW5hbWUnKTtcclxuICAgICAgICBjb25zdCBhbnRpZm9yZ2VyeVRva2VuOiBzdHJpbmcgPSAkKCdbZGF0YS1hbnRpZm9yZ2VyeS10b2tlbl0nKS5kYXRhKCdhbnRpZm9yZ2VyeS10b2tlbicpO1xyXG4gICAgICAgIGNvbnN0IGhlYWRlcnM6IGFueSA9IHt9O1xyXG5cclxuICAgICAgICBoZWFkZXJzW2FudGlmb3JnZXJ5SGVhZGVyTmFtZV0gPSBhbnRpZm9yZ2VyeVRva2VuO1xyXG5cclxuICAgICAgICAkLnBvc3Qoe1xyXG4gICAgICAgICAgICB1cmw6IGdlbmVyYXRlVXJsLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXHJcbiAgICAgICAgfSkuZG9uZSh1cmwgPT4ge1xyXG4gICAgICAgICAgICAkKCcjd29ya2Zsb3ctdXJsLXRleHQnKS52YWwodXJsKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJCgnI2dlbmVyYXRlLXVybC1idXR0b24nKS5vbignY2xpY2snLCBlID0+IHtcclxuICAgICAgICBnZW5lcmF0ZVdvcmtmbG93VXJsKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoJCgnI3dvcmtmbG93LXVybC10ZXh0JykudmFsKCkgPT0gJycpIHtcclxuICAgICAgICBnZW5lcmF0ZVdvcmtmbG93VXJsKCk7XHJcbiAgICB9XHJcbn0pO1xyXG4iLCIvLy88cmVmZXJlbmNlIHBhdGg9Jy4uL0xpYi9qcXVlcnkvdHlwaW5ncy5kLnRzJyAvPlxyXG4vLy88cmVmZXJlbmNlIHBhdGg9Jy4uL0xpYi9qc3BsdW1iL3R5cGluZ3MuZC50cycgLz5cclxuLy8vPHJlZmVyZW5jZSBwYXRoPScuL3dvcmtmbG93LW1vZGVscy50cycgLz5cclxuXHJcbmFic3RyYWN0IGNsYXNzIFdvcmtmbG93Q2FudmFzIHtcclxuICAgIHByaXZhdGUgbWluQ2FudmFzSGVpZ2h0OiBudW1iZXIgPSA0MDA7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJvdGVjdGVkIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHByb3RlY3RlZCB3b3JrZmxvd1R5cGU6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUpIHtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgZ2V0QWN0aXZpdHlFbGVtZW50cyA9ICgpOiBKUXVlcnkgPT4ge1xyXG4gICAgICAgIHJldHVybiAkKHRoaXMuY29udGFpbmVyKS5maW5kKCcuYWN0aXZpdHknKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgZ2V0RGVmYXVsdHMgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgQW5jaG9yOiBcIkNvbnRpbnVvdXNcIixcclxuICAgICAgICAgICAgRHJhZ09wdGlvbnM6IHsgY3Vyc29yOiAncG9pbnRlcicsIHpJbmRleDogMjAwMCB9LFxyXG4gICAgICAgICAgICBFbmRwb2ludFN0eWxlczogW3sgZmlsbFN0eWxlOiAnIzIyNTU4OCcgfV0sXHJcbiAgICAgICAgICAgIEVuZHBvaW50czogW1tcIkRvdFwiLCB7IHJhZGl1czogNyB9XSwgW1wiQmxhbmtcIl1dLFxyXG4gICAgICAgICAgICBDb25uZWN0aW9uT3ZlcmxheXM6IFtcclxuICAgICAgICAgICAgICAgIFtcIkFycm93XCIsIHsgd2lkdGg6IDEyLCBsZW5ndGg6IDEyLCBsb2NhdGlvbjogLTUgfV0sXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIENvbm5lY3RvclpJbmRleDogNVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcHJvdGVjdGVkIGNyZWF0ZUpzUGx1bWJJbnN0YW5jZSA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4ganNQbHVtYi5nZXRJbnN0YW5jZSh7XHJcbiAgICAgICAgICAgIERyYWdPcHRpb25zOiB7IGN1cnNvcjogJ3BvaW50ZXInLCB6SW5kZXg6IDIwMDAgfSxcclxuICAgICAgICAgICAgQ29ubmVjdGlvbk92ZXJsYXlzOiBbXHJcbiAgICAgICAgICAgICAgICBbJ0Fycm93Jywge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDExLFxyXG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMTFcclxuICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgWydMYWJlbCcsIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogMC41LFxyXG4gICAgICAgICAgICAgICAgICAgIGlkOiAnbGFiZWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNzc0NsYXNzOiAnY29ubmVjdGlvbi1sYWJlbCdcclxuICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIENvbnRhaW5lcjogdGhpcy5jb250YWluZXJcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgcHJvdGVjdGVkIGdldEVuZHBvaW50Q29sb3IgPSAoYWN0aXZpdHk6IFdvcmtmbG93cy5BY3Rpdml0eSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBhY3Rpdml0eS5pc0Jsb2NraW5nIHx8IGFjdGl2aXR5LmlzU3RhcnQgPyAnIzdhYjAyYycgOiBhY3Rpdml0eS5pc0V2ZW50ID8gJyMzYThhY2QnIDogJyM3YWIwMmMnO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBnZXRTb3VyY2VFbmRwb2ludE9wdGlvbnMgPSAoYWN0aXZpdHk6IFdvcmtmbG93cy5BY3Rpdml0eSwgb3V0Y29tZTogV29ya2Zsb3dzLk91dGNvbWUpOiBFbmRwb2ludE9wdGlvbnMgPT4ge1xyXG4gICAgICAgIC8vIFRoZSBkZWZpbml0aW9uIG9mIHNvdXJjZSBlbmRwb2ludHMuXHJcbiAgICAgICAgY29uc3QgcGFpbnRDb2xvciA9IHRoaXMuZ2V0RW5kcG9pbnRDb2xvcihhY3Rpdml0eSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZW5kcG9pbnQ6ICdEb3QnLFxyXG4gICAgICAgICAgICBhbmNob3I6ICdDb250aW51b3VzJyxcclxuICAgICAgICAgICAgcGFpbnRTdHlsZToge1xyXG4gICAgICAgICAgICAgICAgc3Ryb2tlOiBwYWludENvbG9yLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogcGFpbnRDb2xvcixcclxuICAgICAgICAgICAgICAgIHJhZGl1czogNyxcclxuICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAxXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGlzU291cmNlOiB0cnVlLFxyXG4gICAgICAgICAgICBjb25uZWN0b3I6IFsnRmxvd2NoYXJ0JywgeyBzdHViOiBbNDAsIDYwXSwgZ2FwOiAwLCBjb3JuZXJSYWRpdXM6IDUsIGFsd2F5c1Jlc3BlY3RTdHViczogdHJ1ZSB9XSxcclxuICAgICAgICAgICAgY29ubmVjdG9yU3R5bGU6IHtcclxuICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAyLFxyXG4gICAgICAgICAgICAgICAgc3Ryb2tlOiAnIzk5OTk5OScsXHJcbiAgICAgICAgICAgICAgICBqb2luc3R5bGU6ICdyb3VuZCcsXHJcbiAgICAgICAgICAgICAgICBvdXRsaW5lU3Ryb2tlOiAnd2hpdGUnLFxyXG4gICAgICAgICAgICAgICAgb3V0bGluZVdpZHRoOiAyXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGhvdmVyUGFpbnRTdHlsZToge1xyXG4gICAgICAgICAgICAgICAgZmlsbDogJyMyMTY0NzcnLFxyXG4gICAgICAgICAgICAgICAgc3Ryb2tlOiAnIzIxNjQ3NydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY29ubmVjdG9ySG92ZXJTdHlsZToge1xyXG4gICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDMsXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6ICcjMjE2NDc3JyxcclxuICAgICAgICAgICAgICAgIG91dGxpbmVXaWR0aDogNSxcclxuICAgICAgICAgICAgICAgIG91dGxpbmVTdHJva2U6ICd3aGl0ZSdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY29ubmVjdG9yT3ZlcmxheXM6IFtbJ0xhYmVsJywgeyBsb2NhdGlvbjogWzMsIC0xLjVdLCBjc3NDbGFzczogJ2VuZHBvaW50U291cmNlTGFiZWwnIH1dXSxcclxuICAgICAgICAgICAgZHJhZ09wdGlvbnM6IHt9LFxyXG4gICAgICAgICAgICB1dWlkOiBgJHthY3Rpdml0eS5pZH0tJHtvdXRjb21lLm5hbWV9YCxcclxuICAgICAgICAgICAgcGFyYW1ldGVyczoge1xyXG4gICAgICAgICAgICAgICAgb3V0Y29tZTogb3V0Y29tZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgcHJvdGVjdGVkIGdldEFjdGl2aXR5ID0gZnVuY3Rpb24gKGlkOiBzdHJpbmcsIGFjdGl2aXRpZXM6IEFycmF5PFdvcmtmbG93cy5BY3Rpdml0eT4gPSBudWxsKTogV29ya2Zsb3dzLkFjdGl2aXR5IHtcclxuICAgICAgICBpZiAoIWFjdGl2aXRpZXMpIHtcclxuICAgICAgICAgICAgYWN0aXZpdGllcyA9IHRoaXMud29ya2Zsb3dUeXBlLmFjdGl2aXRpZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAkLmdyZXAoYWN0aXZpdGllcywgKHg6IFdvcmtmbG93cy5BY3Rpdml0eSkgPT4geC5pZCA9PT0gaWQpWzBdO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCB1cGRhdGVDb25uZWN0aW9ucyA9IChwbHVtYmVyOiBqc1BsdW1iSW5zdGFuY2UpID0+IHtcclxuICAgICAgICB2YXIgd29ya2Zsb3dJZDogbnVtYmVyID0gdGhpcy53b3JrZmxvd1R5cGUuaWQ7XHJcblxyXG4gICAgICAgIC8vIENvbm5lY3QgYWN0aXZpdGllcy5cclxuICAgICAgICBmb3IgKGxldCB0cmFuc2l0aW9uTW9kZWwgb2YgdGhpcy53b3JrZmxvd1R5cGUudHJhbnNpdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3Qgc291cmNlRW5kcG9pbnRVdWlkOiBzdHJpbmcgPSBgJHt0cmFuc2l0aW9uTW9kZWwuc291cmNlQWN0aXZpdHlJZH0tJHt0cmFuc2l0aW9uTW9kZWwuc291cmNlT3V0Y29tZU5hbWV9YDtcclxuICAgICAgICAgICAgY29uc3Qgc291cmNlRW5kcG9pbnQ6IEVuZHBvaW50ID0gcGx1bWJlci5nZXRFbmRwb2ludChzb3VyY2VFbmRwb2ludFV1aWQpO1xyXG4gICAgICAgICAgICBjb25zdCBkZXN0aW5hdGlvbkVsZW1lbnRJZDogc3RyaW5nID0gYGFjdGl2aXR5LSR7d29ya2Zsb3dJZH0tJHt0cmFuc2l0aW9uTW9kZWwuZGVzdGluYXRpb25BY3Rpdml0eUlkfWA7XHJcblxyXG4gICAgICAgICAgICBwbHVtYmVyLmNvbm5lY3Qoe1xyXG4gICAgICAgICAgICAgICAgc291cmNlOiBzb3VyY2VFbmRwb2ludCxcclxuICAgICAgICAgICAgICAgIHRhcmdldDogZGVzdGluYXRpb25FbGVtZW50SWRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCB1cGRhdGVDYW52YXNIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3QgJGNvbnRhaW5lciA9ICQodGhpcy5jb250YWluZXIpO1xyXG5cclxuICAgICAgICAvLyBHZXQgdGhlIGFjdGl2aXR5IGVsZW1lbnQgd2l0aCB0aGUgaGlnaGVzdCBZIGNvb3JkaW5hdGUuXHJcbiAgICAgICAgY29uc3QgJGFjdGl2aXR5RWxlbWVudHMgPSAkY29udGFpbmVyLmZpbmQoXCIuYWN0aXZpdHlcIik7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRFbGVtZW50VG9wID0gMDtcclxuICAgICAgICBsZXQgY3VycmVudEFjdGl2aXR5SGVpZ2h0ID0gMDtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgYWN0aXZpdHlFbGVtZW50IG9mICRhY3Rpdml0eUVsZW1lbnRzLnRvQXJyYXkoKSkge1xyXG4gICAgICAgICAgICBjb25zdCAkYWN0aXZpdHlFbGVtZW50ID0gJChhY3Rpdml0eUVsZW1lbnQpO1xyXG4gICAgICAgICAgICBjb25zdCB0b3AgPSAkYWN0aXZpdHlFbGVtZW50LnBvc2l0aW9uKCkudG9wO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRvcCA+IGN1cnJlbnRFbGVtZW50VG9wKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50RWxlbWVudFRvcCA9IHRvcDtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRBY3Rpdml0eUhlaWdodCA9ICRhY3Rpdml0eUVsZW1lbnQuaGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBuZXdDYW52YXNIZWlnaHQgPSBjdXJyZW50RWxlbWVudFRvcCArIGN1cnJlbnRBY3Rpdml0eUhlaWdodDtcclxuICAgICAgICBjb25zdCBlbGVtZW50Qm90dG9tID0gY3VycmVudEVsZW1lbnRUb3AgKyBjdXJyZW50QWN0aXZpdHlIZWlnaHQ7XHJcbiAgICAgICAgY29uc3Qgc3RyZXRjaFZhbHVlID0gMTAwO1xyXG5cclxuICAgICAgICBpZiAobmV3Q2FudmFzSGVpZ2h0IC0gZWxlbWVudEJvdHRvbSA8PSBzdHJldGNoVmFsdWUpIHtcclxuICAgICAgICAgICAgbmV3Q2FudmFzSGVpZ2h0ICs9IHN0cmV0Y2hWYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjb250YWluZXIuaGVpZ2h0KE1hdGgubWF4KHRoaXMubWluQ2FudmFzSGVpZ2h0LCBuZXdDYW52YXNIZWlnaHQpKTtcclxuICAgIH07XHJcbn1cclxuIiwiLy8vPHJlZmVyZW5jZSBwYXRoPScuLi9MaWIvanF1ZXJ5L3R5cGluZ3MuZC50cycgLz5cclxuLy8vPHJlZmVyZW5jZSBwYXRoPScuLi9MaWIvanNwbHVtYi90eXBpbmdzLmQudHMnIC8+XHJcbi8vLzxyZWZlcmVuY2UgcGF0aD0nLi93b3JrZmxvdy1tb2RlbHMudHMnIC8+XHJcbi8vLzxyZWZlcmVuY2UgcGF0aD0nLi93b3JrZmxvdy1jYW52YXMudHMnIC8+XHJcblxyXG4vLyBUT0RPOiBSZS1pbXBsZW1lbnQgdGhpcyB1c2luZyBhIE1WVk0gYXBwcm9hY2guXHJcbmNsYXNzIFdvcmtmbG93RWRpdG9yIGV4dGVuZHMgV29ya2Zsb3dDYW52YXMge1xyXG4gICAgcHJpdmF0ZSBqc1BsdW1iSW5zdGFuY2U6IGpzUGx1bWJJbnN0YW5jZTtcclxuICAgIHByaXZhdGUgaXNQb3BvdmVyVmlzaWJsZTogYm9vbGVhbjtcclxuICAgIHByaXZhdGUgaGFzRHJhZ2dlZDogYm9vbGVhbjtcclxuICAgIHByaXZhdGUgZHJhZ1N0YXJ0OiBKUXVlcnkuQ29vcmRpbmF0ZXM7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJvdGVjdGVkIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHByb3RlY3RlZCB3b3JrZmxvd1R5cGU6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUsIHByaXZhdGUgZGVsZXRlQWN0aXZpdHlQcm9tcHQ6IHN0cmluZywgcHJpdmF0ZSBsb2NhbElkOiBzdHJpbmcsIGxvYWRMb2NhbFN0YXRlOiBib29sZWFuKSB7XHJcbiAgICAgICAgc3VwZXIoY29udGFpbmVyLCB3b3JrZmxvd1R5cGUpO1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICBqc1BsdW1iLnJlYWR5KCgpID0+IHtcclxuICAgICAgICAgICAganNQbHVtYi5pbXBvcnREZWZhdWx0cyh0aGlzLmdldERlZmF1bHRzKCkpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcGx1bWJlciA9IHRoaXMuY3JlYXRlSnNQbHVtYkluc3RhbmNlKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIG5ldyBjb25uZWN0aW9ucy5cclxuICAgICAgICAgICAgcGx1bWJlci5iaW5kKCdjb25uZWN0aW9uJywgZnVuY3Rpb24gKGNvbm5JbmZvLCBvcmlnaW5hbEV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uOiBDb25uZWN0aW9uID0gY29ubkluZm8uY29ubmVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG91dGNvbWU6IFdvcmtmbG93cy5PdXRjb21lID0gY29ubmVjdGlvbi5nZXRQYXJhbWV0ZXJzKCkub3V0Y29tZTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBsYWJlbDogYW55ID0gY29ubmVjdGlvbi5nZXRPdmVybGF5KCdsYWJlbCcpO1xyXG4gICAgICAgICAgICAgICAgbGFiZWwuc2V0TGFiZWwob3V0Y29tZS5kaXNwbGF5TmFtZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFjdGl2aXR5RWxlbWVudHMgPSB0aGlzLmdldEFjdGl2aXR5RWxlbWVudHMoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBhcmVFcXVhbE91dGNvbWVzID0gZnVuY3Rpb24gKG91dGNvbWVzMTogV29ya2Zsb3dzLk91dGNvbWVbXSwgb3V0Y29tZXMyOiBXb3JrZmxvd3MuT3V0Y29tZVtdKTogYm9vbGVhbiB7XHJcbiAgICAgICAgICAgICAgICBpZiAob3V0Y29tZXMxLmxlbmd0aCAhPSBvdXRjb21lczIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3V0Y29tZXMxLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0Y29tZTEgPSBvdXRjb21lczFbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0Y29tZTIgPSBvdXRjb21lczJbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRjb21lMS5uYW1lICE9IG91dGNvbWUyLmRpc3BsYXlOYW1lIHx8IG91dGNvbWUxLmRpc3BsYXlOYW1lICE9IG91dGNvbWUyLmRpc3BsYXlOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFN1c3BlbmQgZHJhd2luZyBhbmQgaW5pdGlhbGl6ZS5cclxuICAgICAgICAgICAgcGx1bWJlci5iYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VydmVyd29ya2Zsb3dUeXBlOiBXb3JrZmxvd3MuV29ya2Zsb3dUeXBlID0gdGhpcy53b3JrZmxvd1R5cGU7XHJcbiAgICAgICAgICAgICAgICB2YXIgd29ya2Zsb3dJZDogbnVtYmVyID0gdGhpcy53b3JrZmxvd1R5cGUuaWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGxvYWRMb2NhbFN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9jYWxTdGF0ZTogV29ya2Zsb3dzLldvcmtmbG93VHlwZSA9IHRoaXMubG9hZExvY2FsU3RhdGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53b3JrZmxvd1R5cGUgPSBsb2NhbFN0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLmVhY2goKGluZGV4LCBhY3Rpdml0eUVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCAkYWN0aXZpdHlFbGVtZW50ID0gJChhY3Rpdml0eUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5SWQgPSAkYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LWlkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNEZWxldGVkID0gdGhpcy53b3JrZmxvd1R5cGUucmVtb3ZlZEFjdGl2aXRpZXMuaW5kZXhPZihhY3Rpdml0eUlkKSA+IC0xO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNEZWxldGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpdml0eUVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhY3Rpdml0eSA9IHRoaXMuZ2V0QWN0aXZpdHkoYWN0aXZpdHlJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VydmVyQWN0aXZpdHkgPSB0aGlzLmdldEFjdGl2aXR5KGFjdGl2aXR5SWQsIHNlcnZlcndvcmtmbG93VHlwZS5hY3Rpdml0aWVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBhY3Rpdml0eSdzIHZpc3VhbCBzdGF0ZS5cclxuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZExvY2FsU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBuZXdseSBhZGRlZCBhY3Rpdml0eSBub3QgeWV0IGFkZGVkIHRvIGxvY2FsIHN0YXRlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkgPSBzZXJ2ZXJBY3Rpdml0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud29ya2Zsb3dUeXBlLmFjdGl2aXRpZXMucHVzaChhY3Rpdml0eSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkueCA9IDUwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkueSA9IDUwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGF2YWlsYWJsZSBvdXRjb21lcyBtaWdodCBoYXZlIGNoYW5nZWQgd2hlbiBlZGl0aW5nIGFuIGFjdGl2aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gd2UgbmVlZCB0byBjaGVjayBmb3IgdGhhdCBhbmQgdXBkYXRlIHRoZSBjbGllbnQncyBhY3Rpdml0eSBvdXRjb21lcyBpZiBzby5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNhbWVPdXRjb21lcyA9IGFyZUVxdWFsT3V0Y29tZXMoYWN0aXZpdHkub3V0Y29tZXMsIHNlcnZlckFjdGl2aXR5Lm91dGNvbWVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNhbWVPdXRjb21lcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5Lm91dGNvbWVzID0gc2VydmVyQWN0aXZpdHkub3V0Y29tZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFjdGl2aXR5RWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jc3MoeyBsZWZ0OiBhY3Rpdml0eS54LCB0b3A6IGFjdGl2aXR5LnkgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudG9nZ2xlQ2xhc3MoJ2FjdGl2aXR5LXN0YXJ0JywgYWN0aXZpdHkuaXNTdGFydClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZGF0YSgnYWN0aXZpdHktc3RhcnQnLCBhY3Rpdml0eS5pc1N0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSB0aGUgYWN0aXZpdHkgZHJhZ2dhYmxlLlxyXG4gICAgICAgICAgICAgICAgICAgIHBsdW1iZXIuZHJhZ2dhYmxlKGFjdGl2aXR5RWxlbWVudCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBncmlkOiBbMTAsIDEwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbm1lbnQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiAoYXJnczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYWdTdGFydCA9IHsgbGVmdDogYXJncy5lLnNjcmVlblgsIHRvcDogYXJncy5lLnNjcmVlblkgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcDogKGFyZ3M6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNEcmFnZ2VkID0gdGhpcy5kcmFnU3RhcnQubGVmdCAhPSBhcmdzLmUuc2NyZWVuWCB8fCB0aGlzLmRyYWdTdGFydC50b3AgIT0gYXJncy5lLnNjcmVlblk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNhbnZhc0hlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIENvbmZpZ3VyZSB0aGUgYWN0aXZpdHkgYXMgYSB0YXJnZXQuXHJcbiAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5tYWtlVGFyZ2V0KGFjdGl2aXR5RWxlbWVudCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wT3B0aW9uczogeyBob3ZlckNsYXNzOiAnaG92ZXInIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvcjogJ0NvbnRpbnVvdXMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogWydCbGFuaycsIHsgcmFkaXVzOiA4IH1dXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBzb3VyY2UgZW5kcG9pbnRzLlxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG91dGNvbWUgb2YgYWN0aXZpdHkub3V0Y29tZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc291cmNlRW5kcG9pbnRPcHRpb25zID0gdGhpcy5nZXRTb3VyY2VFbmRwb2ludE9wdGlvbnMoYWN0aXZpdHksIG91dGNvbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVtYmVyLmFkZEVuZHBvaW50KGFjdGl2aXR5RWxlbWVudCwgeyBjb25uZWN0b3JPdmVybGF5czogW1snTGFiZWwnLCB7IGxhYmVsOiBvdXRjb21lLmRpc3BsYXlOYW1lLCBjc3NDbGFzczogJ2Nvbm5lY3Rpb24tbGFiZWwnIH1dXSB9LCBzb3VyY2VFbmRwb2ludE9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIENvbm5lY3QgYWN0aXZpdGllcy5cclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29ubmVjdGlvbnMocGx1bWJlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gUmUtcXVlcnkgdGhlIGFjdGl2aXR5IGVsZW1lbnRzLlxyXG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cyA9IHRoaXMuZ2V0QWN0aXZpdHlFbGVtZW50cygpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIE1ha2UgYWxsIGFjdGl2aXR5IGVsZW1lbnRzIHZpc2libGUuXHJcbiAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLnNob3coKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNhbnZhc0hlaWdodCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgcG9wb3ZlcnMuXHJcbiAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHMucG9wb3Zlcih7XHJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyOiAnbWFudWFsJyxcclxuICAgICAgICAgICAgICAgIGh0bWw6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZpdHlFbGVtZW50ID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCAkY29udGVudDogSlF1ZXJ5PEVsZW1lbnQ+ID0gYWN0aXZpdHlFbGVtZW50LmZpbmQoJy5hY3Rpdml0eS1jb21tYW5kcycpLmNsb25lKCkuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0QnV0dG9uID0gJGNvbnRlbnQuZmluZCgnLmFjdGl2aXR5LXN0YXJ0LWFjdGlvbicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzU3RhcnQgPSBhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktc3RhcnQnKSA9PT0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3Rpdml0eUlkOiBudW1iZXIgPSBhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktaWQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRCdXR0b24uYXR0cignYXJpYS1wcmVzc2VkJywgYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JykpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0QnV0dG9uLnRvZ2dsZUNsYXNzKCdhY3RpdmUnLCBpc1N0YXJ0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJGNvbnRlbnQub24oJ2NsaWNrJywgJy5hY3Rpdml0eS1zdGFydC1hY3Rpb24nLCBlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSAkKGUuY3VycmVudFRhcmdldCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uKCd0b2dnbGUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzU3RhcnQgPSBidXR0b24uaXMoJy5hY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0JywgaXNTdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudC50b2dnbGVDbGFzcygnYWN0aXZpdHktc3RhcnQnLCBpc1N0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJGNvbnRlbnQub24oJ2NsaWNrJywgJy5hY3Rpdml0eS1kZWxldGUtYWN0aW9uJywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IFRoZSBwcm9tcHRzIGFyZSByZWFsbHkgYW5ub3lpbmcuIENvbnNpZGVyIHNob3dpbmcgc29tZSBzb3J0IG9mIHNtYWxsIG1lc3NhZ2UgYmFsbG9vbiBzb21ld2hlcmUgdG8gdW5kbyB0aGUgYWN0aW9uIGluc3RlYWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgKCFjb25maXJtKHNlbGYuZGVsZXRlQWN0aXZpdHlQcm9tcHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy99XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLndvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcy5wdXNoKGFjdGl2aXR5SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVtYmVyLnJlbW92ZShhY3Rpdml0eUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnQucG9wb3ZlcignZGlzcG9zZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkY29udGVudC5vbignY2xpY2snLCAnW2RhdGEtcGVyc2lzdC13b3JrZmxvd10nLCBlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zYXZlTG9jYWxTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGNvbnRlbnQuZ2V0KDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICQoY29udGFpbmVyKS5vbignY2xpY2snLCAnLmFjdGl2aXR5JywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNEcmFnZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNEcmFnZ2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGlmIGFueSBvdGhlciBwb3BvdmVycyBhcmUgdmlzaWJsZSwgaGlkZSB0aGVtXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1BvcG92ZXJWaXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5wb3BvdmVyKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VuZGVyID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgc2VuZGVyLnBvcG92ZXIoJ3Nob3cnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgY2xpY2tpbmcgb24gdGhlIHBvcG92ZXIgaXRzZWxmLlxyXG4gICAgICAgICAgICAgICAgJCgnLnBvcG92ZXInKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZTIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGUyLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1BvcG92ZXJWaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkKGNvbnRhaW5lcikub24oJ2RibGNsaWNrJywgJy5hY3Rpdml0eScsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VuZGVyID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGFzRWRpdG9yID0gc2VuZGVyLmRhdGEoJ2FjdGl2aXR5LWhhcy1lZGl0b3InKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzRWRpdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlTG9jYWxTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbmRlci5maW5kKCcuYWN0aXZpdHktZWRpdC1hY3Rpb24nKS5nZXQoMCkuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBIaWRlIGFsbCBwb3BvdmVycyB3aGVuIGNsaWNraW5nIGFueXdoZXJlIGJ1dCBvbiBhbiBhY3Rpdml0eS5cclxuICAgICAgICAgICAgJCgnYm9keScpLm9uKCdjbGljaycsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5wb3BvdmVyKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzUG9wb3ZlclZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBTYXZlIGxvY2FsIGNoYW5nZXMgaWYgdGhlIGV2ZW50IHRhcmdldCBoYXMgdGhlICdkYXRhLXBlcnNpc3Qtd29ya2Zsb3cnIGF0dHJpYnV0ZS5cclxuICAgICAgICAgICAgJCgnYm9keScpLm9uKCdjbGljaycsICdbZGF0YS1wZXJzaXN0LXdvcmtmbG93XScsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlTG9jYWxTdGF0ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuanNQbHVtYkluc3RhbmNlID0gcGx1bWJlcjtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFN0YXRlID0gKCk6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUgPT4ge1xyXG4gICAgICAgIGNvbnN0ICRhbGxBY3Rpdml0eUVsZW1lbnRzID0gJCh0aGlzLmNvbnRhaW5lcikuZmluZCgnLmFjdGl2aXR5Jyk7XHJcbiAgICAgICAgY29uc3Qgd29ya2Zsb3c6IFdvcmtmbG93cy5Xb3JrZmxvd1R5cGUgPSB7XHJcbiAgICAgICAgICAgIGlkOiB0aGlzLndvcmtmbG93VHlwZS5pZCxcclxuICAgICAgICAgICAgYWN0aXZpdGllczogW10sXHJcbiAgICAgICAgICAgIHRyYW5zaXRpb25zOiBbXSxcclxuICAgICAgICAgICAgcmVtb3ZlZEFjdGl2aXRpZXM6IHRoaXMud29ya2Zsb3dUeXBlLnJlbW92ZWRBY3Rpdml0aWVzXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ29sbGVjdCBhY3Rpdml0aWVzLlxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgJGFsbEFjdGl2aXR5RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgJGFjdGl2aXR5RWxlbWVudDogSlF1ZXJ5ID0gJCgkYWxsQWN0aXZpdHlFbGVtZW50c1tpXSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5SWQ6IHN0cmluZyA9ICRhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktaWQnKTtcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZpdHlJc1N0YXJ0OiBib29sZWFuID0gJGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1zdGFydCcpO1xyXG4gICAgICAgICAgICBjb25zdCBhY3Rpdml0eUlzRXZlbnQ6IGJvb2xlYW4gPSAkYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXR5cGUnKSA9PT0gJ0V2ZW50JztcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZpdHlQb3NpdGlvbjogSlF1ZXJ5LkNvb3JkaW5hdGVzID0gJGFjdGl2aXR5RWxlbWVudC5wb3NpdGlvbigpO1xyXG4gICAgICAgICAgICBjb25zdCBhY3Rpdml0eTogV29ya2Zsb3dzLkFjdGl2aXR5ID0gdGhpcy5nZXRBY3Rpdml0eShhY3Rpdml0eUlkKTtcclxuXHJcbiAgICAgICAgICAgIHdvcmtmbG93LmFjdGl2aXRpZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBpZDogYWN0aXZpdHlJZCxcclxuICAgICAgICAgICAgICAgIGlzU3RhcnQ6IGFjdGl2aXR5SXNTdGFydCxcclxuICAgICAgICAgICAgICAgIGlzRXZlbnQ6IGFjdGl2aXR5SXNFdmVudCxcclxuICAgICAgICAgICAgICAgIG91dGNvbWVzOiBhY3Rpdml0eS5vdXRjb21lcyxcclxuICAgICAgICAgICAgICAgIHg6IGFjdGl2aXR5UG9zaXRpb24ubGVmdCxcclxuICAgICAgICAgICAgICAgIHk6IGFjdGl2aXR5UG9zaXRpb24udG9wXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ29sbGVjdCBjb25uZWN0aW9ucy5cclxuICAgICAgICBjb25zdCBhbGxDb25uZWN0aW9ucyA9IHRoaXMuanNQbHVtYkluc3RhbmNlLmdldENvbm5lY3Rpb25zKCk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsQ29ubmVjdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBhbGxDb25uZWN0aW9uc1tpXTtcclxuICAgICAgICAgICAgdmFyIHNvdXJjZUVuZHBvaW50OiBFbmRwb2ludCA9IGNvbm5lY3Rpb24uZW5kcG9pbnRzWzBdO1xyXG4gICAgICAgICAgICB2YXIgc291cmNlT3V0Y29tZU5hbWUgPSBzb3VyY2VFbmRwb2ludC5nZXRQYXJhbWV0ZXJzKCkub3V0Y29tZS5uYW1lO1xyXG4gICAgICAgICAgICB2YXIgc291cmNlQWN0aXZpdHlJZDogc3RyaW5nID0gJChjb25uZWN0aW9uLnNvdXJjZSkuZGF0YSgnYWN0aXZpdHktaWQnKTtcclxuICAgICAgICAgICAgdmFyIGRlc3RpbmF0aW9uQWN0aXZpdHlJZDogc3RyaW5nID0gJChjb25uZWN0aW9uLnRhcmdldCkuZGF0YSgnYWN0aXZpdHktaWQnKTtcclxuXHJcbiAgICAgICAgICAgIHdvcmtmbG93LnRyYW5zaXRpb25zLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgc291cmNlQWN0aXZpdHlJZDogc291cmNlQWN0aXZpdHlJZCxcclxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uQWN0aXZpdHlJZDogZGVzdGluYXRpb25BY3Rpdml0eUlkLFxyXG4gICAgICAgICAgICAgICAgc291cmNlT3V0Y29tZU5hbWU6IHNvdXJjZU91dGNvbWVOYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHdvcmtmbG93O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXJpYWxpemUgPSAoKTogc3RyaW5nID0+IHtcclxuICAgICAgICBjb25zdCB3b3JrZmxvdzogV29ya2Zsb3dzLldvcmtmbG93VHlwZSA9IHRoaXMuZ2V0U3RhdGUoKTtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkod29ya2Zsb3cpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2F2ZUxvY2FsU3RhdGUgPSAoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgc2Vzc2lvblN0b3JhZ2VbdGhpcy5sb2NhbElkXSA9IHRoaXMuc2VyaWFsaXplKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBsb2FkTG9jYWxTdGF0ZSA9ICgpOiBXb3JrZmxvd3MuV29ya2Zsb3dUeXBlID0+IHtcclxuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZVt0aGlzLmxvY2FsSWRdKTtcclxuICAgIH1cclxufVxyXG5cclxuJC5mbi53b3JrZmxvd0VkaXRvciA9IGZ1bmN0aW9uICh0aGlzOiBKUXVlcnkpOiBKUXVlcnkge1xyXG4gICAgdGhpcy5lYWNoKChpbmRleCwgZWxlbWVudCkgPT4ge1xyXG4gICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7XHJcbiAgICAgICAgdmFyIHdvcmtmbG93VHlwZTogV29ya2Zsb3dzLldvcmtmbG93VHlwZSA9ICRlbGVtZW50LmRhdGEoJ3dvcmtmbG93LXR5cGUnKTtcclxuICAgICAgICB2YXIgZGVsZXRlQWN0aXZpdHlQcm9tcHQ6IHN0cmluZyA9ICRlbGVtZW50LmRhdGEoJ3dvcmtmbG93LWRlbGV0ZS1hY3Rpdml0eS1wcm9tcHQnKTtcclxuICAgICAgICB2YXIgbG9jYWxJZDogc3RyaW5nID0gJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3ctbG9jYWwtaWQnKTtcclxuICAgICAgICB2YXIgbG9hZExvY2FsU3RhdGU6IGJvb2xlYW4gPSAkZWxlbWVudC5kYXRhKCd3b3JrZmxvdy1sb2FkLWxvY2FsLXN0YXRlJyk7XHJcblxyXG4gICAgICAgIHdvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcyA9IHdvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcyB8fCBbXTtcclxuICAgICAgICAkZWxlbWVudC5kYXRhKCd3b3JrZmxvd0VkaXRvcicsIG5ldyBXb3JrZmxvd0VkaXRvcihlbGVtZW50LCB3b3JrZmxvd1R5cGUsIGRlbGV0ZUFjdGl2aXR5UHJvbXB0LCBsb2NhbElkLCBsb2FkTG9jYWxTdGF0ZSkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCB3b3JrZmxvd0VkaXRvcjogV29ya2Zsb3dFZGl0b3IgPSAkKCcud29ya2Zsb3ctY2FudmFzJykud29ya2Zsb3dFZGl0b3IoKS5kYXRhKCd3b3JrZmxvd0VkaXRvcicpO1xyXG5cclxuICAgICQoJyN3b3JrZmxvd0VkaXRvckZvcm0nKS5vbignc3VibWl0JywgKHMsIGUpID0+IHtcclxuICAgICAgICBjb25zdCBzdGF0ZSA9IHdvcmtmbG93RWRpdG9yLnNlcmlhbGl6ZSgpO1xyXG4gICAgICAgICQoJyN3b3JrZmxvd1N0YXRlSW5wdXQnKS52YWwoc3RhdGUpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iLCIvLy88cmVmZXJlbmNlIHBhdGg9Jy4uL0xpYi9qcXVlcnkvdHlwaW5ncy5kLnRzJyAvPlxuLy8vPHJlZmVyZW5jZSBwYXRoPScuLi9MaWIvanNwbHVtYi90eXBpbmdzLmQudHMnIC8+XG4vLy88cmVmZXJlbmNlIHBhdGg9Jy4vd29ya2Zsb3ctbW9kZWxzLnRzJyAvPlxuLy8vPHJlZmVyZW5jZSBwYXRoPScuL3dvcmtmbG93LWNhbnZhcy50cycgLz5cbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG4vLyBUT0RPOiBSZS1pbXBsZW1lbnQgdGhpcyB1c2luZyBhIE1WVk0gYXBwcm9hY2guXG52YXIgV29ya2Zsb3dFZGl0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFdvcmtmbG93RWRpdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFdvcmtmbG93RWRpdG9yKGNvbnRhaW5lciwgd29ya2Zsb3dUeXBlLCBkZWxldGVBY3Rpdml0eVByb21wdCwgbG9jYWxJZCwgbG9hZExvY2FsU3RhdGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgY29udGFpbmVyLCB3b3JrZmxvd1R5cGUpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgX3RoaXMud29ya2Zsb3dUeXBlID0gd29ya2Zsb3dUeXBlO1xuICAgICAgICBfdGhpcy5kZWxldGVBY3Rpdml0eVByb21wdCA9IGRlbGV0ZUFjdGl2aXR5UHJvbXB0O1xuICAgICAgICBfdGhpcy5sb2NhbElkID0gbG9jYWxJZDtcbiAgICAgICAgX3RoaXMuZ2V0U3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgJGFsbEFjdGl2aXR5RWxlbWVudHMgPSAkKF90aGlzLmNvbnRhaW5lcikuZmluZCgnLmFjdGl2aXR5Jyk7XG4gICAgICAgICAgICB2YXIgd29ya2Zsb3cgPSB7XG4gICAgICAgICAgICAgICAgaWQ6IF90aGlzLndvcmtmbG93VHlwZS5pZCxcbiAgICAgICAgICAgICAgICBhY3Rpdml0aWVzOiBbXSxcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uczogW10sXG4gICAgICAgICAgICAgICAgcmVtb3ZlZEFjdGl2aXRpZXM6IF90aGlzLndvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIENvbGxlY3QgYWN0aXZpdGllcy5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJGFsbEFjdGl2aXR5RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgJGFjdGl2aXR5RWxlbWVudCA9ICQoJGFsbEFjdGl2aXR5RWxlbWVudHNbaV0pO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eUlkID0gJGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1pZCcpO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eUlzU3RhcnQgPSAkYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5LXN0YXJ0Jyk7XG4gICAgICAgICAgICAgICAgdmFyIGFjdGl2aXR5SXNFdmVudCA9ICRhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktdHlwZScpID09PSAnRXZlbnQnO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eVBvc2l0aW9uID0gJGFjdGl2aXR5RWxlbWVudC5wb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IF90aGlzLmdldEFjdGl2aXR5KGFjdGl2aXR5SWQpO1xuICAgICAgICAgICAgICAgIHdvcmtmbG93LmFjdGl2aXRpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBhY3Rpdml0eUlkLFxuICAgICAgICAgICAgICAgICAgICBpc1N0YXJ0OiBhY3Rpdml0eUlzU3RhcnQsXG4gICAgICAgICAgICAgICAgICAgIGlzRXZlbnQ6IGFjdGl2aXR5SXNFdmVudCxcbiAgICAgICAgICAgICAgICAgICAgb3V0Y29tZXM6IGFjdGl2aXR5Lm91dGNvbWVzLFxuICAgICAgICAgICAgICAgICAgICB4OiBhY3Rpdml0eVBvc2l0aW9uLmxlZnQsXG4gICAgICAgICAgICAgICAgICAgIHk6IGFjdGl2aXR5UG9zaXRpb24udG9wXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDb2xsZWN0IGNvbm5lY3Rpb25zLlxuICAgICAgICAgICAgdmFyIGFsbENvbm5lY3Rpb25zID0gX3RoaXMuanNQbHVtYkluc3RhbmNlLmdldENvbm5lY3Rpb25zKCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbENvbm5lY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBhbGxDb25uZWN0aW9uc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlRW5kcG9pbnQgPSBjb25uZWN0aW9uLmVuZHBvaW50c1swXTtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlT3V0Y29tZU5hbWUgPSBzb3VyY2VFbmRwb2ludC5nZXRQYXJhbWV0ZXJzKCkub3V0Y29tZS5uYW1lO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2VBY3Rpdml0eUlkID0gJChjb25uZWN0aW9uLnNvdXJjZSkuZGF0YSgnYWN0aXZpdHktaWQnKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVzdGluYXRpb25BY3Rpdml0eUlkID0gJChjb25uZWN0aW9uLnRhcmdldCkuZGF0YSgnYWN0aXZpdHktaWQnKTtcbiAgICAgICAgICAgICAgICB3b3JrZmxvdy50cmFuc2l0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlQWN0aXZpdHlJZDogc291cmNlQWN0aXZpdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25BY3Rpdml0eUlkOiBkZXN0aW5hdGlvbkFjdGl2aXR5SWQsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU91dGNvbWVOYW1lOiBzb3VyY2VPdXRjb21lTmFtZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHdvcmtmbG93O1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5zZXJpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgd29ya2Zsb3cgPSBfdGhpcy5nZXRTdGF0ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHdvcmtmbG93KTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuc2F2ZUxvY2FsU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZXNzaW9uU3RvcmFnZVtfdGhpcy5sb2NhbElkXSA9IF90aGlzLnNlcmlhbGl6ZSgpO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5sb2FkTG9jYWxTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlW190aGlzLmxvY2FsSWRdKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHNlbGYgPSBfdGhpcztcbiAgICAgICAganNQbHVtYi5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBqc1BsdW1iLmltcG9ydERlZmF1bHRzKF90aGlzLmdldERlZmF1bHRzKCkpO1xuICAgICAgICAgICAgdmFyIHBsdW1iZXIgPSBfdGhpcy5jcmVhdGVKc1BsdW1iSW5zdGFuY2UoKTtcbiAgICAgICAgICAgIC8vIExpc3RlbiBmb3IgbmV3IGNvbm5lY3Rpb25zLlxuICAgICAgICAgICAgcGx1bWJlci5iaW5kKCdjb25uZWN0aW9uJywgZnVuY3Rpb24gKGNvbm5JbmZvLCBvcmlnaW5hbEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBjb25uSW5mby5jb25uZWN0aW9uO1xuICAgICAgICAgICAgICAgIHZhciBvdXRjb21lID0gY29ubmVjdGlvbi5nZXRQYXJhbWV0ZXJzKCkub3V0Y29tZTtcbiAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBjb25uZWN0aW9uLmdldE92ZXJsYXkoJ2xhYmVsJyk7XG4gICAgICAgICAgICAgICAgbGFiZWwuc2V0TGFiZWwob3V0Y29tZS5kaXNwbGF5TmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBhY3Rpdml0eUVsZW1lbnRzID0gX3RoaXMuZ2V0QWN0aXZpdHlFbGVtZW50cygpO1xuICAgICAgICAgICAgdmFyIGFyZUVxdWFsT3V0Y29tZXMgPSBmdW5jdGlvbiAob3V0Y29tZXMxLCBvdXRjb21lczIpIHtcbiAgICAgICAgICAgICAgICBpZiAob3V0Y29tZXMxLmxlbmd0aCAhPSBvdXRjb21lczIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvdXRjb21lczEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG91dGNvbWUxID0gb3V0Y29tZXMxW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3V0Y29tZTIgPSBvdXRjb21lczJbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRjb21lMS5uYW1lICE9IG91dGNvbWUyLmRpc3BsYXlOYW1lIHx8IG91dGNvbWUxLmRpc3BsYXlOYW1lICE9IG91dGNvbWUyLmRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gU3VzcGVuZCBkcmF3aW5nIGFuZCBpbml0aWFsaXplLlxuICAgICAgICAgICAgcGx1bWJlci5iYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlcnZlcndvcmtmbG93VHlwZSA9IF90aGlzLndvcmtmbG93VHlwZTtcbiAgICAgICAgICAgICAgICB2YXIgd29ya2Zsb3dJZCA9IF90aGlzLndvcmtmbG93VHlwZS5pZDtcbiAgICAgICAgICAgICAgICBpZiAobG9hZExvY2FsU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsU3RhdGUgPSBfdGhpcy5sb2FkTG9jYWxTdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9jYWxTdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMud29ya2Zsb3dUeXBlID0gbG9jYWxTdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBhY3Rpdml0eUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRhY3Rpdml0eUVsZW1lbnQgPSAkKGFjdGl2aXR5RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eUlkID0gJGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1pZCcpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNEZWxldGVkID0gX3RoaXMud29ya2Zsb3dUeXBlLnJlbW92ZWRBY3Rpdml0aWVzLmluZGV4T2YoYWN0aXZpdHlJZCkgPiAtMTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRGVsZXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGFjdGl2aXR5RWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHkgPSBfdGhpcy5nZXRBY3Rpdml0eShhY3Rpdml0eUlkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlcnZlckFjdGl2aXR5ID0gX3RoaXMuZ2V0QWN0aXZpdHkoYWN0aXZpdHlJZCwgc2VydmVyd29ya2Zsb3dUeXBlLmFjdGl2aXRpZXMpO1xuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGFjdGl2aXR5J3MgdmlzdWFsIHN0YXRlLlxuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZExvY2FsU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIG5ld2x5IGFkZGVkIGFjdGl2aXR5IG5vdCB5ZXQgYWRkZWQgdG8gbG9jYWwgc3RhdGUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkgPSBzZXJ2ZXJBY3Rpdml0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy53b3JrZmxvd1R5cGUuYWN0aXZpdGllcy5wdXNoKGFjdGl2aXR5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eS54ID0gNTA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkueSA9IDUwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGF2YWlsYWJsZSBvdXRjb21lcyBtaWdodCBoYXZlIGNoYW5nZWQgd2hlbiBlZGl0aW5nIGFuIGFjdGl2aXR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvIHdlIG5lZWQgdG8gY2hlY2sgZm9yIHRoYXQgYW5kIHVwZGF0ZSB0aGUgY2xpZW50J3MgYWN0aXZpdHkgb3V0Y29tZXMgaWYgc28uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNhbWVPdXRjb21lcyA9IGFyZUVxdWFsT3V0Y29tZXMoYWN0aXZpdHkub3V0Y29tZXMsIHNlcnZlckFjdGl2aXR5Lm91dGNvbWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNhbWVPdXRjb21lcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eS5vdXRjb21lcyA9IHNlcnZlckFjdGl2aXR5Lm91dGNvbWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWN0aXZpdHlFbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jc3MoeyBsZWZ0OiBhY3Rpdml0eS54LCB0b3A6IGFjdGl2aXR5LnkgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvZ2dsZUNsYXNzKCdhY3Rpdml0eS1zdGFydCcsIGFjdGl2aXR5LmlzU3RhcnQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKCdhY3Rpdml0eS1zdGFydCcsIGFjdGl2aXR5LmlzU3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgdGhlIGFjdGl2aXR5IGRyYWdnYWJsZS5cbiAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5kcmFnZ2FibGUoYWN0aXZpdHlFbGVtZW50LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncmlkOiBbMTAsIDEwXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5tZW50OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZHJhZ1N0YXJ0ID0geyBsZWZ0OiBhcmdzLmUuc2NyZWVuWCwgdG9wOiBhcmdzLmUuc2NyZWVuWSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaGFzRHJhZ2dlZCA9IF90aGlzLmRyYWdTdGFydC5sZWZ0ICE9IGFyZ3MuZS5zY3JlZW5YIHx8IF90aGlzLmRyYWdTdGFydC50b3AgIT0gYXJncy5lLnNjcmVlblk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlQ2FudmFzSGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBDb25maWd1cmUgdGhlIGFjdGl2aXR5IGFzIGEgdGFyZ2V0LlxuICAgICAgICAgICAgICAgICAgICBwbHVtYmVyLm1ha2VUYXJnZXQoYWN0aXZpdHlFbGVtZW50LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wT3B0aW9uczogeyBob3ZlckNsYXNzOiAnaG92ZXInIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6ICdDb250aW51b3VzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiBbJ0JsYW5rJywgeyByYWRpdXM6IDggfV1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBzb3VyY2UgZW5kcG9pbnRzLlxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gYWN0aXZpdHkub3V0Y29tZXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3V0Y29tZSA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2VFbmRwb2ludE9wdGlvbnMgPSBfdGhpcy5nZXRTb3VyY2VFbmRwb2ludE9wdGlvbnMoYWN0aXZpdHksIG91dGNvbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5hZGRFbmRwb2ludChhY3Rpdml0eUVsZW1lbnQsIHsgY29ubmVjdG9yT3ZlcmxheXM6IFtbJ0xhYmVsJywgeyBsYWJlbDogb3V0Y29tZS5kaXNwbGF5TmFtZSwgY3NzQ2xhc3M6ICdjb25uZWN0aW9uLWxhYmVsJyB9XV0gfSwgc291cmNlRW5kcG9pbnRPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIENvbm5lY3QgYWN0aXZpdGllcy5cbiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVDb25uZWN0aW9ucyhwbHVtYmVyKTtcbiAgICAgICAgICAgICAgICAvLyBSZS1xdWVyeSB0aGUgYWN0aXZpdHkgZWxlbWVudHMuXG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cyA9IF90aGlzLmdldEFjdGl2aXR5RWxlbWVudHMoKTtcbiAgICAgICAgICAgICAgICAvLyBNYWtlIGFsbCBhY3Rpdml0eSBlbGVtZW50cyB2aXNpYmxlLlxuICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHMuc2hvdygpO1xuICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZUNhbnZhc0hlaWdodCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHBvcG92ZXJzLlxuICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50cy5wb3BvdmVyKHtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyOiAnbWFudWFsJyxcbiAgICAgICAgICAgICAgICBodG1sOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2aXR5RWxlbWVudCA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkY29udGVudCA9IGFjdGl2aXR5RWxlbWVudC5maW5kKCcuYWN0aXZpdHktY29tbWFuZHMnKS5jbG9uZSgpLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0QnV0dG9uID0gJGNvbnRlbnQuZmluZCgnLmFjdGl2aXR5LXN0YXJ0LWFjdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNTdGFydCA9IGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1zdGFydCcpID09PSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlJZCA9IGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1pZCcpO1xuICAgICAgICAgICAgICAgICAgICBzdGFydEJ1dHRvbi5hdHRyKCdhcmlhLXByZXNzZWQnLCBhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHktc3RhcnQnKSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0QnV0dG9uLnRvZ2dsZUNsYXNzKCdhY3RpdmUnLCBpc1N0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgJGNvbnRlbnQub24oJ2NsaWNrJywgJy5hY3Rpdml0eS1zdGFydC1hY3Rpb24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5idXR0b24oJ3RvZ2dsZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzU3RhcnQgPSBidXR0b24uaXMoJy5hY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eS1zdGFydCcsIGlzU3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50LnRvZ2dsZUNsYXNzKCdhY3Rpdml0eS1zdGFydCcsIGlzU3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgJGNvbnRlbnQub24oJ2NsaWNrJywgJy5hY3Rpdml0eS1kZWxldGUtYWN0aW9uJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IFRoZSBwcm9tcHRzIGFyZSByZWFsbHkgYW5ub3lpbmcuIENvbnNpZGVyIHNob3dpbmcgc29tZSBzb3J0IG9mIHNtYWxsIG1lc3NhZ2UgYmFsbG9vbiBzb21ld2hlcmUgdG8gdW5kbyB0aGUgYWN0aW9uIGluc3RlYWQuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmICghY29uZmlybShzZWxmLmRlbGV0ZUFjdGl2aXR5UHJvbXB0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLndvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcy5wdXNoKGFjdGl2aXR5SWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx1bWJlci5yZW1vdmUoYWN0aXZpdHlFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudC5wb3BvdmVyKCdkaXNwb3NlJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAkY29udGVudC5vbignY2xpY2snLCAnW2RhdGEtcGVyc2lzdC13b3JrZmxvd10nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zYXZlTG9jYWxTdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRjb250ZW50LmdldCgwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICQoY29udGFpbmVyKS5vbignY2xpY2snLCAnLmFjdGl2aXR5JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaGFzRHJhZ2dlZCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5oYXNEcmFnZ2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gaWYgYW55IG90aGVyIHBvcG92ZXJzIGFyZSB2aXNpYmxlLCBoaWRlIHRoZW1cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNQb3BvdmVyVmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLnBvcG92ZXIoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNlbmRlciA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgICAgICAgICBzZW5kZXIucG9wb3Zlcignc2hvdycpO1xuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBjbGlja2luZyBvbiB0aGUgcG9wb3ZlciBpdHNlbGYuXG4gICAgICAgICAgICAgICAgJCgnLnBvcG92ZXInKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUyKSB7XG4gICAgICAgICAgICAgICAgICAgIGUyLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNQb3BvdmVyVmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICQoY29udGFpbmVyKS5vbignZGJsY2xpY2snLCAnLmFjdGl2aXR5JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VuZGVyID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgICAgICAgICAgICAgIHZhciBoYXNFZGl0b3IgPSBzZW5kZXIuZGF0YSgnYWN0aXZpdHktaGFzLWVkaXRvcicpO1xuICAgICAgICAgICAgICAgIGlmIChoYXNFZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2F2ZUxvY2FsU3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc2VuZGVyLmZpbmQoJy5hY3Rpdml0eS1lZGl0LWFjdGlvbicpLmdldCgwKS5jbGljaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gSGlkZSBhbGwgcG9wb3ZlcnMgd2hlbiBjbGlja2luZyBhbnl3aGVyZSBidXQgb24gYW4gYWN0aXZpdHkuXG4gICAgICAgICAgICAkKCdib2R5Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzLnBvcG92ZXIoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5pc1BvcG92ZXJWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIFNhdmUgbG9jYWwgY2hhbmdlcyBpZiB0aGUgZXZlbnQgdGFyZ2V0IGhhcyB0aGUgJ2RhdGEtcGVyc2lzdC13b3JrZmxvdycgYXR0cmlidXRlLlxuICAgICAgICAgICAgJCgnYm9keScpLm9uKCdjbGljaycsICdbZGF0YS1wZXJzaXN0LXdvcmtmbG93XScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2F2ZUxvY2FsU3RhdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX3RoaXMuanNQbHVtYkluc3RhbmNlID0gcGx1bWJlcjtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIFdvcmtmbG93RWRpdG9yO1xufShXb3JrZmxvd0NhbnZhcykpO1xuJC5mbi53b3JrZmxvd0VkaXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7XG4gICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAgIHZhciB3b3JrZmxvd1R5cGUgPSAkZWxlbWVudC5kYXRhKCd3b3JrZmxvdy10eXBlJyk7XG4gICAgICAgIHZhciBkZWxldGVBY3Rpdml0eVByb21wdCA9ICRlbGVtZW50LmRhdGEoJ3dvcmtmbG93LWRlbGV0ZS1hY3Rpdml0eS1wcm9tcHQnKTtcbiAgICAgICAgdmFyIGxvY2FsSWQgPSAkZWxlbWVudC5kYXRhKCd3b3JrZmxvdy1sb2NhbC1pZCcpO1xuICAgICAgICB2YXIgbG9hZExvY2FsU3RhdGUgPSAkZWxlbWVudC5kYXRhKCd3b3JrZmxvdy1sb2FkLWxvY2FsLXN0YXRlJyk7XG4gICAgICAgIHdvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcyA9IHdvcmtmbG93VHlwZS5yZW1vdmVkQWN0aXZpdGllcyB8fCBbXTtcbiAgICAgICAgJGVsZW1lbnQuZGF0YSgnd29ya2Zsb3dFZGl0b3InLCBuZXcgV29ya2Zsb3dFZGl0b3IoZWxlbWVudCwgd29ya2Zsb3dUeXBlLCBkZWxldGVBY3Rpdml0eVByb21wdCwgbG9jYWxJZCwgbG9hZExvY2FsU3RhdGUpKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcztcbn07XG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHdvcmtmbG93RWRpdG9yID0gJCgnLndvcmtmbG93LWNhbnZhcycpLndvcmtmbG93RWRpdG9yKCkuZGF0YSgnd29ya2Zsb3dFZGl0b3InKTtcbiAgICAkKCcjd29ya2Zsb3dFZGl0b3JGb3JtJykub24oJ3N1Ym1pdCcsIGZ1bmN0aW9uIChzLCBlKSB7XG4gICAgICAgIHZhciBzdGF0ZSA9IHdvcmtmbG93RWRpdG9yLnNlcmlhbGl6ZSgpO1xuICAgICAgICAkKCcjd29ya2Zsb3dTdGF0ZUlucHV0JykudmFsKHN0YXRlKTtcbiAgICB9KTtcbn0pO1xuIl19
