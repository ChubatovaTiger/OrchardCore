!function(e){"use strict";var t={minSize:32,step:4};e.extend(!0,e.trumbowyg,{btns:[["viewHTML"],["undo","redo"],["formatting"],["strong","em","del"],["superscript","subscript"],["link"],["insertImage"],["justifyLeft"],["unorderedList","orderedList"],["horizontalRule"],["removeformat"],["table"],["fullscreen"]],btnsDef:{align:{dropdown:["justifyLeft","justifyCenter","justifyRight","justifyFull"],ico:"justifyLeft"},image:{dropdown:["insertImage","base64","noembed"],ico:"insertImage"}},langs:{en:{insertImage:"Insert Media"},it:{insertImage:"Aggiungi Immagine"}},plugins:{insertImage:{init:function(t){var n={fn:function(){var n=t;n.saveRange(),e("#mediaApp").detach().appendTo("#mediaModalHtmlField .modal-body"),e("#mediaApp").show(),mediaApp.selectedMedias=[];e("#mediaModalHtmlField").modal();e("#mediaHtmlFieldSelectButton").on("click",function(t){for(n.restoreRange(),n.range.deleteContents(),e(window).trigger("scroll"),i=0;i<mediaApp.selectedMedias.length;i++){var r=document.createElement("img");r.src=mediaApp.selectedMedias[i].url,r.alt=mediaApp.selectedMedias[i].name,n.range.insertNode(r),n.syncCode()}return n.$c.trigger("tbwchange"),n.$c.focus(),e("#mediaModalHtmlField").modal("hide"),!0})}};t.addBtnDef("insertImage",n)}},resizimg:{init:function(i){var n=new ResizeWithCanvas;function r(){i.$ed.find("img").off("click").on("click",function(e){n.isActive()&&n.reset(),n.setup(this,i.o.plugins.resizimg.resizable)})}function s(e){return e.preventDefault()}function o(e){e.$ed.find("canvas.resizable").resizable("destroy").off("mousedown",s).removeClass("resizable"),n.reset(),e.syncTextarea()}i.o.plugins.resizimg=e.extend(!0,{},t,i.o.plugins.resizimg||{},{resizable:{resizeWidth:!1,onDragStart:function(e,t){var n=i.o.plugins.resizimg,r=e.pageX-t.offset().left,s=e.pageY-t.offset().top;if(r<t.width()-n.minSize||s<t.height()-n.minSize)return!1},onDrag:function(e,t,n,r){var s=i.o.plugins.resizimg;return r<s.minSize&&(r=s.minSize),r-=r%s.step,t.height(r),!1},onDragEnd:function(){i.syncCode(),n.refresh()}}}),i.$c.on("tbwinit",function(t){r(),i.$ed.on("click",function(t){t.preventDefault(),t.stopPropagation(),e(t.target).is("img")||t.target.id===n.canvasId()||(n.reset(),i.$c.trigger("tbwchange"))}),i.$ed.on("scroll",function(e){n.reCalcOffset()})}),i.$c.on("tbwfocus",r),i.$c.on("tbwchange",r),i.$c.on("tbwresize",function(e){n.reCalcOffset()}),i.$c.on("tbwblur",function(){o(i)}),i.$c.on("tbwclose",function(){o(i)})},destroy:function(e){destroyResizable(e)}}}})}(jQuery);
