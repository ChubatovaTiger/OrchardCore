/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

var darkThemeName = 'dark';
var lightThemeName = 'light';
var getTenantName = function getTenantName() {
  return document.documentElement.getAttribute('data-tenant') || '';
};
var getStoredTheme = function getStoredTheme() {
  return localStorage.getItem(getTenantName() + '-admintheme');
};
var setStoredTheme = function setStoredTheme(theme) {
  return localStorage.setItem(getTenantName() + '-admintheme', theme);
};
var isDarkMedia = function isDarkMedia() {
  return window.matchMedia('(prefers-color-scheme: dark)').matches;
};
var getPreferredTheme = function getPreferredTheme() {
  var storedTheme = getStoredTheme();
  if (storedTheme) {
    return storedTheme;
  }
  return isDarkMedia() ? darkThemeName : lightThemeName;
};
var setTheme = function setTheme(theme) {
  if (theme === 'auto') {
    document.documentElement.setAttribute('data-bs-theme', isDarkMedia() ? darkThemeName : lightThemeName);
  } else {
    document.documentElement.setAttribute('data-bs-theme', theme);
  }
};
var getAdminPreferenceKey = function getAdminPreferenceKey() {
  return getTenantName() + '-adminPreferences';
};
var getAdminPreferences = function getAdminPreferences() {
  return JSON.parse(localStorage.getItem(getAdminPreferenceKey()));
};
var setAdminPreferences = function setAdminPreferences(adminPreferences) {
  var key = getAdminPreferenceKey();
  localStorage.setItem(key, JSON.stringify(adminPreferences));
  Cookies.set(key, JSON.stringify(adminPreferences), {
    expires: 360
  });
};
// We add some classes to the body tag to restore the sidebar to the state is was before reload.
// That state was saved to localstorage by userPreferencesPersistor.js
// We need to apply the classes BEFORE the page is rendered. 
// That is why we use a MutationObserver instead of document.Ready().
var themeObserver = new MutationObserver(function (mutations) {
  for (var i = 0; i < mutations.length; i++) {
    for (var j = 0; j < mutations[i].addedNodes.length; j++) {
      if (mutations[i].addedNodes[j].tagName == 'BODY') {
        setTheme(getPreferredTheme());

        // we're done: 
        themeObserver.disconnect();
      }
      ;
    }
  }
});
themeObserver.observe(document.documentElement, {
  childList: true,
  subtree: true
});
(function () {
  'use strict';

  var showActiveTheme = function showActiveTheme(theme) {
    var focus = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var themeSwitcher = document.querySelector('#bd-theme');
    if (!themeSwitcher) {
      return;
    }
    var themeSwitcherText = document.querySelector('#bd-theme-text');
    var activeThemeIcon = document.querySelector('.theme-icon-active');
    var btnToActive = document.querySelector("[data-bs-theme-value=\"".concat(theme, "\"]"));
    var svgOfActiveBtn = btnToActive.querySelector('.theme-icon');
    btnToActive.classList.add('active');
    btnToActive.setAttribute('aria-pressed', 'true');
    activeThemeIcon.innerHTML = svgOfActiveBtn.innerHTML;
    var themeSwitcherLabel = "".concat(themeSwitcherText.textContent, " (").concat(btnToActive.dataset.bsThemeValue, ")");
    themeSwitcher.setAttribute('aria-label', themeSwitcherLabel);
    var btnsToInactive = document.querySelectorAll("[data-bs-theme-value]:not([data-bs-theme-value=\"".concat(theme, "\"])"));
    for (var i = 0; i < btnsToInactive.length; i++) {
      btnsToInactive[i].classList.remove('active');
      btnsToInactive[i].setAttribute('aria-pressed', 'false');
    }
    if (focus) {
      themeSwitcher.focus();
    }
  };
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function () {
    var storedTheme = getStoredTheme();
    if (storedTheme !== lightThemeName && storedTheme !== darkThemeName) {
      setTheme(getPreferredTheme());
    }
  });
  window.addEventListener('DOMContentLoaded', function () {
    showActiveTheme(getPreferredTheme());
    document.querySelectorAll('[data-bs-theme-value]').forEach(function (toggle) {
      toggle.addEventListener('click', function () {
        var theme = toggle.getAttribute('data-bs-theme-value');
        setStoredTheme(theme);
        setTheme(theme);
        showActiveTheme(theme, true);
      });
    });
  });
})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnN0YW50cy5qcyIsInRoZW1lTG9hZGVyLmpzIiwidG9nZ2xlVGhlbWUuanMiXSwibmFtZXMiOlsiZGFya1RoZW1lTmFtZSIsImxpZ2h0VGhlbWVOYW1lIiwiZ2V0VGVuYW50TmFtZSIsImRvY3VtZW50IiwiZG9jdW1lbnRFbGVtZW50IiwiZ2V0QXR0cmlidXRlIiwiZ2V0U3RvcmVkVGhlbWUiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic2V0U3RvcmVkVGhlbWUiLCJ0aGVtZSIsInNldEl0ZW0iLCJpc0RhcmtNZWRpYSIsIndpbmRvdyIsIm1hdGNoTWVkaWEiLCJtYXRjaGVzIiwiZ2V0UHJlZmVycmVkVGhlbWUiLCJzdG9yZWRUaGVtZSIsInNldFRoZW1lIiwic2V0QXR0cmlidXRlIiwiZ2V0QWRtaW5QcmVmZXJlbmNlS2V5IiwiZ2V0QWRtaW5QcmVmZXJlbmNlcyIsIkpTT04iLCJwYXJzZSIsInNldEFkbWluUHJlZmVyZW5jZXMiLCJhZG1pblByZWZlcmVuY2VzIiwia2V5Iiwic3RyaW5naWZ5IiwiQ29va2llcyIsInNldCIsImV4cGlyZXMiLCJ0aGVtZU9ic2VydmVyIiwiTXV0YXRpb25PYnNlcnZlciIsIm11dGF0aW9ucyIsImkiLCJsZW5ndGgiLCJqIiwiYWRkZWROb2RlcyIsInRhZ05hbWUiLCJkaXNjb25uZWN0Iiwib2JzZXJ2ZSIsImNoaWxkTGlzdCIsInN1YnRyZWUiLCJzaG93QWN0aXZlVGhlbWUiLCJmb2N1cyIsImFyZ3VtZW50cyIsInVuZGVmaW5lZCIsInRoZW1lU3dpdGNoZXIiLCJxdWVyeVNlbGVjdG9yIiwidGhlbWVTd2l0Y2hlclRleHQiLCJhY3RpdmVUaGVtZUljb24iLCJidG5Ub0FjdGl2ZSIsImNvbmNhdCIsInN2Z09mQWN0aXZlQnRuIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJIVE1MIiwidGhlbWVTd2l0Y2hlckxhYmVsIiwidGV4dENvbnRlbnQiLCJkYXRhc2V0IiwiYnNUaGVtZVZhbHVlIiwiYnRuc1RvSW5hY3RpdmUiLCJxdWVyeVNlbGVjdG9yQWxsIiwicmVtb3ZlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImZvckVhY2giLCJ0b2dnbGUiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsSUFBTUEsYUFBYSxHQUFHLE1BQU07QUFDNUIsSUFBTUMsY0FBYyxHQUFHLE9BQU87QUFDOUIsSUFBTUMsYUFBYSxHQUFHLFNBQWhCQSxhQUFhQSxDQUFBO0VBQUEsT0FBU0MsUUFBUSxDQUFDQyxlQUFlLENBQUNDLFlBQVksQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFO0FBQUE7QUFDdEYsSUFBTUMsY0FBYyxHQUFHLFNBQWpCQSxjQUFjQSxDQUFBO0VBQUEsT0FBU0MsWUFBWSxDQUFDQyxPQUFPLENBQUNOLGFBQWEsQ0FBQyxDQUFDLEdBQUcsYUFBYSxDQUFDO0FBQUE7QUFDbEYsSUFBTU8sY0FBYyxHQUFHLFNBQWpCQSxjQUFjQSxDQUFHQyxLQUFLO0VBQUEsT0FBSUgsWUFBWSxDQUFDSSxPQUFPLENBQUNULGFBQWEsQ0FBQyxDQUFDLEdBQUcsYUFBYSxFQUFFUSxLQUFLLENBQUM7QUFBQTtBQUM1RixJQUFNRSxXQUFXLEdBQUcsU0FBZEEsV0FBV0EsQ0FBQTtFQUFBLE9BQVNDLE1BQU0sQ0FBQ0MsVUFBVSxDQUFDLDhCQUE4QixDQUFDLENBQUNDLE9BQU87QUFBQTtBQUNuRixJQUFNQyxpQkFBaUIsR0FBRyxTQUFwQkEsaUJBQWlCQSxDQUFBLEVBQVM7RUFDNUIsSUFBTUMsV0FBVyxHQUFHWCxjQUFjLENBQUMsQ0FBQztFQUNwQyxJQUFJVyxXQUFXLEVBQUU7SUFDYixPQUFPQSxXQUFXO0VBQ3RCO0VBRUEsT0FBT0wsV0FBVyxDQUFDLENBQUMsR0FBR1osYUFBYSxHQUFHQyxjQUFjO0FBQ3pELENBQUM7QUFDRCxJQUFNaUIsUUFBUSxHQUFHLFNBQVhBLFFBQVFBLENBQUdSLEtBQUssRUFBSTtFQUN0QixJQUFJQSxLQUFLLEtBQUssTUFBTSxFQUFFO0lBQ2xCUCxRQUFRLENBQUNDLGVBQWUsQ0FBQ2UsWUFBWSxDQUFDLGVBQWUsRUFB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QixlQUFlLENBQUMzQixpQkFBaUIsQ0FBQyxDQUFDLENBQUM7SUFFcENiLFFBQVEsQ0FBQzJELGdCQUFnQixDQUFDLHVCQUF1QixDQUFDLENBQzdDRyxPQUFPLENBQUMsVUFBQUMsTUFBTSxFQUFJO01BQ2ZBLE1BQU0sQ0FBQ0YsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFlBQU07UUFDbkMsSUFBTXRELEtBQUssR0FBR3dELE1BQU0sQ0FBQzdELFlBQVksQ0FBQyxxQkFBcUIsQ0FBQztRQUN4REksY0FBYyxDQUFDQyxLQUFLLENBQUM7UUFDckJRLFFBQVEsQ0FBQ1IsS0FBSyxDQUFDO1FBQ2ZpQyxlQUFlLENBQUNqQyxLQUFLLEVBQUUsSUFBSSxDQUFDO01BQ2hDLENBQUMsQ0FBQztJQUNOLENBQUMsQ0FBQztFQUNWLENBQUMsQ0FBQztBQUNOLENBQUMsRUFBRSxDQUFDIiwiZmlsZSI6IlRoZUFkbWluLWhlYWRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGRhcmtUaGVtZU5hbWUgPSAnZGFyayc7XHJcbmNvbnN0IGxpZ2h0VGhlbWVOYW1lID0gJ2xpZ2h0JztcclxuY29uc3QgZ2V0VGVuYW50TmFtZSA9ICgpID0+IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGVuYW50JykgfHwgJyc7XHJcbmNvbnN0IGdldFN0b3JlZFRoZW1lID0gKCkgPT4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oZ2V0VGVuYW50TmFtZSgpICsgJy1hZG1pbnRoZW1lJyk7XHJcbmNvbnN0IHNldFN0b3JlZFRoZW1lID0gdGhlbWUgPT4gbG9jYWxTdG9yYWdlLnNldEl0ZW0oZ2V0VGVuYW50TmFtZSgpICsgJy1hZG1pbnRoZW1lJywgdGhlbWUpO1xyXG5jb25zdCBpc0RhcmtNZWRpYSA9ICgpID0+IHdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJykubWF0Y2hlcztcclxuY29uc3QgZ2V0UHJlZmVycmVkVGhlbWUgPSAoKSA9PiB7XHJcbiAgICBjb25zdCBzdG9yZWRUaGVtZSA9IGdldFN0b3JlZFRoZW1lKClcclxuICAgIGlmIChzdG9yZWRUaGVtZSkge1xyXG4gICAgICAgIHJldHVybiBzdG9yZWRUaGVtZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaXNEYXJrTWVkaWEoKSA/IGRhcmtUaGVtZU5hbWUgOiBsaWdodFRoZW1lTmFtZTtcclxufVxyXG5jb25zdCBzZXRUaGVtZSA9IHRoZW1lID0+IHtcclxuICAgIGlmICh0aGVtZSA9PT0gJ2F1dG8nKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1icy10aGVtZScsIGlzRGFya01lZGlhKCkgPyBkYXJrVGhlbWVOYW1lIDogbGlnaHRUaGVtZU5hbWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWJzLXRoZW1lJywgdGhlbWUpO1xyXG4gICAgfVxyXG59XHJcbmNvbnN0IGdldEFkbWluUHJlZmVyZW5jZUtleSA9ICgpID0+IGdldFRlbmFudE5hbWUoKSArICctYWRtaW5QcmVmZXJlbmNlcyc7XHJcbmNvbnN0IGdldEFkbWluUHJlZmVyZW5jZXMgPSAoKSA9PiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGdldEFkbWluUHJlZmVyZW5jZUtleSgpKSk7XHJcbmNvbnN0IHNldEFkbWluUHJlZmVyZW5jZXMgPSAoYWRtaW5QcmVmZXJlbmNlcykgPT4ge1xyXG4gICAgY29uc3Qga2V5ID0gZ2V0QWRtaW5QcmVmZXJlbmNlS2V5KCk7XHJcblxyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShhZG1pblByZWZlcmVuY2VzKSk7XHJcbiAgICBDb29raWVzLnNldChrZXksIEpTT04uc3RyaW5naWZ5KGFkbWluUHJlZmVyZW5jZXMpLCB7IGV4cGlyZXM6IDM2MCB9KTtcclxufTtcclxuIiwiLy8gV2UgYWRkIHNvbWUgY2xhc3NlcyB0byB0aGUgYm9keSB0YWcgdG8gcmVzdG9yZSB0aGUgc2lkZWJhciB0byB0aGUgc3RhdGUgaXMgd2FzIGJlZm9yZSByZWxvYWQuXHJcbi8vIFRoYXQgc3RhdGUgd2FzIHNhdmVkIHRvIGxvY2Fsc3RvcmFnZSBieSB1c2VyUHJlZmVyZW5jZXNQZXJzaXN0b3IuanNcclxuLy8gV2UgbmVlZCB0byBhcHBseSB0aGUgY2xhc3NlcyBCRUZPUkUgdGhlIHBhZ2UgaXMgcmVuZGVyZWQuIFxyXG4vLyBUaGF0IGlzIHdoeSB3ZSB1c2UgYSBNdXRhdGlvbk9ic2VydmVyIGluc3RlYWQgb2YgZG9jdW1lbnQuUmVhZHkoKS5cclxuY29uc3QgdGhlbWVPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG11dGF0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbXV0YXRpb25zW2ldLmFkZGVkTm9kZXMubGVuZ3RoOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbnNbaV0uYWRkZWROb2Rlc1tqXS50YWdOYW1lID09ICdCT0RZJykge1xyXG4gICAgICAgICAgICAgICAgc2V0VGhlbWUoZ2V0UHJlZmVycmVkVGhlbWUoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gd2UncmUgZG9uZTogXHJcbiAgICAgICAgICAgICAgICB0aGVtZU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG5cclxudGhlbWVPYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwge1xyXG4gICAgY2hpbGRMaXN0OiB0cnVlLFxyXG4gICAgc3VidHJlZTogdHJ1ZVxyXG59KTtcclxuIiwiKCgpID0+IHtcclxuICAgICd1c2Ugc3RyaWN0J1xyXG5cclxuICAgIGNvbnN0IHNob3dBY3RpdmVUaGVtZSA9ICh0aGVtZSwgZm9jdXMgPSBmYWxzZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHRoZW1lU3dpdGNoZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYmQtdGhlbWUnKTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGVtZVN3aXRjaGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHRoZW1lU3dpdGNoZXJUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2JkLXRoZW1lLXRleHQnKTtcclxuICAgICAgICBjb25zdCBhY3RpdmVUaGVtZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGhlbWUtaWNvbi1hY3RpdmUnKTtcclxuICAgICAgICBjb25zdCBidG5Ub0FjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWJzLXRoZW1lLXZhbHVlPVwiJHt0aGVtZX1cIl1gKTtcclxuICAgICAgICBjb25zdCBzdmdPZkFjdGl2ZUJ0biA9IGJ0blRvQWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy50aGVtZS1pY29uJyk7XHJcblxyXG4gICAgICAgIGJ0blRvQWN0aXZlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgICAgIGJ0blRvQWN0aXZlLnNldEF0dHJpYnV0ZSgnYXJpYS1wcmVzc2VkJywgJ3RydWUnKTtcclxuXHJcbiAgICAgICAgYWN0aXZlVGhlbWVJY29uLmlubmVySFRNTCA9IHN2Z09mQWN0aXZlQnRuLmlubmVySFRNTDtcclxuXHJcbiAgICAgICAgY29uc3QgdGhlbWVTd2l0Y2hlckxhYmVsID0gYCR7dGhlbWVTd2l0Y2hlclRleHQudGV4dENvbnRlbnR9ICgke2J0blRvQWN0aXZlLmRhdGFzZXQuYnNUaGVtZVZhbHVlfSlgO1xyXG4gICAgICAgIHRoZW1lU3dpdGNoZXIuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgdGhlbWVTd2l0Y2hlckxhYmVsKTtcclxuXHJcbiAgICAgICAgY29uc3QgYnRuc1RvSW5hY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbZGF0YS1icy10aGVtZS12YWx1ZV06bm90KFtkYXRhLWJzLXRoZW1lLXZhbHVlPVwiJHt0aGVtZX1cIl0pYCk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnRuc1RvSW5hY3RpdmUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYnRuc1RvSW5hY3RpdmVbaV0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIGJ0bnNUb0luYWN0aXZlW2ldLnNldEF0dHJpYnV0ZSgnYXJpYS1wcmVzc2VkJywgJ2ZhbHNlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZm9jdXMpIHtcclxuICAgICAgICAgICAgdGhlbWVTd2l0Y2hlci5mb2N1cygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB3aW5kb3cubWF0Y2hNZWRpYSgnKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcclxuICAgICAgICBjb25zdCBzdG9yZWRUaGVtZSA9IGdldFN0b3JlZFRoZW1lKClcclxuICAgICAgICBpZiAoc3RvcmVkVGhlbWUgIT09IGxpZ2h0VGhlbWVOYW1lICYmIHN0b3JlZFRoZW1lICE9PSBkYXJrVGhlbWVOYW1lKSB7XHJcbiAgICAgICAgICAgIHNldFRoZW1lKGdldFByZWZlcnJlZFRoZW1lKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xyXG4gICAgICAgIHNob3dBY3RpdmVUaGVtZShnZXRQcmVmZXJyZWRUaGVtZSgpKTtcclxuXHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtYnMtdGhlbWUtdmFsdWVdJylcclxuICAgICAgICAgICAgLmZvckVhY2godG9nZ2xlID0+IHtcclxuICAgICAgICAgICAgICAgIHRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0aGVtZSA9IHRvZ2dsZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYnMtdGhlbWUtdmFsdWUnKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRTdG9yZWRUaGVtZSh0aGVtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGhlbWUodGhlbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNob3dBY3RpdmVUaGVtZSh0aGVtZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn0pKCk7XHJcbiJdfQ==
