@inject IOptions<AutorouteOptions> AutorouteOptions

@{
    ContentItem contentItem = Model.ContentItem;
    var menuItemPart = contentItem.As<ContentMenuItemPart>();
    var routeValues = new RouteValueDictionary(AutorouteOptions.Value.GlobalRouteValues);
    routeValues[AutorouteOptions.Value.ContentItemIdKey] = menuItemPart.ContentItem.Content.ContentMenuItemPart.SelectedContentItem.ContentItemIds[0];
    var linkUrl = Url.RouteUrl(routeValues);

    var name = (string)menuItemPart.Name;
    if(Model.Level == 0 && Model.HasItems)
    {
        name += "<b class=\"caret\"></b>";
    }

    TagBuilder tag = Tag(Model, "a");
    tag.Attributes["href"] = linkUrl;
    tag.InnerHtml.AppendHtml(name);
}

@tag