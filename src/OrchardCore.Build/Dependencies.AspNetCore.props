<Project>
  <PropertyGroup>
    <!-- The default TFM for web app and console projects is net5.0 -->
    <AspNetCoreTargetFramework>net5.0</AspNetCoreTargetFramework>
    <AspNetCoreTargetFrameworks>netcoreapp3.1;net5.0</AspNetCoreTargetFrameworks>
    <TargetFrameworks>$(AspNetCoreTargetFrameworks)</TargetFrameworks>
  </PropertyGroup>
  <Choose>
    <When Condition=" '$(TargetFramework)' == 'net5.0' ">
      <PropertyGroup>
        <AspNetCoreVersion>5.0.3</AspNetCoreVersion>
      </PropertyGroup>
    </When>
    <Otherwise>
      <!--
      Fallback when not targetting .net 5.0.
      At this time, that would mean .net core 3.1.  If there are more target frameworks in the future,
      this logic should change slightly.
      -->
      <PropertyGroup>
        <AspNetCoreVersion>3.1.12</AspNetCoreVersion>
      </PropertyGroup>
    </Otherwise>
  </Choose>

  <ItemGroup>
    <PackageManagement Include="Microsoft.AspNetCore.Authentication.AzureAD.UI" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.Authentication.Facebook" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.Authentication.Google" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.Authentication.MicrosoftAccount" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.Authentication.OpenIdConnect" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.Authentication.Twitter" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.DataProtection.StackExchangeRedis" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.Mvc.NewtonsoftJson" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.Mvc.Testing" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.AspNetCore.Owin" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.Extensions.Caching.StackExchangeRedis" Version="$(AspNetCoreVersion)" />
    <PackageManagement Include="Microsoft.Extensions.Http.Polly" Version="$(AspNetCoreVersion)" />
  </ItemGroup>

  <!-- For .NET 5.0 packages that do not have a version number that matches $(AspNetCoreVersion) available -->
  <ItemGroup Condition=" '$(TargetFramework)' == 'net5.0' ">

    <!-- Fixes error NU1102: Unable to find package Microsoft.Extensions.Http.Polly with version (>= 5.0.3), Found 50 version(s) in NuGet [ Nearest version: 5.0.1 ]-->
    <PackageManagement Remove="Microsoft.Extensions.Http.Polly" />
    <PackageManagement Include="Microsoft.Extensions.Http.Polly" Version="5.0.1" />

    <!-- Fixes error NU1102: Unable to find package Microsoft.Extensions.Caching.StackExchangeRedis with version (>= 5.0.3), Found 45 version(s) in NuGet [ Nearest version: 5.0.1 ] -->
    <PackageManagement Remove="Microsoft.Extensions.Caching.StackExchangeRedis" />
    <PackageManagement Include="Microsoft.Extensions.Caching.StackExchangeRedis" Version="5.0.1" />
  </ItemGroup>
</Project>
